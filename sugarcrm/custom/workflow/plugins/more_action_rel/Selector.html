<!--
/*********************************************************************************
 * The contents of this file are subject to the SugarCRM Enterprise End User
 * License Agreement ("License") which can be viewed at
 * http://www.sugarcrm.com/crm/products/sugar-enterprise-eula.html
 * By installing or using this file, You have unconditionally agreed to the
 * terms and conditions of the License, and You may not use this file except in
 * compliance with the License.  Under the terms of the license, You shall not,
 * among other things: 1) sublicense, resell, rent, lease, redistribute, assign
 * or otherwise transfer Your rights to the Software, and 2) use the Software
 * for timesharing or service bureau purposes such as hosting the Software for
 * commercial gain and/or for the benefit of a third party.  Use of the Software
 * may be subject to applicable fees and any use of the Software without first
 * paying applicable fees is strictly prohibited.  You do not have the right to
 * remove SugarCRM copyrights from the source code or user interface.
 *
 * All copies of the Covered Code must include on each user interface screen:
 *  (i) the "Powered by SugarCRM" logo and
 *  (ii) the SugarCRM copyright notice
 * in the same form as they appear in the distribution.  See full license for
 * requirements.
 *
 * Your Warranty, Limitations of liability and Indemnity are expressly stated
 * in the License.  Please refer to the License for the specific language
 * governing these rights and limitations under the License.  Portions created
 * by SugarCRM are Copyright (C) 2004-2006 SugarCRM, Inc.; All Rights Reserved.
 ********************************************************************************/
/*********************************************************************************
 * $Id: Selector.html,v 1.8 2005/12/22 01:55:46 wayne Exp $
 * Description:
 ********************************************************************************/
-->
<!-- BEGIN: embeded -->
<script type="text/javascript" src="include/workflow/jutils.js?s={SUGAR_VERSION}&c={JS_CUSTOM_VERSION}"></script>
<script type="text/javascript" src="include/javascript/sugar_3.js?s={SUGAR_VERSION}&c={JS_CUSTOM_VERSION}"></script>
<script>



function set_return(field_num){
	
	var display_text = 'Extra Relationship Data';
	
	var more_rel_value = get_value('apply_extra_rel');
	
	if(more_rel_value=='No'){
		
		var value = '';
	} else {
		var value = more_rel_value;
		//var value = get_value('vardef_name');
	}		
	
	window.opener.document.getElementById('adv_value_' + field_num).value = value;

	window.opener.document.getElementById('set_type_' + field_num).value = get_value('field_'+field_num + '__set_type');
	window.opener.document.getElementById('adv_type_' + field_num).value = get_value('field_'+field_num + '__adv_type');
	
	
	window.opener.document.getElementById('ext1_' + field_num).value = get_value('field_'+field_num + '__ext1');
	window.opener.document.getElementById('ext2_' + field_num).value = get_value('field_'+field_num + '__ext2');

		

	
	
	window.opener.document.getElementById('display_text_' + field_num).value = display_text;
	window.opener.changehref_text('value_' + field_num, 'href_text_' + field_num, field_num);

	
		
	window.close();
	
//end function set_return
}

function build_display_text(field_num, type){
	
	if(type=='Basic'){
		
		var selected_text = get_inner_text('field_'+field_num + '__field_value');
		
		if(	get_value('field_'+field_num + '__field_type') == 'datetime' || 
			get_value('field_'+field_num + '__field_type') == 'date')
		{
			selected_text += ' from ' + get_inner_text('field_'+field_num + '__ext1');
		}
		return selected_text;	
	//end if type is basic		
	} else {
		if(get_value('field_'+field_num + '__adv_type') == 'value_calc'){
			var selected_text = ' existing value ' + get_inner_text('field_'+field_num + '__ext1');
			selected_text += ' ' + get_inner_text('field_'+field_num + '__adv_value');
			return selected_text;
		}		
			
		if(get_value('field_'+field_num + '__adv_type') == 'enum_step'){
			var selected_text = ' ' + get_inner_text('field_'+field_num + '__ext1');
			selected_text += ' ' + get_inner_text('field_'+field_num + '__adv_value') + ' step(s)';
			return selected_text;
		}		
			var selected_text = get_inner_text('field_'+field_num + '__adv_value');
			selected_text += ' ' + get_inner_text('field_'+field_num + '__ext1');
			selected_text += ' ' + get_inner_text('field_'+field_num + '__ext2');
			selected_text += ' ' + get_inner_text('field_'+field_num + '__ext3');
			return selected_text;
		
	//end if type is advanced
	}		
	


//end function build_display_text
}
	

</script>
<!-- END: embeded -->
<!-- BEGIN: main -->

{SET_RETURN_JS}


<table cellpadding="0" cellspacing="0" border="0" width="100%" class="tabForm">
<tr><td>
<table width="100%" cellpadding="0" cellspacing="0" border="0">
			<tr>
			<form name="EditView" method="POST" action="index.php">
			<input id="{PREFIX}set_type" type="hidden" name="{PREFIX}set_type" value="{SET_TYPE}">
			<input id="{PREFIX}adv_type" type="hidden" name="{PREFIX}adv_type" value="{ADV_TYPE}">			
			<input id="{PREFIX}field_type" type="hidden" name="{PREFIX}field_type" value="{FIELD_TYPE}">			
			<input id="{PREFIX}value" type="hidden" name="{PREFIX}value" value="{VALUE}">	
			<input id="base_module" type="hidden" name="base_module" value="{BASE_MODULE}">
			<input id="action_type" type="hidden" name="action_type" value="{ACTION_TYPE}">
			<input id="field_num" type="hidden" name="field_num" value="{FIELD_NUMBER}">
			<input id="vardef_name" type="hidden" name="vardef_name" value="{VARDEF_NAME}">
			
			
			<input id="{PREFIX}ext1" type="hidden" name="{PREFIX}ext1" value="{EXT1}">
			<input id="{PREFIX}ext2" type="hidden" name="{PREFIX}ext2" value="{EXT2}">
			
			</tr>		
			<tr>
			<td colspan="3" class="dataLabel">		
			<b>This is an advanced feature.  Please make sure you understand how this plugin works prior to setting any values below to 'Yes'.</b><BR>
			<BR><b>Relationship Name:</b>&nbsp;{LABEL_NAME}&nbsp;<BR><b>Advanced Information:</b><BR><b>Vardef Name:</b>&nbsp;{VARDEF_NAME}&nbsp;&nbsp;<b>Real Relationship Name:</b>&nbsp;{REAL_REL_NAME}&nbsp;<BR>
			<!-- BEGIN: simple -->
			<BR>Scenario #1: Would you like to apply the triggered record's target id as the value for the new record's relationship id?<BR><BR>
			(Example Usage: Create a new Account and set the member-of id to be the same member-of id for the triggered record.)
			<BR>
			<!-- END: simple -->
		
			
			<!-- BEGIN: extra_options -->
			<BR><b>Please select a scenario below to apply to this relationship.</b>
			<BR><BR>
			<b>Scenario #1: apply the triggered record's target id as the value for the new record's relationship id.</b>
			<BR>(Example Usage: Create a new Account and set the member-of id to be the same member-of id as the triggered record.)
			<BR><BR>
			<b>Scenario #2: Apply triggered record's id as the vaule for the new record's relationship id.</b>
			<BR>(Example Usage: Create a new Account and set the member-of id to be the id of the triggered record.)
			<BR><BR>
			<b>Scenario #3: Use Scenario #1 if id is not empty, else use Scenario #2</b>
			<BR>(Example Usage: Create a new Account and set the member-of id to be the same member-of id as the triggered record if it is not empty else use the triggered record's id.)
			<BR><BR>				
			<!-- END: extra_options -->			
				
			<select name='apply_extra_rel' id='apply_extra_rel' >{MORE_REL_OPTIONS}</select>
			</td>
			</tr>			
			<tr>
			<td colspan = "3" width = '100%' class="dataLabel" align="right">
				 <input title="{APP.LBL_SAVE_BUTTON_TITLE}" accessKey="{APP.LBL_SAVE_BUTTON_KEY}" class="button" type="button" name="button" value="{APP.LBL_SAVE_BUTTON_LABEL}"
					onclick="return set_return('{FIELD_NUMBER}')">
	 <input title="{APP.LBL_CANCEL_BUTTON_TITLE}" accessKey="{APP.LBL_CANCEL_BUTTON_KEY}" class="button" onclick="window.close();" type="submit" name="button" value="  {APP.LBL_CANCEL_BUTTON_LABEL}  ">
			</td>			
			</tr>
			<tr>
			<td colspan ="3">&nbsp;</td>
			</tr>
			
			</form>
</tr>
</table>
<!-- END: main -->
<!-- BEGIN: not_available -->
<BR><BR>Extra Relationship Data is only available for creating New Records and New Related Records.
<!-- END: not_available -->