/* Copyright (c) 2017 SugarCRM Inc. Licensed by SugarCRM under the Apache 2.0 license. */
(function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("d3v4"),require("d3fc-rebind")):"function"==typeof define&&define.amd?define(["exports","d3v4","d3fc-rebind"],e):e(t.sucrose=t.sucrose||{},t.d3v4,t.fc)})(this,function(t,e,n){"use strict";function r(){function t(n){return n.each(function(r){function a(){return"function"==typeof O.rangeExtent?O.rangeExtent():O.range()}function i(){return b?O.bandwidth():0}function o(){var t,n=0;return b?n=O.range().length>1?Math.abs(O.range()[1]-O.range()[0]):e.max(a())/2:(t=O.ticks(nt.size()),n=O(t[t.length-1])-O(t[t.length-2])),n}function l(t){if("rtl"===h){if("start"===t)return"end";if("end"===t)return"start"}return t}function y(){return"left"!==p&&"bottom"!==p}function I(t){t=t||1,F=L.tickPadding()+(Y?A:C)*t}function S(){z(),A=e.max(X,function(t){return t.width}),C=e.max(X,function(t){return t.height})}function z(){X=[],K={},d&&ot.style("opacity",1).attr("transform",function(t,e){var n=Y?"0,"+O(t):O(t)+",0";return"translate("+n+")"}),lt.each(function(t,e){var n=this.getBoundingClientRect();n.width>0&&X.push({key:t,width:parseInt(n.width,10),height:parseInt(n.height,10),left:n.left,right:n.right,top:n.top,bottom:n.bottom})}),X.sort(function(t,e){return t.key-e.key}).forEach(function(t,e){t.index=e,K["key-"+t.key.toString()]=t}),J=X[0],Q=X[X.length-1]}function P(t){z();for(var e=d?2:t||1,n=d?1:0,r=X.length-e;n<r;n+=1)if(X[n].right+Z>X[n+t].left)return!0;return!1}function B(t){var e=t?(t+180)%180:0,n=e>90,r=null,o=null;if(X.forEach(function(t,a){var l=null===r||t.left<=r,s=null===o||t.right>=o,c=0,u=0,d=0;(l||s)&&(d=e?t.width-6:t.width/2,c=O(t.key)+b*i()/2,!l||e&&!n||(r=t.left,u=Math.abs(W[0]-c),V.left=Math.max(d-u,0)),!s||e&&n||(o=t.right,u=Math.abs(W[1]-c),V.right=Math.max(d-u,0)))}),!b){var l=T.right-Math.max(T.right,V.right);l+=T.left-Math.max(T.left,V.left);var s=[W[0],W[1]+l];O.range(s),W=a(),q=Math.abs(W[1]-W[0]),L.scale(O),et.call(L)}}function E(){V={top:0,right:0,bottom:0,left:0},O=c.copy(),W=a(),q=Math.abs(W[1]-W[0]),L.scale(c),et.call(L),lt.selectAll("tspan").remove(),lt.attr("dy",Y?".32em":.355+.355*G+"em").attr("x",Y?L.tickPadding()*G:0).attr("y",Y?0:L.tickPadding()*G).attr("transform","translate(0,0)").text(function(t,e){return U[e]}).style("text-anchor","middle").style("opacity",1),S(),I()}function _(){var t=o();lt.each(function(r,a){var i=L.tickFormat()(r,a,n,!0),o=e.select(this),l=w.isValidDate(i),s=1===G?.71:-1,c=0,u=(i&&""!==i?l?i:i.replace("/","/ "):[]).split(" "),d=u.length;this.textContent="";var f,h=o.append("tspan").text(u[c]+" ").attr("dy",s+"em").attr("x",0);for(c+=1,s=1;c<d;)for(h=o.append("tspan").text(u[c]+" ").attr("dy",s+"em").attr("x",0),c+=1;c<d;){if(f=h.text(),h.text(f+" "+u[c]),!(this.getBoundingClientRect().width<=t)){h.text(f);break}c+=1}}),S(),I()}function H(){lt.attr("transform",function(t,e){var n=K["key-"+t.toString()].index%2*C;return"translate(0,"+n+")"}),S(),I(2)}function N(t){var e=(t+180)%180,n=e>90,r=(e-(n?180:0))*G,a=l(n?"end":"start"),i=Math.abs(Math.cos(t*Math.PI/180));lt.attr("transform",function(t,e,n){return"translate(0,"+L.tickPadding()*G+") rotate("+r+")"}).attr("y","0").style("text-anchor",a),S(),I(),F+=11*i}var R=e.select(this),O=L.scale().copy(),V={top:0,right:0,bottom:0,left:0},W=a(),q=Math.abs(W[1]-W[0]);s=s||L.scale();var Y="left"===p||"right"===p,G="left"===p||"top"===p?-1:1,Z=6,j=0,X=[],K={},U=[],J={},Q={};F=0,null!==M?L.ticks(M):Y?L.ticks(Math.ceil(q/48)):L.ticks(Math.ceil(q/100)),v&&!isFinite(String(v))&&(v=30),b&&(d=!1);var $=R.selectAll("g.sc-wrap.sc-axis").data([r]),tt=$.enter().append("g").attr("class","sc-wrap sc-axis").append("g").attr("class","sc-axis-inner"),et=R.select(".sc-axis-inner").merge(tt);et.call(L);var nt=et.selectAll("g.tick"),rt=d?e.extent(c.domain()):[],at=et.selectAll("g.sc-axisMaxMin").data(rt),it=at.enter().append("g").attr("class","sc-axisMaxMin");at.exit().remove();var ot=et.selectAll("g.sc-axisMaxMin").merge(it);it.append("text").style("opacity",0),it.append("line").style("opacity",0),d&&ot.select("text").text(function(t,e,n){return L.tickFormat()(t,e,n,!1)});var lt=et.selectAll("g.tick, g.sc-axisMaxMin").select("text").filter(function(t){return this.getBoundingClientRect().width}).each(function(t,n){U.push(e.select(this).text())}),st=u?[u]:[],ct=et.selectAll("text.sc-axislabel").data(st),ut=ct.enter().append("text").attr("class","sc-axislabel");ct.exit().remove();var dt=et.selectAll("text.sc-axislabel").merge(ut);dt.text(w.identity);var ft=!1,ht=!1,pt=!1;if(Y?(E(),lt.style("text-anchor",l(k||(y()?"start":"end")))):(E(),B(),P(1)&&(g&&(E(),_(),B(),_(),P(1)||(ft=!0)),!ft&&m&&(E(),H(),B(),H(),P(2)||(ht=!0)),ft||ht||(v||(v=30),E(),N(v),B(v),N(v),pt=!0))),d?(ot.select("line").attr("x1",0).attr("y1",0).attr("y2",Y?0:(L.tickSize()-V.bottom)*G).attr("x2",Y?L.tickSize()*G:0).style("opacity",function(t,e){return y()?e?0:1:e?1:0}),nt.each(function(t,n){var r=e.select(this),a=K["key-"+t.toString()],i=!1;Y?(i=a.bottom>J.top||a.top<Q.bottom,r.select("line").style("opacity",1-i)):i=!pt&&(ht?(a.left<J.right+Z||a.right>Q.left+Z)&&(a.bottom<J.top||a.top>Q.bottom):a.left<J.right+Z||a.right>Q.left+Z),r.select("text").style("opacity",1-i)})):(nt.filter(function(t){return O(t)===W[0+y()]}).classed("zero",f),nt.select("line").style("opacity",function(t,e){return O(t)===W[0+y()]?0:1})),u){var gt=Y?x?q/-2:(F+D)*G:q/2,mt=Y?x?(F+D)*G:q/2:(F+D)*G;dt.attr("x",gt).attr("y",mt).attr("dy",.355+.355*G+"em").attr("transform",Y&&x?"rotate(-90)":"").style("text-anchor",Y&&!x?l("end"):"middle"),dt.each(function(t,e){j+=Y?parseInt(this.getBoundingClientRect().width/1.3,10):parseInt(this.getBoundingClientRect().height/1.3,10)}),F+=j+D}s=c.copy(),T={top:V.top,right:V.right,bottom:V.bottom,left:V.left},T[p]=F,t.resizeTickLines=function(t){et.selectAll("g.tick, g.sc-axisMaxMin").select("line").attr(Y?"x2":"y2",t*G)},t.labelThickness=function(){return j}}),t}var r,a,i,o,l,s,c=e.scaleLinear(),u=null,d=!0,f=!0,h="ltr",p="bottom",g=!1,m=!1,v=30,y=!1,x=!0,b=!1,k=null,M=null,I=4,A=0,C=0,S=function(t){return t},D=8,T={top:0,right:0,bottom:0,left:0},F=0,L=e.axisBottom();return t.axis=L,n.rebind(t,c,"domain","range"),t.width=function(e){return arguments.length?t:F},t.height=function(e){return arguments.length?t:F},t.margin=function(e){return arguments.length?(T=e,t):T},t.ticks=function(e){return arguments.length?(M=e,t):M},t.axisLabel=function(e){return arguments.length?(u=e,t):u},t.showMaxMin=function(e){return arguments.length?(d=e,t):d},t.highlightZero=function(e){return arguments.length?(f=e,t):f},t.wrapTicks=function(e){return arguments.length?(g=e,t):g},t.rotateTicks=function(e){return arguments.length?(v=e,t):v},t.staggerTicks=function(e){return arguments.length?(m=e,t):m},t.reduceXTicks=function(e){return arguments.length?(y=e,t):y},t.rotateYLabel=function(e){return arguments.length?(x=e,t):x},t.axisLabelDistance=function(e){return arguments.length?(D=e,t):D},t.maxLabelWidth=function(e){return arguments.length?(A=e,t):A},t.textAnchor=function(e){return arguments.length?(k=e,t):k},t.direction=function(e){return arguments.length?(h=e,t):h},t.orient=function(n){return arguments.length?(p=n,L="bottom"===p?e.axisBottom():"right"===p?e.axisRight():"left"===p?e.axisLeft():"top"===p?e.axisTop():e.axisBottom(),t):p},t.scale=function(e){return arguments.length?(c=e,L.scale(c),b="function"==typeof c.padding,n.rebind(t,c,"domain","range"),t):c},t.valueFormat=function(e){return arguments.length?(S=e,L.tickFormat(e),t):S||L.tickFormat()},t.tickFormat=function(e){return arguments.length?(r=e,L.tickFormat(e),t):r||L.tickFormat()},t.tickValues=function(e){return arguments.length?(a=e,L.tickValues(e),t):a},t.tickSize=function(e){return arguments.length?(i=e,L.tickSize(e),t):i},t.tickPadding=function(e){return arguments.length?(I=e,L.tickPadding(e),t):I},t.tickSizeInner=function(e){return arguments.length?(o=e,L.tickSizeInner(e),t):o},t.tickSizeOuter=function(e){return arguments.length?(l=e,L.tickSizeOuter(e),t):l},t}function a(){function t(l){return l.each(function(t){function l(){L=W(ut),z=q(),P=Y(ut)}function s(){var r=V(z,L),a=0,i=4,o=L-2*A*z,l=z;t.forEach(function(t,e){t.values.forEach(function(t){t._height=ct>0?O(r*t.value/ct,o):0,t._height<i?(a+=t._height-i,t._height=i):a<0&&t._height+a>i&&(t._height+=a,a=0),t._base=o,t._bottom=l,t._top=t._bottom-t._height,o+=2*A*t._height,l-=t._height})});var s=n||e.extent(e.merge(t.map(function(t){return t.values.map(function(t){return t._top})})).concat(S));C.domain(s).range([z,0])}function g(){It.selectAll("polyline").remove(),It.selectAll("rect").remove(),It.selectAll("text").remove(),It.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("pointer-events","none").style("stroke-width",0).style("fill-opacity",0),It.append("text").text(f).call(tt,"sc-label",.85,"middle",Q),It.select(".sc-label").call(_,D?E:H,G,function(t,e){tt(t,"sc-label",e,"middle",Q)}),It.append("text").text(h).call(tt,"sc-value",.85,"middle",Q),It.select(".sc-value").append("tspan").text(p),It.call(et).call(X).call(nt),It.classed("sc-label-side",function(t){return t.tooTall||t.tooWide})}function m(){var t,n,r,a,i=0,o=0;for(At=It.filter(".sc-label-side"),At.selectAll(".sc-label").remove(),At.selectAll("rect").remove(),At.selectAll("polyline").remove(),At.append("text").text(f).call(tt,"sc-label",.85,"start","#555"),At.select(".sc-label").call(_,D?E:H,D?Z:N,function(t,e){tt(t,"sc-label",e,"start","#555")}),At.call(et),At.select(".sc-value").style("text-anchor","start").style("fill","#555"),At.call(K),t=At.nodes(),r=t.length-1;r>=0;r-=1)if(o=e.select(t[r]).data()[0]){if(!i){o.labelBottom=o.labelTop+o.labelHeight+lt,i=o.labelBottom;continue}o.labelTop=Math.max(i,o.labelTop),o.labelBottom=o.labelTop+o.labelHeight+lt,i=o.labelBottom}if(i&&i-lt>e.max(C.range())){for(i=0,t=At.nodes(),n=0,a=t.length;n<a;n+=1)if(o=e.select(t[n]).data()[0]){if(!i){o.labelBottom=z-1,o.labelTop=o.labelBottom-o.labelHeight,i=o.labelTop;continue}o.labelBottom=Math.min(i,o.labelBottom),o.labelTop=o.labelBottom-o.labelHeight-lt,i=o.labelTop}i<0&&At.each(function(t){t.labelTop-=i,t.labelBottom-=i})}i=0,At.call(J)}function v(){g(),m()}function B(t,e,n){return{id:o,key:c(e),value:u(e),count:d(e),data:e,series:e.series,e:t}}function E(t,n,r,a){var i,o=n.text(),l=parseFloat(n.attr("dy")),s=o.split(/\s+/).reverse(),c=[],u=0,d=r(t,0),f=e.select(n.node().parentNode);for(n.text(null);i=s.pop();)c.push(i),n.text(c.join(" ")),n.node().getComputedTextLength()>d&&c.length>1&&(c.pop(),n.text(c.join(" ")),c=[i],n=f.append("text"),n.text(i).call(a,1.1*++u+l))}function _(t,n,r,a){t.each(function(t){var i=e.select(this);n(t,i,r,a)})}function H(t,e,n,r){var a=e.text(),i=parseFloat(e.attr("dy")),o=n(t);e.text(w.stringEllipsify(a,it,o)).call(r,i)}function N(t){var e=Math.max(rt-at/1.1,T),n=t._bottom,r=n*A,a=e+r,i=Math.abs(t.labelBottom-n),o=i*A,l=ot+o+ot+ot,s=a-l;return Math.max(s,T)}function R(t,e,n){var r=t._bottom,a=t._top,i=n/2-A*r,o=n/2-A*a,l=P;return l-i+","+r*e+" "+(l-o)+","+a*e+" "+(l+o)+","+a*e+" "+(l+i)+","+r*e}function O(t,e){var n=e/A/2;return Math.abs(Math.sqrt(t/A+n*n))-n}function V(t,e){return t*(e-t*A)}function W(t){return Math.round(Math.max(Math.min(at/1.1,rt-t),40))}function q(){return Math.min(1.1*L,(L-L*A)/(2*A))}function Y(t){return L/2+t}function G(t){var e=L,n=t._bottom-t._height/2;return e-n*A*2}function Z(t,e){var n=Math.max((rt-L)/2,e),r=t._top;return n+r*A}function j(t){return e.select(t).node().getBoundingClientRect()}function X(t){t.each(function(t){var e=j(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._bottom-t._height/2-t.labelHeight/2,t.labelBottom=t.labelTop+t.labelHeight+lt,t.tooWide=t.labelWidth>G(t),t.tooTall=t.labelHeight>t._height-4})}function K(t){t.each(function(t){var e=j(this);t.labelHeight=e.height,t.labelWidth=e.width,t.labelTop=t._top,t.labelBottom=t.labelTop+t.labelHeight+lt})}function U(t){for(var n=t.size(),r=t.nodes(),a=r.length-1;a>=0;--a){var i=e.select(r[a]),o=i.data()[0],l=a<n-1?e.select(r[a+1]).data()[0]:null,s=a?e.select(r[a-1]).data()[0]:null,c=Math.round(o.labelHeight)+.5,u=Math.round(o._bottom-o.labelTop)-.5,d=l?l.labelWidth-(o.labelBottom-l.labelBottom)*A:0,f=o.labelWidth,h=s&&c<u?s.labelWidth:0,p=Math.round(Math.max(d,f,h))+ot,g=Math.round(Z(o,ut))-st-ot,m="0,"+c+" "+p+","+c+" "+(p+Math.abs(c-u)*A)+","+u+" "+g+","+u;o.labelWidth=p,i.attr("points",m)}}function J(t){var e=(rt-L)/2,n=0;t.each(function(t){var e=t._bottom,r=(t.labelBottom>=e?1:0,Math.abs(t.labelBottom+ot-e)*A),a=e*A,i=t.labelWidth+r+3*ot-a;i>=n&&(n=i)}),n=Math.round(10*n)/10,n<=0?(st=e,ut=e):n>0&&n<e?(st=e-n,ut=e):(st=0,ut=n)}function Q(t,n,r){var a=e.select(this.parentNode).style("fill");return w.getTextContrast(a,n)}function $(t){w.isRTLChar(t.slice(-1));return"ltr"}function tt(t,e,n,r,a){t.attr("x",0).attr("y",0).attr("dy",n+"em").attr("class",e).attr("direction",function(){return $(t.text())}).style("pointer-events","none").style("text-anchor",r).style("fill",a)}function et(t){t.each(function(t){var n=e.select(this),r=n.selectAll(".sc-label").size()+1,a=.85+r-1+"em";n.select(".sc-value").attr("dy",a)})}function nt(t){t.each(function(t,n){var r=e.select(this);r.select(".sc-label-box").attr("x",(t.labelWidth+6)/-2).attr("y",-2).attr("width",t.labelWidth+6).attr("height",t.labelHeight+4).attr("rx",2).attr("ry",2).style("fill-opacity",1)})}var rt=a-r.left-r.right,at=i-r.top-r.bottom,it=e.select(this),ot=5,lt=5,st=0,ct=0,ut=0;ct=e.sum(t,function(t){return t.value}),b=function(t,e,n){return w.colorLinearGradient(t,o+"-"+e,n,x(t,e),ht.select("defs"))},l(),s();var dt=it.selectAll("g.sc-wrap").data([t]),ft=dt.enter().append("g").attr("class","sc-wrap sc-funnel"),ht=it.select(".sc-wrap.sc-funnel").merge(ft),pt=ft.append("defs");if(ht.attr("transform","translate("+r.left+","+r.top+")"),M)var gt=w.createTexture(pt,o);var mt=ht.selectAll(".sc-series").data(t,function(t){return t.seriesIndex}),vt=mt.enter().append("g").attr("class","sc-series");mt.exit().remove();var yt=ht.selectAll(".sc-series").merge(vt);vt.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",1).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),yt.attr("class",function(t){return I(t,t.seriesIndex)}).attr("fill",function(t){return k(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}),yt.transition().duration(y).style("stroke-opacity",1).style("fill-opacity",1);var xt=yt.selectAll("g.sc-slice").data(function(t){return t.values},function(t){return t.seriesIndex});xt.exit().remove();var bt=xt.enter().append("g").attr("class","sc-slice"),wt=yt.selectAll("g.sc-slice").merge(bt);bt.append("polygon").attr("class","sc-base"),wt.select("polygon.sc-base").attr("points",function(t){return R(t,0,L)}),M&&(bt.append("polygon").attr("class","sc-texture").style("mask","url("+gt+")"),wt.select("polygon.sc-texture").attr("points",function(t){return R(t,0,L)})),bt.on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=B(e.event,t,n);F.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;F.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),F.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=B(e.event,t,n);F.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=B(e.event,t,n);F.call("elementDblClick",this,r)});var kt=yt.selectAll(".sc-label-value").data(function(t){return t.values},function(t){return t.seriesIndex});kt.exit().remove();var Mt=kt.enter().append("g").attr("class","sc-label-value"),It=yt.selectAll("g.sc-label-value").merge(Mt);It.attr("transform","translate("+P+",0)");var At=It.filter(".sc-label-side");v(),l(),s(),v(),l(),s(),v(),l(),s(),wt.select(".sc-base").attr("points",function(t){return R(t,1,L)}),M&&wt.selectAll(".sc-texture").attr("points",function(t){return R(t,1,L)}).style("fill",Q),It.attr("transform",function(t){var e=t.tooTall?0:P,n=t.tooTall?0:t.labelTop;return"translate("+e+","+n+")"}),At.attr("transform",function(t){return"translate("+st+","+t.labelTop+")"}),At.append("polyline").attr("class","sc-label-leader").style("fill-opacity",0).style("stroke","#999").style("stroke-width",1).style("stroke-opacity",.5),At.selectAll("polyline").call(U)}),t}var n,r={top:0,right:0,bottom:0,left:0},a=960,i=500,o=Math.floor(1e4*Math.random()),l=function(t){return t.x},s=function(t){return t.y},c=function(t){return t.key},u=function(t,e){return t.value},d=function(t,e){return t.count},f=function(t){return c(t.series||t)},h=function(t){return u(t.series||t)},p=function(t){return(" ("+d(t.series||t)+")").replace(" ()","")},g=w.buildLocality(),m="ltr",v=0,y=0,x=function(t,e){return w.defaultColor()(t.series,t.seriesIndex)},b=null,k=x,M=!1,I=function(t,e){return"sc-series sc-series-"+t.seriesIndex},A=.3,C=e.scaleLinear(),S=[0],D=!0,T=75,F=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),L=0,z=0,P=0;return t.dispatch=F,t.id=function(e){return arguments.length?(o=e,t):o},t.color=function(e){return arguments.length?(x=e,t):x},t.fill=function(e){return arguments.length?(k=e,t):k},t.classes=function(e){return arguments.length?(I=e,t):I},t.gradient=function(e){return arguments.length?(b=e,t):b},t.margin=function(e){return arguments.length?(r.top="undefined"!=typeof e.top?e.top:r.top,r.right="undefined"!=typeof e.right?e.right:r.right,r.bottom="undefined"!=typeof e.bottom?e.bottom:r.bottom,r.left="undefined"!=typeof e.left?e.left:r.left,t):r},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.x=function(e){return arguments.length?(l=e,t):l},t.y=function(e){return arguments.length?(s=w.functor(e),t):s},t.getKey=function(e){return arguments.length?(c=e,t):c},t.getValue=function(e){return arguments.length?(u=e,t):u},t.getCount=function(e){return arguments.length?(d=e,t):d},t.fmtKey=function(e){return arguments.length?(f=e,t):f},t.fmtValue=function(e){return arguments.length?(h=e,t):h},t.fmtCount=function(e){return arguments.length?(p=e,t):p},t.direction=function(e){return arguments.length?(m=e,t):m},t.delay=function(e){return arguments.length?(v=e,t):v},t.duration=function(e){return arguments.length?(y=e,t):y},t.textureFill=function(e){return arguments.length?(M=e,t):M},t.locality=function(e){return arguments.length?(g=w.buildLocality(e),t):g},t.yScale=function(e){return arguments.length?(C=e,t):C},t.yDomain=function(e){return arguments.length?(n=e,t):n},t.forceY=function(e){return arguments.length?(S=e,t):S},t.wrapLabels=function(e){return arguments.length?(D=e,t):D},t.minLabelWidth=function(e){return arguments.length?(T=e,t):T},t}function i(){function t(o){return o.each(function(o){function s(t,n,r){return{point:n,index:r,e:e.event,id:i}}function c(t){z=t,dt.transition().duration(y).ease(e.easeElastic).attr("transform","rotate("+d(t)+")"),U.select(".sc-odomText").text(z),U.call(u)}function u(t){var e=t.select(".sc-odomText").node().getBoundingClientRect();t.select(".sc-odomBox").attr("d",w.roundedRectangle(-e.width/2,-e.height+W(1.5),e.width+W(4),e.height+W(2),W(2))),t.attr("transform","translate("+F+","+(n.top+W(70)+e.height)+")")}function d(t){return E+R(t)*N}function f(t){return w.angleToRadians(d(t.y0))}function h(t){return w.angleToRadians(d(t.y1))}function p(){return"translate("+F+","+F+")"}function g(t){var e=(h(t)-f(t))/(2*Math.PI);return e>D?1:0}var m=r-n.left-n.right,v=a-n.top-n.bottom,C=e.select(this);b=function(t,e){var n={x:0,y:0,r:F,s:A/100,u:"userSpaceOnUse"};return w.colorRadialGradient(t,i+"-"+e,n,x(t,e),G.select("defs"))};var F=Math.min(m/2,v)/((100+H)/100),N=_-E,R=e.scaleLinear().range([0,1]).domain([P,B]),O=0,V=o.map(function(t,e){var n={key:t.key,seriesIndex:t.seriesIndex,y0:O,y1:t.y,color:t.color,classes:t.classes,values:t.values};return O=t.y,n}),W=function(t){return t*F/100},q=C.selectAll("g.sc-wrap").data([o]),Y=q.enter().append("g").attr("class","sc-wrap sc-gauge"),G=C.select(".sc-wrap.sc-gauge").merge(Y);Y.append("defs");Y.append("g").attr("class","sc-group");var Z=G.select(".sc-group");Y.append("g").attr("class","sc-labels");var j=G.select(".sc-labels");Y.append("g").attr("class","sc-pointer");var X=G.select(".sc-pointer"),K=Y.append("g").attr("class","sc-odometer"),U=G.select(".sc-odometer");G.attr("transform","translate("+(n.left/2+n.right/2+W(H))+","+(n.top+W(H))+")"),Z.attr("transform",p);var J=Z.selectAll(".sc-series").data(V),Q=J.enter().append("g").attr("class","sc-series");J.exit().remove();var $=Z.selectAll(".sc-series").merge(Q);Q.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),$.attr("class",function(t){return M(t,t.seriesIndex)}).attr("fill",function(t){return k(t,t.seriesIndex)}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active});var tt=e.arc().innerRadius(W(A)).outerRadius(F).startAngle(f).endAngle(h),et=$.selectAll("g.sc-slice").data(function(t,e){return t.values.map(function(e,n){return e.y0=t.y0,e.y1=t.y1,e})},function(t){return t.seriesIndex});et.exit().remove();var nt=et.enter().append("g").attr("class","sc-slice"),rt=$.selectAll("g.sc-slice").merge(nt);nt.append("path").attr("class","sc-base").attr("d",tt).on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=s(e.event,t,n);I.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;I.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),I.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=s(e.event,t,n);I.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=s(e.event,t,n);I.call("elementDblClick",this,r)}),rt.select(".sc-base").attr("d",tt).style("stroke-opacity",1);var at=[0].concat(o.map(l));j.attr("transform",p);var it=j.selectAll("text").data(at),ot=it.enter().append("text");it.exit().remove();var lt=j.selectAll("text").merge(ot);if(lt.attr("transform",function(t){return"rotate("+d(t)+") translate(0,"+(W(-1.5)-F)+")"}).text(w.identity).style("fill-opacity",g).style("text-anchor","middle").style("font-size",W(.6)+"em"),S){var st=[[Math.round(W(T)/2),0],[0,-Math.round(W(L))],[-Math.round(W(T)/2),0],[0,Math.round(W(T))],[Math.round(W(T)/2),0]];X.attr("transform",p);var ct=X.selectAll("path").data([st]),ut=ct.enter().append("path").attr("transform","rotate("+E+")");ct.exit().remove();var dt=X.selectAll("path").merge(ut);dt.attr("d",e.line()),K.append("text").attr("class","sc-odom sc-odomText").attr("x",0).attr("y",0).style("text-anchor","middle").style("stroke","none").style("fill","black"),U.select(".sc-odomText").style("font-size",W(.7)+"em").text(z),K.insert("path",".sc-odomText").attr("class","sc-odom sc-odomBox").attr("fill","#EFF").attr("stroke","black").attr("stroke-width","2px").attr("opacity",.8),U.call(u)}else X.selectAll("path").remove(),U.select(".sc-odomText").remove(),U.select(".sc-odomBox").remove();t.setGaugePointer=c}),t}var n={top:0,right:0,bottom:0,left:0},r=null,a=null,i=Math.floor(1e4*Math.random()),o=function(t){return t.key},l=function(t){return t.y},s=function(t){return"undefined"==typeof t.key?t:t.key},c=function(t,e){return isNaN(t.value)?t:t.value},u=function(t,e){return isNaN(t.count)?t:t.count},d=function(t){return t.values},f=function(t){return s(t)},h=function(t){return c(t)},p=function(t){return(" ("+u(t)+")").replace(" ()","")},g=w.buildLocality(),m="ltr",v=0,y=720,x=function(t,e){return w.defaultColor()(t,t.seriesIndex)},b=null,k=x,M=function(t,e){return"sc-slice sc-series-"+t.seriesIndex},I=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),A=50,C=!0,S=!0,D=.01,T=5,F=5,L=90,z=0,P=0,B=10,E=-90,_=90,H=10;return t.dispatch=I,t.id=function(e){return arguments.length?(i=e,t):i},t.color=function(e){return arguments.length?(x=e,t):x},t.fill=function(e){return arguments.length?(k=e,t):k},t.classes=function(e){return arguments.length?(M=e,t):M},t.gradient=function(e){return arguments.length?(b=e,t):b},t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(l=w.functor(e),t):l},t.getKey=function(e){return arguments.length?(s=e,t):s},t.getValue=function(e){return arguments.length?(c=e,t):c},t.getCount=function(e){return arguments.length?(u=e,t):u},t.fmtKey=function(e){return arguments.length?(f=e,t):f},t.fmtValue=function(e){return arguments.length?(h=e,t):h},t.fmtCount=function(e){return arguments.length?(p=e,t):p},t.direction=function(e){return arguments.length?(m=e,t):m},t.delay=function(e){return arguments.length?(v=e,t):v},t.duration=function(e){return arguments.length?(y=e,t):y},t.locality=function(e){return arguments.length?(g=w.buildLocality(e),t):g},t.values=function(e){return arguments.length?(d=e,t):d},t.showLabels=function(e){return arguments.length?(C=e,t):C},t.labelThreshold=function(e){return arguments.length?(D=e,t):D},t.ringWidth=function(e){return arguments.length?(A=e,t):A},t.pointerWidth=function(e){return arguments.length?(T=e,t):T},t.pointerTailLength=function(e){return arguments.length?(F=e,t):F},t.pointerHeadLength=function(e){return arguments.length?(L=e,t):L},t.setPointer=function(e){return arguments.length?(t.setGaugePointer(e),t):t.setGaugePointer},t.showPointer=function(e){return arguments.length?(S=e,t):S},t.minValue=function(e){return arguments.length?(P=e,t):P},t.maxValue=function(e){return arguments.length?(B=e,t):B},t.minAngle=function(e){return arguments.length?(E=e,t):E},t.maxAngle=function(e){return arguments.length?(_=e,t):_},t.labelInset=function(e){return arguments.length?(H=e,t):H},t}function o(){function t(r){return r.each(function(r){function x(){X.style("opacity",.9*C).style("display",C?"inline":"none"),$.style("opacity",C).style("display",C?"inline":"none"),U.text(1===C?t.strings().close:t.strings().open)}var L=e.select(this),z=a,P=[],B=0,E=0,_="",H="start"===l,N="rtl"===o,R=d*(H?1:.6),O=u+(H?c+f:0);if(!r||!r.length||!r.filter(function(t){return!t.values||t.values.length}).length)return t;var V=r.filter(function(t){return t.hasOwnProperty("seriesIndex")}).length;r.filter(function(t){return!t.hasOwnProperty("seriesIndex")}).map(function(t,e){t.seriesIndex=V,V+=1}),y=!0,_=r[0].type&&"bar"!==r[0].type?"line":"bar",i=N&&"center"!==i?"left"===i?"right":"left":i;var W=L.selectAll("g.sc-wrap").data([r]),q=W.enter().append("g").attr("class","sc-wrap sc-menu"),Y=L.select("g.sc-wrap").merge(q);Y.attr("transform","translate(0,0)");var G=q.append("defs"),Z=Y.select("defs");G.append("clipPath").attr("id","sc-edge-clip-"+b).append("rect");var j=Y.select("#sc-edge-clip-"+b+" rect");q.append("rect").attr("class","sc-menu-background");var X=Y.select(".sc-menu-background"),K=w.dropShadow("menu_back_"+b,Z,{blur:2});q.append("text").attr("class","sc-menu-link");var U=Y.select(".sc-menu-link"),J=q.append("g").attr("class","sc-menu-mask"),Q=Y.select(".sc-menu-mask");J.append("g").attr("class","sc-group");var $=Y.select(".sc-group"),tt=$.selectAll(".sc-series").data(w.identity,function(t){return t.seriesIndex});tt.exit().remove();var et=tt.enter().append("g").attr("class","sc-series").on("mouseover",function(t,e){A.call("legendMouseover",this,t)}).on("mouseout",function(t,e){A.call("legendMouseout",this,t)}).on("click",function(t,n){e.event.preventDefault(),e.event.stopPropagation(),A.call("legendClick",this,t)}),nt=$.selectAll(".sc-series").merge(et);nt.attr("class",I).attr("fill",M).attr("stroke",M),et.append("rect").attr("x",(c+f)/-2).attr("y",(c+R)/-2).attr("width",c+f).attr("height",c+R).style("fill","#FFE").style("stroke-width",0).style("opacity",.1);var rt=et.selectAll("circle").data(function(t){return"line"===_?[t,t]:[t]});rt.exit().remove();var at=rt.enter().append("circle").attr("r",s).style("stroke-width","2px"),it=nt.selectAll("circle").merge(at),ot=et.selectAll("line").data("line"===_?function(t){return[t]}:[]);ot.exit().remove();var lt=ot.enter().append("line").attr("x0",0).attr("y0",0).attr("y1",0).style("stroke-width","4px"),st=nt.selectAll("line").merge(lt),ct=et.append("text").attr("dx",0),ut=nt.selectAll("text").merge(ct);ut.attr("dy",H?".36em":".71em").text(k),j.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0),X.attr("x",.5).attr("y",.5).attr("width",0).attr("height",0).style("opacity",0).style("pointer-events","all").on("click",function(t,n){e.event.stopPropagation()}),U.text(1===C?t.strings().close:t.strings().open).attr("text-anchor","left"===i?N?"end":"start":N?"start":"end").attr("dy",".36em").attr("dx",0).style("opacity",0).on("click",function(t,n){e.event.preventDefault(),e.event.stopPropagation(),A.call("toggleMenu",this,t,n)}),nt.classed("disabled",function(t){return t.disabled}),t.calcMaxWidth=function(){return P=[],$.style("display","inline"),ut.each(function(t,n){var r=e.select(this).node().getBoundingClientRect().width;P.push(Math.max(Math.floor(r),"line"===_?50:20))}),t.width(e.sum(P)+P.length*O-u),t.width()},t.getLineHeight=function(){$.style("display","inline");var t=Math.floor(ut.node().getBoundingClientRect().height);return t},t.arrange=function(r){function a(t){return P[t]+O}function o(t){return P[t]+O-u}function y(t){return t?1:-1}0===P.length&&this.calcMaxWidth();var x,k,M,I=P.length,A=1,L=I,V=[],W=[],q=r-n.left-n.right,Y=0,G=this.getLineHeight(),Z=c+(H?0:G)+R,J={top:7,right:7,bottom:7,left:7},tt=0,et=0;if(h){for(;L>0;){for(V=[],x=0;x<I;x+=1)a(x)>(V[x%L]||0)&&(V[x%L]=a(x));if(e.sum(V)-u<q)break;L-=1}for(L=L||1,A=Math.ceil(I/L),Y=e.sum(V)-u,x=0;x<I;x+=1)k=x%L,H?0===k?tt=N?Y:0:tt+=V[k-1]*y(!N):0===k?tt=(N?Y:0)+(V[k]-u)/2*y(!N):tt+=(V[k-1]+V[k])/2*y(!N),et=Math.floor(x/L)*Z,W[x]={x:tt,y:et}}else if(N)for(tt=q,x=0;x<I;x+=1)tt-o(x)<0&&(Y=Math.max(Y,o(x)),tt=q,x&&(A+=1)),tt-o(x)>Y&&(Y=tt-o(x)),W[x]={x:tt,y:(A-1)*(R+c)},tt-=a(x);else for(tt=0,x=0;x<I;x+=1)x&&tt+o(x)>q&&(tt=0,A+=1),tt+o(x)>Y&&(Y=tt+o(x)),W[x]={x:tt,y:(A-1)*(R+c)},tt+=a(x);if(!g&&(p||A<=v)){switch(C=0,m=!1,S=!1,t.width(n.left+Y+n.right).height(n.top+A*Z-R+n.bottom),i){case"left":M=0;break;case"center":M=(r-t.width())/2;break;case"right":M=0}j.attr("y",0).attr("width",t.width()).attr("height",t.height()),X.attr("x",M).attr("width",t.width()).attr("height",t.height()).attr("rx",0).attr("ry",0).attr("filter","none").style("display","inline").style("opacity",0),Q.attr("clip-path","none").attr("transform",function(t,e){var r=M+n.left+(H?s*y(!N):0),a=n.top+J.top;return"translate("+r+","+a+")"}),$.style("opacity",1).style("display","inline"),nt.attr("transform",function(t){var e=W[t.seriesIndex];return"translate("+e.x+","+e.y+")"}),nt.select("rect").attr("x",function(t){var e=0;return H?(e=(c+u)/2*y(N),e-=N?a(t.seriesIndex):0):e=a(t.seriesIndex)/-2,e}).attr("width",function(t){return a(t.seriesIndex)}).attr("height",Z),it.attr("r",function(t){return"dash"===t.type?0:s}).attr("transform",function(t,e){var n=H||"bar"===_?0:3*s*y(e);return"translate("+n+",0)"}),st.attr("x1",function(t){return"dash"===t.type?8*s:4*s}).attr("transform",function(t){var e=s*("dash"===t.type?-4:-2);return"translate("+e+",0)"}).style("stroke-dasharray",function(t){return"dash"===t.type?"8, 8":"none"}).style("stroke-dashoffset",-4),ut.attr("dy",H?".36em":".71em").attr("text-anchor",l).attr("transform",function(t){var e=H?(s+f)*y(!N):0,n=H?0:(c+R)/2;return"translate("+e+","+n+")";
})}else m=!0,S=!0,t.width(J.left+e.max(P)+c+f+J.right).height(n.top+c+n.top),B=J.top+c*I+d*(I-1)+J.bottom,E=Math.min(z-t.height(),B),j.attr("x",.5-J.top-s).attr("y",.5-J.top-s).attr("width",t.width()).attr("height",E),X.attr("x",.5).attr("y",.5+t.height()).attr("width",t.width()).attr("height",E).attr("rx",2).attr("ry",2).attr("filter",K).style("opacity",.9*C).style("display",C?"inline":"none"),U.attr("transform",function(e,r){var a="left"===i?.5:.5+t.width(),o=n.top+s;return"translate("+a+","+o+")"}).style("opacity",1),Q.attr("clip-path","url(#sc-edge-clip-"+b+")").attr("transform",function(e,n){var r=J.left+s,a=t.height()+J.top+s;return"translate("+r+","+a+")"}),$.style("opacity",C).style("display",C?"inline":"none").attr("transform",function(t,n){var r=N?e.max(P)+s:0;return"translate("+r+",0)"}),nt.attr("transform",function(t,e){var n=e*(c+d);return"translate(0,"+n+")"}),nt.select("rect").attr("x",function(t){var e=(c+u)/2*y(N);return e-=N?a(t.seriesIndex):0}).attr("width",function(t){return a(t.seriesIndex)}).attr("height",c+R),it.attr("r",function(t){return"dash"===t.type?0:"line"===t.type?s-2:s}).attr("transform",""),st.attr("x1",16).attr("transform","translate(-8,0)").style("stroke-dasharray",function(t){return"dash"===t.type?"6, 4, 6":"none"}).style("stroke-dashoffset",0),ut.attr("text-anchor","start").attr("dy",".36em").attr("transform",function(t){var e=(s+f)*y(!N);return"translate("+e+",0)"});if(D){var rt=E-B,at=function(t){if(t){var n=e.zoom().on("zoom",ot),r=e.drag().subject(w.identity).on("drag",ot);X.call(n),$.call(n),X.call(r),$.call(r)}else X.on(".zoom",null),$.on(".zoom",null),X.on(".drag",null),$.on(".drag",null)},ot=function(){var t=0,n=0,r="",a=0,i=0;if(e.event){if("zoom"===e.event.type&&e.event.sourceEvent)a=e.event.sourceEvent.deltaX||0,i=e.event.sourceEvent.deltaY||0,t=(Math.abs(a)>Math.abs(i)?a:i)*-1;else if("drag"===e.event.type)a=e.event.dx||0,i=e.event.dy||0,t=i;else if("click"!==e.event.type)return 0;n=Math.abs(i)>Math.abs(a)?i:0}T=Math.min(Math.max(T+t,rt),0),r="translate("+(N?e.max(P)+s:0)+","+T+")",(T+t>0||T+t<rt)&&F(n),$.attr("transform",r)};at(S)}},A.on("toggleMenu",function(t){e.event.stopPropagation(),C=1-C,x()}),A.on("closeMenu",function(t){1===C&&(C=0,x())})}),t}var n={top:10,right:10,bottom:15,left:10},r=0,a=0,i="right",o="ltr",l="start",s=6,c=2*s,u=10,d=12,f=5,h=!0,p=!1,g=!1,m=!1,v=3,y=!1,x={close:"Hide legend",type:"Show legend",noLabel:"undefined"},b=Math.floor(1e4*Math.random()),k=function(e){return e.key.length>0||!isNaN(parseFloat(e.key))&&isFinite(e.key)?e.key:t.strings().noLabel},M=function(t){return w.defaultColor()(t,t.seriesIndex)},I=function(t){return"sc-series sc-series-"+t.seriesIndex},A=e.dispatch("legendClick","legendMouseover","legendMouseout","toggleMenu","closeMenu"),C=0,S=!1,D=!0,T=0,F=function(t){};return t.dispatch=A,t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=Math.round(e),t):r},t.height=function(e){return arguments.length?(a=Math.round(e),t):a},t.id=function(e){return arguments.length?(b=e,t):b},t.key=function(e){return arguments.length?(k=e,t):k},t.color=function(e){return arguments.length?(M=w.getColor(e),t):M},t.classes=function(e){return arguments.length?(I=e,t):I},t.align=function(e){return arguments.length?(i=e,t):i},t.position=function(e){return arguments.length?(l=e,t):l},t.showAll=function(e){return arguments.length?(p=e,t):p},t.showMenu=function(e){return arguments.length?(g=e,t):g},t.collapsed=function(t){return m},t.rowsCount=function(e){return arguments.length?(v=e,t):v},t.spacing=function(e){return arguments.length?(d=e,t):d},t.gutter=function(e){return arguments.length?(u=e,t):u},t.radius=function(e){return arguments.length?(s=e,t):s},t.strings=function(e){return arguments.length?(x=e,t):x},t.equalColumns=function(e){return arguments.length?(h=e,t):h},t.enabled=function(e){return arguments.length?(y=e,t):y},t.direction=function(e){return arguments.length?(o=e,t):o},t}function l(){function t(L){return L.each(function(L){function H(){if(p.domain(I||e.extent(Q.map(v).concat(b))),g.domain(A||e.extent(Q.map(y).concat(k))),E&&L[0])if(_===-1){var t=Math.sqrt(S[1]/Math.PI);p.range([0+t,X-t]),g.range([K-t,0+t])}else _<1?(p.range([(X*_+X)/(2*L[0].values.length),X-X*(1+_)/(2*L[0].values.length)]),g.range([K,0])):(p.range([_,X-_]),g.range([K-_,_]));else p.range([0,X]),g.range([K,0]);Y&&g.nice(),W=p.domain()[0]===p.domain()[1]||g.domain()[0]===g.domain()[1],p.domain()[0]===p.domain()[1]&&(p.domain()[0]?p.domain([p.domain()[0]-.1*p.domain()[0],p.domain()[1]+.1*p.domain()[1]]):p.domain([-1,1])),g.domain()[0]===g.domain()[1]&&(g.domain()[0]?g.domain([g.domain()[0]-.1*g.domain()[0],g.domain()[1]+.1*g.domain()[1]]):g.domain([-1,1])),m.domain(C||e.extent(Q.map(function(t){return t.size}).concat(M))).range(S),m.domain().length<2&&m.domain([0,m.domain()]),n=n||p,r=r||g,a=a||m}function Z(t,e,n,r){return{series:r,point:r.values[n],pointIndex:n,seriesIndex:r.seriesIndex,id:o,e:t}}function j(){if(!P)return!1;if(O===!0){var t=e.merge(L.map(function(t,e){return t.values.map(function(t,n){var r=v(t,n),a=y(t,n);return[p(r)+1e-4*Math.random(),g(a)+1e-4*Math.random(),e,n,t]}).filter(function(t,e){return B(t[4],e)})}));if(V){var n=et.select("#sc-points-clip-"+o).selectAll("circle").data(t),r=n.enter().append("circle"),a=et.select("#sc-points-clip-"+o).selectAll("circle").merge(r);a.attr("cx",function(t){return t[0]}).attr("cy",function(t){return t[1]}).attr("r",function(t,e){return D(t[4],e)}),n.exit().remove(),at.attr("clip-path","url(#sc-points-clip-"+o+")")}t.length<=3&&(t.push([p.range()[0]-20,g.range()[0]-20,null,null]),t.push([p.range()[1]+20,g.range()[1]+20,null,null]),t.push([p.range()[0]-20,g.range()[0]+20,null,null]),t.push([p.range()[1]+20,g.range()[1]-20,null,null]));var i=e.voronoi().extent([[-10,-10],[l+10,s+10]]).polygons(t).map(function(e,n){return{data:e,seriesIndex:t[n][2],pointIndex:t[n][3]}}).filter(function(t){return null!==t.seriesIndex}),c=at.selectAll("path").data(i),u=c.enter().append("path").attr("class",function(t,e){return"sc-path-"+e}),d=at.selectAll("path").merge(u);d.attr("d",function(t){return t?"M"+t.data.join("L")+"Z":null}),c.exit().remove(),d.on("mouseover",function(t){if(G||!L[t.seriesIndex])return 0;var n=Z(e.event,t,t.pointIndex,L[t.seriesIndex]);q.call("elementMouseover",this,n)}).on("mousemove",function(t,n){var r=e.event;q.call("elementMousemove",this,r)}).on("mouseout",function(t,n){if(G||!L[t.seriesIndex])return 0;var r=Z(e.event,t,t.pointIndex,L[t.seriesIndex]);q.call("elementMouseout",this,r)}).on("click",function(t){if(G||!L[t.seriesIndex])return 0;var n=Z(e.event,t,t.pointIndex,L[t.seriesIndex]);q.call("elementClick",this,n)})}else lt.selectAll(".sc-point").style("pointer-events","auto").on("mouseover",function(t,n){if(G||!L[t.seriesIndex])return 0;var r=Z(e.event,t,n,L[t.seriesIndex]);q.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;q.call("elementMousemove",this,r)}).on("mouseout",function(t,n){if(G||!L[t.seriesIndex])return 0;var r=Z(e.event,t,n,L[t.seriesIndex]);q.call("elementMouseout",this,r)}).on("click",function(t,n){if(G||!L[t.seriesIndex])return 0;var r=Z(e.event,t,n,L[t.seriesIndex]);q.call("elementClick",this,r)});G=!1}var X=l-c.left-c.right,K=s-c.top-c.bottom,U=e.select(this),J=e.transition("scatter").duration(R).ease(e.easeLinear);G=!0;var Q=I&&A&&C?[]:e.merge(L.map(function(t){return t.values.map(function(t,e){return{x:v(t,e),y:y(t,e),size:x(t,e)}})}));t.resetDimensions=function(t,e){l=t,s=e,X=t-c.left-c.right,K=e-c.top-c.bottom,H()},H();var $=U.selectAll("g.sc-wrap.sc-scatter").data([L]),tt=$.enter().append("g").attr("class","sc-wrap sc-scatter"),et=U.select(".sc-wrap.sc-scatter").merge(tt),nt=tt.append("defs");d=function(t,e){return w.colorRadialGradient(t,o+"-"+e,{x:.5,y:.5,r:.5,s:0,u:"objectBoundingBox"},u(t,e),et.select("defs"))},tt.append("g").attr("class","sc-group");var rt=et.select(".sc-group");tt.append("g").attr("class","sc-point-paths");var at=et.select(".sc-point-paths");et.classed("sc-single-point",W).attr("transform","translate("+c.left+","+c.top+")"),nt.append("clipPath").attr("id","sc-edge-clip-"+o).append("rect"),nt.append("clipPath").attr("id","sc-points-clip-"+o).attr("class","sc-point-clips"),et.select("#sc-edge-clip-"+o+" rect").attr("width",X).attr("height",K),et.attr("clip-path",N?"url(#sc-edge-clip-"+o+")":"");var it=rt.selectAll(".sc-series").data(w.identity,function(t){return t.seriesIndex}),ot=it.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),lt=rt.selectAll(".sc-series").merge(ot);lt.attr("class",function(t,e){return h(t,t.seriesIndex)}).attr("fill",function(t,e){return f(t,t.seriesIndex)}).attr("stroke",function(t,e){return f(t,t.seriesIndex)}).classed("hover",function(t){return t.hover}),lt.transition(J).style("stroke-opacity",1).style("fill-opacity",1),it.exit().transition(J).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove();var st,ct,ut;z?(st=lt.selectAll("circle.sc-point").data(function(t){return t.values}),ct=st.enter().append("circle").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("r",D),ut=lt.selectAll(".sc-point").merge(ct),ut.filter(function(t){return e.select(this).classed("sc-enter")}).attr("cx",function(t,e){return p(v(t,e))}).attr("cy",function(t,e){return g(0)}),ut.transition(J).attr("cx",function(t,e){return p(v(t,e))}).attr("cy",function(t,e){return g(y(t,e))}).on("end",function(t){e.select(this).classed("sc-enter",!1)}),it.exit().transition(J).selectAll(".sc-point").attr("cx",function(t,e){return p(v(t,e))}).attr("cy",function(t,e){return g(0)}).remove()):(st=lt.selectAll("path.sc-point").data(function(t){return t.values}),ct=st.enter().append("path").attr("class",function(t,e){return"sc-point sc-enter sc-point-"+e}).attr("d",e.symbol().type(F).size(T)),ut=lt.selectAll(".sc-point").merge(ct),ut.filter(function(t){return e.select(this).classed("sc-enter")}).attr("transform",function(t,e){return"translate("+n(v(t,e))+","+g(0)+")"}),ut.transition(J).attr("transform",function(t,e){return"translate("+p(v(t,e))+","+g(y(t,e))+")"}).attr("d",e.symbol().type(F).size(T)),it.exit().transition(J).selectAll(".sc-point").attr("transform",function(t,e){return"translate("+p(v(t,e))+","+g(0)+")"}).remove()),clearTimeout(i),i=setTimeout(j,300),n=p.copy(),r=g.copy(),a=m.copy(),q.on("elementMouseover.point",function(t){P&&U.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!0)}),q.on("elementMouseout.point",function(t){P&&U.select(".sc-series-"+t.seriesIndex+" .sc-point-"+t.pointIndex).classed("hover",!1)})}),t}var n,r,a,i,o=Math.floor(1e5*Math.random()),l=960,s=500,c={top:0,right:0,bottom:0,left:0},u=function(t,e){return w.defaultColor()(t,t.seriesIndex)},d=null,f=u,h=function(t,e){return"sc-series sc-series-"+t.seriesIndex},p=e.scaleLinear(),g=e.scaleLinear(),m=e.scaleLinear(),v=function(t){return t.x},y=function(t){return t.y},x=function(t){return t.size||1},b=[],k=[],M=[],I=null,A=null,C=null,S=[1*Math.PI,25*Math.PI],D=function(t,e){return Math.sqrt(m(x(t,e))/Math.PI)},T=function(t,e){return m(x(t,e))},F=function(t){return t.shape||"circle"},L=w.buildLocality(),z=!0,P=!0,B=function(t){return!t.notActive},E=!1,_=.1,H="ltr",N=!1,R=300,O=!0,V=!0,W=!1,q=e.dispatch("elementClick","elementMouseover","elementMouseout","elementMousemove"),Y=!1,G=!1;return t.dispatch=q,t.id=function(e){return arguments.length?(o=e,t):o},t.color=function(e){return arguments.length?(u=e,t):u},t.fill=function(e){return arguments.length?(f=e,t):f},t.classes=function(e){return arguments.length?(h=e,t):h},t.gradient=function(e){return arguments.length?(d=e,t):d},t.x=function(e){return arguments.length?(v=w.functor(e),t):v},t.y=function(e){return arguments.length?(y=w.functor(e),t):y},t.z=function(e){return arguments.length?(x=w.functor(e),t):x},t.xScale=function(e){return arguments.length?(p=e,t):p},t.yScale=function(e){return arguments.length?(g=e,t):g},t.zScale=function(e){return arguments.length?(m=e,t):m},t.xDomain=function(e){return arguments.length?(I=e,t):I},t.yDomain=function(e){return arguments.length?(A=e,t):A},t.zDomain=function(e){return arguments.length?(C=e,t):C},t.forceX=function(e){return arguments.length?(b=e,t):b},t.forceY=function(e){return arguments.length?(k=e,t):k},t.forceZ=function(e){return arguments.length?(M=e,t):M},t.size=function(e){return arguments.length?(x=w.functor(e),t):x},t.sizeRange=function(e){return arguments.length?(S=e,t):S},t.sizeDomain=function(e){return arguments.length?(C=e,t):C},t.forceSize=function(e){return arguments.length?(M=e,t):M},t.margin=function(e){if(!arguments.length)return c;for(var n in e)e.hasOwnProperty(n)&&(c[n]=e[n]);return t},t.width=function(e){return arguments.length?(l=e,t):l},t.height=function(e){return arguments.length?(s=e,t):s},t.interactive=function(e){return arguments.length?(P=e,t):P},t.pointActive=function(e){return arguments.length?(B=e,t):B},t.padData=function(e){return arguments.length?(E=e,t):E},t.padDataOuter=function(e){return arguments.length?(_=e,t):_},t.clipEdge=function(e){return arguments.length?(N=e,t):N},t.clipVoronoi=function(e){return arguments.length?(V=e,t):V},t.useVoronoi=function(e){return arguments.length?(O=e,O===!1&&(V=!1),t):O},t.circleRadius=function(e){return arguments.length?(D=e,t):D},t.clipRadius=function(e){return arguments.length?(D=e,t):D},t.shape=function(e){return arguments.length?(F=e,t):F},t.onlyCircles=function(e){return arguments.length?(z=e,t):z},t.singlePoint=function(e){return arguments.length?(W=e,t):W},t.duration=function(e){return arguments.length?(R=e,t):R},t.direction=function(e){return arguments.length?(H=e,t):H},t.nice=function(e){return arguments.length?(Y=e,t):Y},t.locality=function(e){return arguments.length?(L=w.buildLocality(e),t):L},t}function s(){function t(n){return n.each(function(t){function n(t){if(!t.values||!t.values.length)return[null];if(t.values.length>1)return[t.values];var e=r.domain().map(function(e,n){if(Array.isArray(t.values[0]))return[e,t.values[0][1]];var r=JSON.parse(JSON.stringify(t.values[0]));return r.x=e,r});return[e]}var l=e.select(this),m=s-o.left-o.right,b=c-o.top-o.bottom,M="linear"===p?e.curveLinear:"cardinal"===p?e.curveCardinal:"monotone"===p?e.curveMonotoneX:"basis"===p?e.curveBasis:e.curveNatural,I=e.area().curve(M).defined(f).x(function(t,e){return r(u(t,e))}).y0(function(t,e){return a(d(t,e))}).y1(function(t,e){return a(a.domain()[0]<=0?a.domain()[1]>=0?0:a.domain()[1]:a.domain()[0])}),A=e.area().curve(M).defined(f).x(function(t,e){return r(u(t,e))}).y0(function(t,e){return a(0)}).y1(function(t,e){return a(a.domain()[0]<=0?a.domain()[1]>=0?0:a.domain()[1]:a.domain()[0])}),C=e.transition("points").duration(v).ease(e.easeLinear),S=i.id();x=function(t,e,n){return w.colorLinearGradient(t,i.id()+"-"+e,n,y(t,e),F.select("defs"))},r=i.xScale(),a=i.yScale();var D=l.selectAll("g.sc-wrap.sc-line").data([t]),T=D.enter().append("g").attr("class","sc-wrap sc-line"),F=l.select(".sc-wrap.sc-line").merge(T),L=T.append("defs");T.append("g").attr("class","sc-group");var z=F.select(".sc-group");T.append("g").attr("class","sc-scatter-wrap");var P=F.select(".sc-scatter-wrap");F.attr("transform","translate("+o.left+","+o.top+")"),L.append("clipPath").attr("id","sc-edge-clip-"+S).append("rect"),F.select("#sc-edge-clip-"+S+" rect").attr("width",m).attr("height",b),F.attr("clip-path",g?"url(#sc-edge-clip-"+S+")":""),P.attr("clip-path",g?"url(#sc-edge-clip-"+S+")":"");var B=z.selectAll("g.sc-series").data(t,function(t){return t.seriesIndex}),E=B.enter().append("g").attr("class","sc-series").style("stroke-opacity",1e-6).style("fill-opacity",1e-6),_=z.selectAll(".sc-series").merge(E);_.classed("hover",function(t){return t.hover}).attr("class",k).attr("fill",y).attr("stroke",y),_.transition(C).style("stroke-opacity",1).style("fill-opacity",.5),B.exit().transition(C).style("stroke-opacity",1e-6).style("fill-opacity",1e-6).remove(),i.clipEdge(g).width(m).height(b),P.call(i);var H=_.selectAll("path.sc-area").data(function(t){return h(t)?[t]:[]}),N=H.enter().append("path").attr("class","sc-area sc-enter"),R=_.selectAll(".sc-area").merge(N);R.filter(function(t){return e.select(this).classed("sc-enter")}).attr("d",function(t){return A.apply(this,[t.values])}),R.transition(C).attr("d",function(t){return I.apply(this,[t.values])}).on("end",function(t){e.select(this).classed("sc-enter",!1)}),H.exit().remove(),B.exit().transition(C).selectAll(".sc-area").attr("d",function(t){return A.apply(this,[t.values])}).remove();var O=_.selectAll("path.sc-line").data(n,function(t){return t.seriesIndex}),V=O.enter().append("path").attr("class","sc-line sc-enter"),W=_.selectAll(".sc-line").merge(V);W.filter(function(t){return e.select(this).classed("sc-enter")}).attr("d",e.line().curve(M).defined(f).x(function(t,e){return r(u(t,e))}).y(function(t,e){return a(0)})),W.transition(C).attr("d",e.line().curve(M).defined(f).x(function(t,e){return r(u(t,e))}).y(function(t,e){return a(d(t,e))})).on("end",function(t){e.select(this).classed("sc-enter",!1)}),B.exit().transition(C).selectAll(".sc-line").attr("d",e.line().curve(M).defined(f).x(function(t,e){return r(u(t,e))}).y(function(t,e){return a(0)})).remove()}),t}var r,a,i=l(),o={top:0,right:0,bottom:0,left:0},s=960,c=500,u=function(t){return t.x},d=function(t){return t.y},f=function(t,e){return!isNaN(d(t,e))&&null!==d(t,e)},h=function(t){return t&&t.area||!1},p="linear",g=!1,m=0,v=300,y=function(t,e){return w.defaultColor()(t,t.seriesIndex)},x=null,b=y,k=function(t,e){return"sc-series sc-series-"+t.seriesIndex};return t.dispatch=i.dispatch,t.scatter=i,n.rebind(t,i,"id","interactive","size","xScale","yScale","zScale","xDomain","yDomain","sizeDomain","sizeRange","forceX","forceY","forceSize","useVoronoi","clipVoronoi","clipRadius","padData","padDataOuter","singlePoint","direction","nice","locality"),t.color=function(e){return arguments.length?(y=e,i.color(y),t):y},t.fill=function(e){return arguments.length?(b=e,i.fill(b),t):b},t.classes=function(e){return arguments.length?(k=e,i.classes(k),t):k},t.gradient=function(e){return arguments.length?(x=e,t):x},t.margin=function(e){if(!arguments.length)return o;for(var n in e)e.hasOwnProperty(n)&&(o[n]=e[n]);return t},t.width=function(e){return arguments.length?(s=e,t):s},t.height=function(e){return arguments.length?(c=e,t):c},t.x=function(e){return arguments.length?(u=e,i.x(e),t):u},t.y=function(e){return arguments.length?(d=e,i.y(e),t):d},t.delay=function(e){return arguments.length?(m=e,t):m},t.duration=function(e){return arguments.length?(v=e,i.duration(e),t):v},t.clipEdge=function(e){return arguments.length?(g=e,t):g},t.interpolate=function(e){return arguments.length?(p=e,t):p},t.defined=function(e){return arguments.length?(f=e,t):f},t.isArea=function(e){return arguments.length?(h=w.functor(e),t):h},t}function c(){function t(n){return n.each(function(n){function r(t,e){return Math.max(Math.round(Math.abs(d(p(t,e))-d(0))),0)}function a(){return u.bandwidth()/(v?1:n.length)}function g(t){return t.reverse().filter(function(t,e,n){return n.indexOf(t,e+1)===-1}).reverse()}function C(){var t=t||g($.map(h)),n=k?H:N,r=k?N:H,l=v?M:M*Y+M,s=M*(v?.25:1),c=Math.max(.25,(n-G*l-s)/(2*l));u.domain(t).range([0,n]).paddingInner(b?.3:.25).paddingOuter(c);var f=f||e.extent($.map(function(t){var e=k?0:t.y,n=k?t.y:0;return v?t.y>0?t.y0+e:t.y0+n:t.y}).concat(m)),p=k?[N,0]:[0,H];if(d.domain(f).range(p),y&&(k&&v&&e.max(U)+8>a()&&(X=!0),V=k&&!X?"labelHeight":"labelWidth"),"top"===K||"total"===K){var x=r,w=0,I=0,A=0;s=k?X?2:-2:2,tt.forEach(function(t,e){var n="total"===K&&v&&k&&!X?J:U[e];k&&t>0||!k&&t<0?d(t)-n<w&&(w=d(t)-n,A=n):d(t)+n>x&&(x=d(t)+n,I=n)}),k?d.range([r-(d.domain()[0]<0?I+s+2:0),d.domain()[1]>0?A+s:0]):d.range([d.domain()[0]<0?A+s+4:0,r-(d.domain()[1]>0?I+s:0)])}D&&d.nice(),i=i||u,o=o||d}function S(t,e,r){return{value:p(e,r),point:e,series:n[e.seriesIndex],pointIndex:r,seriesIndex:e.seriesIndex,groupIndex:e.group,id:f,e:t}}function P(t,e,n,r){var a=0,i=p(t,e)<0?-1:1,o=n===i<0?1:0,l=t.barLength-t[V];if(n?k:!k)a=(t.barThickness-(X===n?t.labelHeight:t.labelWidth))/2;else switch(K){case"start":a=l*(0+o)+r*i;break;case"middle":a=l/2;break;case"end":a=l*(1-o)-r*i;break;case"top":a=t.barLength*(1-o)-t.labelWidth*(0+o);break;case"total":a=t.barLength*(1-o)-(X===n?t.labelHeight:t.labelWidth)*(0+o)}return a}var _=e.select(this),H=s-l.left-l.right,N=c-l.top-l.bottom,R=k?"width":"height",O=k?"height":"width",V=k?"width":"height",W=k?"x":"y",q=k?"y":"x",Y=0,G=0,Z=0,j=n.length-1,X=!1,K=y,U=[],J=0;if(v?"top"!==K&&K!==!0||(K="end"):K&&("total"===K?K="top":K===!0&&(K="end"),X=k),v){var Q=[];n[0].values.map(function(t,e){var r=0,a=0;n.map(function(t){var n=t.values[e];n.size=Math.abs(n.y),n.y<0?(n.y0=a-(k?0:n.size),a-=n.size):(n.y0=r+(k?n.size:0),r+=n.size)}),Q[e]={neg:a,pos:r}})}var $=e.merge(n.map(function(t){return t.values.map(function(t,e){return{x:h(t,e),y:p(t,e),y0:t.y0}})}));if(G=n[0].values.length,Y=n.length,y){var tt="total"===K&&v?Q.map(function(t){return t.neg}).concat(Q.map(function(t){return t.pos})):$.map(p),et=e.extent(n.map(function(t,e){return t.seriesIndex}));Z=et[0],j=et[1],U=w.stringSetLengths(tt,_,x,"sc-label-value"),J=w.stringSetThickness(["Xy"],_,x,"sc-label-value")[0]}t.resetDimensions=function(t,e){s=t,c=e,H=t-l.left-l.right,N=e-l.top-l.bottom,C()},C();var nt=_.selectAll("g.sc-wrap.sc-multibar").data([n]),rt=nt.enter().append("g").attr("class","sc-wrap sc-multibar"),at=_.select(".sc-wrap.sc-multibar").merge(rt);at.attr("transform","translate("+l.left+","+l.top+")"),F=function(t,e,n){return w.colorLinearGradient(t,f+"-"+e,n,T(t,e),at.select("defs"))};var it=rt.append("defs");if(A&&(it.append("clipPath").attr("id","sc-edge-clip-"+f).append("rect"),at.select("#sc-edge-clip-"+f+" rect").attr("width",H).attr("height",N)),at.attr("clip-path",A?"url(#sc-edge-clip-"+f+")":""),z)var ot=w.createTexture(it,f);var lt=at.selectAll(".sc-series").data(w.identity),st=lt.enter().append("g").attr("class",B).style("stroke-opacity",1e-6).style("fill-opacity",1e-6);lt.exit().remove();var ct=at.selectAll(".sc-series").merge(st);ct.attr("fill",L).attr("class",function(t,e){return B(t,e)}).classed("hover",function(t){return t.hover}).classed("sc-active",function(t){return"active"===t.active}).classed("sc-inactive",function(t){return"inactive"===t.active}).style("stroke-opacity",1).style("fill-opacity",1),ct.on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)});var ut=ct.selectAll(".sc-bar").data(function(t){return t.values}),dt=ut.enter().append("g").attr("class","sc-bar");ut.exit().remove();var ft=ct.selectAll(".sc-bar").merge(dt);dt.append("rect").attr("class","sc-base").style("fill","inherit").attr("x",0).attr("y",0),z&&dt.append("rect").attr("class","sc-texture").attr("x",0).attr("y",0).style("mask","url("+ot+")"),dt.append("rect").attr("class","sc-label-box").attr("x",0).attr("y",0).attr("width",0).attr("height",0).attr("rx",2).attr("ry",2).style("fill","transparent").style("stroke-width",0).style("fill-opacity",0);var ht=dt.append("text").attr("class","sc-label-value"),pt=ft.select(".sc-label-value").merge(ht);ft.attr("class",function(t,e){return"sc-bar "+(p(t,e)<0?"negative":"positive")}).attr("transform",function(t,e){var n=v?{x:Math.round(u(h(t,e))),y:Math.round(d(t.y0))}:{x:Math.round(t.seri*a()+u(h(t,e))),y:Math.round(d(p(t,e)<0?k?0:p(t,e):k?p(t,e):0))};return"translate("+n[W]+","+n[q]+")"}),ft.select("rect.sc-base").attr(W,0).attr(O,r).attr(R,a),z&&ft.select("rect.sc-texture").attr(W,0).attr(O,r).attr(R,a).classed("sc-active",function(t){return"active"===t.active}).style("fill",function(t,e){var n=L(t),r=w.getTextContrast(n,e);return r}),ft.on("mouseover",function(t,n){var r=S(e.event,t,n);E.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;E.call("elementMousemove",this,r)}).on("mouseout",function(t,n){var r=S(e.event,t,n);E.call("elementMouseout",this,r)}).on("click",function(t,n){e.event.stopPropagation();var r=S(e.event,t,n);E.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=S(e.event,t,n);E.call("elementDblClick",this,r)}),y?(pt.text(function(t,e){var n="total"===K&&v?p(t,e)<0?Q[e].neg:Q[e].pos:p(t,e);return x(n)}).each(function(t,e){var n=this.getBoundingClientRect();t.labelWidth=Math.floor(n.width)+4,t.labelHeight=Math.floor(n.height),t.barLength=r(t,e),t.barThickness=a()}),pt.attr("dy","0.35em").attr("text-anchor",function(t,e){var n="middle",r=p(t,e)<0;if(k&&!X)n="middle";else{switch(K){case"start":n=r?"end":"start";break;case"middle":n="middle";break;case"end":n=r?"start":"end";break;case"top":case"total":n=r?"end":"start"}n="rtl"===I&&"middle"!==n?"start"===n?"end":"start":n}return n}).attr("transform","rotate("+(X?-90:0)+" 0,0)").attr("x",function(t,e){var n=0,r=p(t,e)<0?-1:1,a=r<0,i=(4+2*(X||!k))*r;if(k&&!X)n=t.barThickness/2;else switch(K){case"start":n=t.barLength*(a-X)+i;break;case"middle":n=t.barLength*(X?-1:1)/2;break;case"end":n=t.barLength*(!X-a)-i;break;case"top":case"total":n=t.barLength*(!X-a)+2*r}return n}).attr("y",function(t,e){var n=0,r=p(t,e)<0?-1:1,a=r<0,i=(t.labelHeight/2+(4+2*X)*("total"===K?0:1))*r;if(k&&!X)switch(K){case"start":n=t.barLength*(1-a)-i;break;case"middle":n=t.barLength/2;break;case"end":n=t.barLength*(0+a)+i;break;case"total":n=t.barLength*(0+a)+i*-1}else n=t.barThickness/2;return n}).style("fill",function(t,e,n){if("top"===K||"total"===K)return"#000";var r=L(t),a=w.getTextContrast(r,e);return a}).style("fill-opacity",function(t,e){if("total"===K){if(t.seriesIndex!==Z&&t.seriesIndex!==j)return 0;var n=p(t,e);return n<0&&Q[e].neg===t.y0+(k?n:0)||n>=0&&Q[e].pos===t.y0+(k?0:n)?1:0}var r=t.barLength<(!k||X?t.labelWidth:t.labelHeight)+8,a=t.barThickness<(!k||X?t.labelHeight:t.labelWidth)+4;return"top"!==K&&(r||a)?0:1}),"total"===K&&v&&ft.select("rect.sc-label-box").style("fill-opacity",0),ft.filter(function(t,e){return"total"!==K||!v||(t.seriesIndex===Z||t.seriesIndex===j)}).select("rect.sc-label-box").attr("x",function(t,e){return P(t,e,!0,4)}).attr("y",function(t,e){return P(t,e,!1,-4)}).attr("width",function(t,e){return X?t.labelHeight:t.labelWidth}).attr("height",function(t,e){return X?t.labelWidth:t.labelHeight}).style("fill",function(t,e){return"top"===K||"total"===K?"#fff":L(t,e)}).style("fill-opacity",function(t,e){var n=t.barLength<(!k||X?t.labelWidth:t.labelHeight)+8,r=t.barThickness<(!k||X?t.labelHeight:t.labelWidth)+4;return"top"!==K&&(n||r)?0:1})):(pt.text("").style("fill-opacity",0),ft.select("rect.label-box").style("fill-opacity",0)),i=u.copy(),o=d.copy()}),t}var n,r,a,i,o,l={top:0,right:0,bottom:0,left:0},s=960,c=500,u=e.scaleBand(),d=e.scaleLinear(),f=Math.floor(1e4*Math.random()),h=function(t){return t.x},p=function(t){return t.y},g=w.buildLocality(),m=[0],v=!0,y=!1,x=function(t){return t},b=!1,k=!0,M=60,I="ltr",A=!1,C=0,S=300,D=!1,T=function(t,e){return w.defaultColor()(t,t.seriesIndex)},F=null,L=T,z=!1,P=null,B=function(t,e){return"sc-series sc-series-"+t.seriesIndex},E=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove");return t.dispatch=E,t.color=function(e){return arguments.length?(T=e,t):T},t.fill=function(e){return arguments.length?(L=e,t):L},t.classes=function(e){return arguments.length?(B=e,t):B},t.gradient=function(e){return arguments.length?(F=e,t):F},t.x=function(e){return arguments.length?(h=e,t):h},t.y=function(e){return arguments.length?(p=e,t):p},t.margin=function(e){if(!arguments.length)return l;for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n]);return t},t.width=function(e){return arguments.length?(s=e,t):s},t.height=function(e){return arguments.length?(c=e,t):c},t.xScale=function(e){return arguments.length?(u=e,t):u},t.yScale=function(e){return arguments.length?(d=e,t):d},t.xDomain=function(e){return arguments.length?(r=e,t):r},t.yDomain=function(e){return arguments.length?(a=e,t):a},t.forceY=function(e){return arguments.length?(m=e,t):m},t.stacked=function(e){return arguments.length?(v=e,t):v},t.barColor=function(e){return arguments.length?(P=w.getColor(e),t):P},t.disabled=function(e){return arguments.length?(n=e,t):n},t.id=function(e){return arguments.length?(f=e,t):f},t.delay=function(e){return arguments.length?(C=e,t):C},t.duration=function(e){return arguments.length?(S=e,t):S},t.clipEdge=function(e){return arguments.length?(A=e,t):A},t.showValues=function(e){return arguments.length?(y=isNaN(parseInt(e,10))?e:parseInt(e,10)&&!0||!1,t):y},t.valueFormat=function(e){return arguments.length?(x=e,t):x},t.withLine=function(e){return arguments.length?(b=e,t):b},t.vertical=function(e){return arguments.length?(k=e,t):k},t.baseDimension=function(e){return arguments.length?(M=e,t):M},t.direction=function(e){return arguments.length?(I=e,t):I},t.nice=function(e){return arguments.length?(D=e,t):D},t.textureFill=function(e){return arguments.length?(z=e,t):z},t.locality=function(e){return arguments.length?(g=w.buildLocality(e),t):g},t}function u(){function t(o){return o.each(function(o){function l(t,e,n){return{id:i,key:u(e),value:d(e),count:f(e),data:e,series:e.series,e:t}}function s(t,n,r){function a(t){return(t+f)%l}var i=[],o=[],l=(Math.PI,2*Math.PI),s=0,c=Math.PI/2,u=Math.PI,d=3*Math.PI/2,f=0;t.each(function(t,e){var h=(O(t)+l)%l,p=(V(t)+l)%l,g=Math.round(1e4*Math.sin(h))/1e4,m=Math.round(1e4*Math.sin(p))/1e4,v=Math.round(1e4*Math.cos(h))/1e4,y=Math.round(1e4*Math.cos(p))/1e4;f=p<h?l-h:0,p===h?(h=0,p=l):(h=a(h),p=a(p)),s=a(s),c=a(c),u=a(u),d=a(d),h%l!==0&&p%l!==0||(o.push(r),T&&o.push(r*_)),h<=c&&p>=c&&(i.push(n),T&&i.push(n*_)),h<=u&&p>=u&&(o.push(-r),T&&o.push(-r*_)),h<=d&&p>=d&&(i.push(-n),T&&i.push(-n*_)),i.push(n*g),i.push(n*m),T?(i.push(n*_*g),i.push(n*_*m)):i.push(0),o.push(r*v),o.push(r*y),T?(o.push(r*_*v),o.push(r*_*y)):o.push(0)}),lt=e.extent(i),st=e.extent(o),it*=m/(e.max(lt)-e.min(lt)),ot*=B/(e.max(st)-e.min(st))}function c(){var t=[it],n=[ot+z];et.select(".sc-base").each(function(e,r){if(h(e)){var a=(O(e)+V(e))/2,i=Math.sin(a),o=Math.cos(a),l=it-dt-Y[r],s=ot-ut,c=i?l/i:l,u=o?s/o:s;t.push(c),n.push(u)}});var r=e.min(t.concat(n).concat([]),function(t){return Math.abs(t)});return r}function h(t){var e=(V(t)-O(t))/(2*Math.PI);return e>D?1:0}function g(t,e){var n=2*Math.PI,r=((O(t)+V(t))/2+n)%n;return r>0&&r<Math.PI?1:-1}var m=r-n.left-n.right,B=a-n.top-n.bottom,E=e.select(this);y=function(t,e){var n={x:0,y:0,r:yt,s:T?100*_+"%":"0%",u:"userSpaceOnUse"};return w.colorRadialGradient(t,i+"-"+e,n,v(t,e),X.select("defs"))};var Y=[],G=!(!I||!C);G&&(Y=w.stringSetLengths(o,E,u,"sc-label"));var Z=E.selectAll("g.sc-wrap").data([o]),j=Z.enter().append("g").attr("class","sc-wrap sc-pie"),X=E.select(".sc-wrap.sc-pie").merge(j),K=j.append("defs");j.append("g").attr("class","sc-group");var U=X.select(".sc-group");j.append("g").attr("class","sc-hole-wrap");var J=X.select(".sc-hole-wrap");if(X.attr("transform","translate("+n.left+","+n.top+")"),b)var Q=w.createTexture(K,i,-m/2,-B/2);var $=U.selectAll(".sc-series").data(q),tt=$.enter().append("g").attr("class","sc-series");$.exit().remove();var et=U.selectAll(".sc-series").merge(tt);tt.style("stroke","#FFF").style("stroke-width",2).style("stroke-opacity",0).on("mouseover",function(t,n,r){e.select(this).classed("hover",!0)}).on("mouseout",function(t,n,r){e.select(this).classed("hover",!1)}),et.attr("class",function(t){return k(t.data,t.data.seriesIndex)}).attr("fill",function(t){return x(t.data,t.data.seriesIndex)}).classed("sc-active",function(t){return"active"===t.data.active}).classed("sc-inactive",function(t){return"inactive"===t.data.active});var nt=et.selectAll("g.sc-slice").data(function(t,e){return t.data.values.map(function(e,n){return e.endAngle=t.endAngle,e.padAngle=t.padAngle,
e.startAngle=t.startAngle,e})},function(t){return t.seriesIndex});nt.exit().remove();var rt=nt.enter().append("g").attr("class","sc-slice"),at=et.selectAll("g.sc-slice").merge(rt);rt.append("path").attr("class","sc-base").each(function(t,e){this._current=t}),b&&rt.append("path").attr("class","sc-texture").each(function(t,e){this._current=t}).style("mask","url("+Q+")"),rt.on("mouseover",function(t,n){e.select(this).classed("hover",!0);var r=l(e.event,t,n);M.call("elementMouseover",this,r)}).on("mousemove",function(t,n){var r=e.event;M.call("elementMousemove",this,r)}).on("mouseout",function(t,n){e.select(this).classed("hover",!1),M.call("elementMouseout",this)}).on("click",function(t,n){e.event.stopPropagation();var r=l(e.event,t,n);M.call("elementClick",this,r)}).on("dblclick",function(t,n){e.event.stopPropagation();var r=l(e.event,t,n);M.call("elementDblClick",this,r)}),rt.append("g").attr("class","sc-label").attr("transform","translate(0,0)"),rt.select(".sc-label").append("rect").style("fill-opacity",0).style("stroke-opacity",0),rt.select(".sc-label").append("text").style("fill-opacity",0),rt.append("polyline").attr("class","sc-label-leader").style("stroke-opacity",0);var it=m/2,ot=B/2,lt=[],st=[],ct=0,ut=G?5:0,dt=z+P;if(at.select(".sc-base").call(s,it,ot),J.call(R,F?[F]:[]),F){var ft=.3*J.node().getBoundingClientRect().height,ht=Math.abs(ot*e.min(st)),pt=Math.round(ft-ht);pt>0&&(ut+=pt,ct-=pt/2)}var gt=m/2,mt=B/2;G&&(z=Math.max(Math.min(Math.min(c())/12,20),10)),W(t)&&(H=W(t),N=W(t));var vt=Math.min(Math.max(c(),H),N),yt=vt-(G?z:0);mt+=((e.max(st)-e.min(st))/2+e.min(st))*((vt+ct)/mt),gt+=((e.max(lt)-e.min(lt))/2-e.max(lt))*(vt/gt),mt+=ct/2,U.attr("transform","translate("+gt+","+mt+")"),J.attr("transform","translate("+gt+","+mt+")"),U.select(Q).attr("x",-yt/2).attr("y",-yt/2);var xt=e.arc().innerRadius(T?yt*_:0).outerRadius(yt).startAngle(O).endAngle(V),bt=e.arc().innerRadius(0).outerRadius(yt).startAngle(O).endAngle(V);C&&(!T||S?bt.innerRadius(vt).outerRadius(vt):bt.outerRadius(yt*_)),at.select(".sc-base").attr("d",xt).style("stroke-opacity",function(t){return O(t)===V(t)?0:1}),b&&at.select(".sc-texture").attr("d",xt).style("stroke-opacity",function(t){return O(t)===V(t)?0:1}).style("fill",function(t,n){var r=e.select(this.parentNode).style("fill");return w.getTextContrast(r,n)}),I?(at.select(".sc-label").attr("transform",function(t){if(L){t.outerRadius=yt+10,t.innerRadius=yt+15;var e=(O(t)+V(t))/2*(180/Math.PI);return e+=90*g(t,bt),"translate("+bt.centroid(t)+") rotate("+e+")"}var n=bt.centroid(t),r=A?(z+P)*g(t,bt):0;return"translate("+[n[0]+r,n[1]]+")"}),at.select(".sc-label text").text(u).attr("dy",".35em").style("fill","#555").style("fill-opacity",h).style("text-anchor",function(t){if(!C)return"middle";var e=1===g(t,bt)?"start":"end";return"rtl"===p&&(e="start"===e?"end":"start"),e}),at.each(function(t,n){if(Y[n]>H||vt===H){var r=(O(t)+V(t))/2,a=Math.abs(Math.sin(r)),i=vt*a+z+P+Y[n],o=m/2-gt+m/2-i;if(o<0){var l=w.stringEllipsify(u(t),E,Y[n]+o);e.select(this).select("text").text(l)}}}),C?A&&at.select(".sc-label-leader").attr("points",function(t){if(!h(t))return"0,0 0,0";var n=e.arc().innerRadius(yt).outerRadius(yt).startAngle(O).endAngle(V),r=A?z*g(t,n):0,a=n.centroid(t),i=bt.centroid(t),o=[i[0]+r,i[1]];return a+" "+i+" "+o}).style("stroke","#AAA").style("fill","none").style("stroke-opacity",h):at.select(".sc-label").each(function(t){if(h(t)){var n=e.select(this),r=n.select("text").node().getBoundingClientRect();n.select("rect").attr("rx",3).attr("ry",3).attr("width",r.width+10).attr("height",r.height+10).attr("transform",function(){return"translate("+[r.x-5,r.y-5]+")"}).style("fill","#FFF").style("fill-opacity",h)}})):(at.select(".sc-label-leader").style("stroke-opacity",0),at.select(".sc-label rect").style("fill-opacity",0),at.select(".sc-label text").style("fill-opacity",0))}),t}var n={top:0,right:0,bottom:0,left:0},r=500,a=500,i=Math.floor(1e4*Math.random()),o=function(t){return t.x},l=function(t){return t.y},s=function(t){return t.key},c=function(t,e){return t.value},u=function(t){return s(t.series||t)},d=function(t){return c(t.series||t)},f=function(t){return(" ("+(t.series.count||t.count)+")").replace(" ()","")},h=w.buildLocality(),p="ltr",g=0,m=0,v=function(t,e){return w.defaultColor()(t.series,t.seriesIndex)},y=null,x=v,b=!1,k=function(t,e){return"sc-series sc-series-"+t.seriesIndex},M=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout","elementMousemove"),I=!0,A=!0,C=!0,S=!0,D=.01,T=!1,F=!1,L=!1,z=20,P=5,B=360,E=0,_=.447,H=75,N=250,R=function(t,e){var n=t.selectAll(".sc-hole-container").data(e),r=n.enter().append("g").attr("class","sc-hole-container");r.append("text").text(e).attr("class","sc-pie-hole-value").attr("dy",".35em").attr("text-anchor","middle").style("font-size","50px"),n.exit().remove()},O=function(t){return t.startAngle*B/360+w.angleToRadians(E)},V=function(t){return t.endAngle*B/360+w.angleToRadians(E)},W=function(t){return null},q=e.pie().sort(null).value(c);return t.dispatch=M,t.id=function(e){return arguments.length?(i=e,t):i},t.color=function(e){return arguments.length?(v=e,t):v},t.fill=function(e){return arguments.length?(x=e,t):x},t.classes=function(e){return arguments.length?(k=e,t):k},t.gradient=function(e){return arguments.length?(y=e,t):y},t.margin=function(e){return arguments.length?(n.top="undefined"!=typeof e.top?e.top:n.top,n.right="undefined"!=typeof e.right?e.right:n.right,n.bottom="undefined"!=typeof e.bottom?e.bottom:n.bottom,n.left="undefined"!=typeof e.left?e.left:n.left,t):n},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(l=w.functor(e),t):l},t.getKey=function(e){return arguments.length?(s=e,t):s},t.getValue=function(e){return arguments.length?(c=e,t):c},t.fmtKey=function(e){return arguments.length?(u=e,t):u},t.fmtValue=function(e){return arguments.length?(d=e,t):d},t.fmtCount=function(e){return arguments.length?(f=e,t):f},t.direction=function(e){return arguments.length?(p=e,t):p},t.delay=function(e){return arguments.length?(g=e,t):g},t.duration=function(e){return arguments.length?(m=e,t):m},t.locality=function(e){return arguments.length?(h=w.buildLocality(e),t):h},t.textureFill=function(e){return arguments.length?(b=e,t):b},t.showLabels=function(e){return arguments.length?(I=e,t):I},t.labelSunbeamLayout=function(e){return arguments.length?(L=e,t):L},t.donutLabelsOutside=function(e){return arguments.length?(S=e,t):S},t.pieLabelsOutside=function(e){return arguments.length?(C=e,t):C},t.showLeaders=function(e){return arguments.length?(A=e,t):A},t.donut=function(e){return arguments.length?(T=e,t):T},t.hole=function(e){return arguments.length?(F=e,t):F},t.holeFormat=function(e){return arguments.length?(R=w.functor(e),t):R},t.donutRatio=function(e){return arguments.length?(_=e,t):_},t.startAngle=function(e){return arguments.length?(O=e,t):O},t.endAngle=function(e){return arguments.length?(V=e,t):V},t.labelThreshold=function(e){return arguments.length?(D=e,t):D},t.arcDegrees=function(e){return arguments.length?(B=Math.max(Math.min(e,360),1),t):B},t.rotateDegrees=function(e){return arguments.length?(E=e%360,t):E},t.minRadius=function(e){return arguments.length?(H=e,t):H},t.maxRadius=function(e){return arguments.length?(N=e,t):N},t.fixedRadius=function(e){return arguments.length?(W=w.functor(e),t):W},t}function d(){function t(d,f,h,p){function g(){if(c){var t=e.zoom().on("zoom",l),n=e.drag().subject(function(t){return t}).on("drag",l);h.call(t),F.call(t),h.call(n),F.call(n)}else h.on(".zoom",null),F.on(".zoom",null),h.on(".drag",null),F.on(".drag",null)}function m(){B.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-prev-"+n);var t=B.select("#sc-back-gradient-prev-"+n);B.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-back-gradient-more-"+n);var e=B.select("#sc-back-gradient-more-"+n);t.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",0),t.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),e.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),e.append("stop").attr("stop-color","#000").attr("stop-opacity","0.3").attr("offset",1),B.append("linearGradient").attr("class","sc-scroll-gradient").attr("id","sc-fore-gradient-prev-"+n);var r=B.select("#sc-fore-gradient-prev-"+n);B.append("linearGradient").attr("class","sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0).attr("id","sc-fore-gradient-more-"+n);var a=B.select("#sc-fore-gradient-more-"+n);r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",0),r.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",1),a.append("stop").attr("stop-color","#FFF").attr("stop-opacity","0").attr("offset",0),a.append("stop").attr("stop-color","#FFF").attr("stop-opacity","1").attr("offset",1),P.selectAll(".sc-scroll-gradient").attr("gradientUnits","objectBoundingBox").attr("x1",0).attr("y1",0)}function v(){P.selectAll(".sc-scroll-gradient").attr("x2",r?1:0).attr("y2",r?0:1)}function y(){B.append("clipPath").attr("class","sc-scroll-mask").attr("id","sc-edge-clip-"+n).append("rect"),T=P.select(".sc-scroll-mask rect")}function x(){h.attr("clip-path",c?"url(#sc-edge-clip-"+n+")":"")}function b(t,e){T.attr("x",r?2:-u.left).attr("y",r?0:2).attr("width",t+(r?-2:u.left)).attr("height",e+(r?u.bottom:-2))}function w(){f.select(".sc-scroll-background").append("rect").attr("class","sc-scroll-target").attr("fill","transparent"),F=d.select(".sc-scroll-target")}function k(t,e,n,r){F.attr("x",t).attr("y",e).attr("width",n).attr("height",r)}function M(){var t=f.select(".sc-scroll-background").append("g").attr("class","sc-back-shadow-wrap");t.append("rect").attr("class","sc-back-shadow-prev"),t.append("rect").attr("class","sc-back-shadow-more"),L=d.select(".sc-back-shadow-wrap")}function I(){var t=r?"width":"height";L.select("rect.sc-back-shadow-prev").attr("fill",c?"url(#sc-back-gradient-prev-"+n+")":"transparent").attr(t,7),L.select("rect.sc-back-shadow-more").attr("fill",c?"url(#sc-back-gradient-more-"+n+")":"transparent").attr(t,7)}function A(t,e,n,a,i,o){L.select(".sc-back-shadow-prev").attr("x",t).attr("y",e).attr(i,o),L.select(".sc-back-shadow-more").attr("x",t+(r?n-5:1)).attr("y",e+(r?0:a-6)).attr(i,o)}function C(){var t=f.select(".sc-scroll-background").insert("g").attr("class","sc-fore-shadow-wrap");t.append("rect").attr("class","sc-fore-shadow-prev"),t.append("rect").attr("class","sc-fore-shadow-more"),z=d.select(".sc-fore-shadow-wrap")}function S(){var t=r?"width":"height";z.select(".sc-fore-shadow-prev").attr("fill",c?"url(#sc-fore-gradient-prev-"+n+")":"transparent").attr(t,20),z.select(".sc-fore-shadow-more").attr("fill",c?"url(#sc-fore-gradient-more-"+n+")":"transparent").attr(t,20)}function D(t,e,n,a){z.select(".sc-fore-shadow-prev").attr("x",t+(r?1:0)).attr("y",e+(r?0:1)).attr(n,a),z.select(".sc-fore-shadow-more").attr("x",t+(r?o-17:0)).attr("y",e+(r?0:o-19)).attr(n,a)}var T,F,L,z,P=d.select("defs"),B=f.select("defs"),E=h.select(".sc-axis-wrap.sc-axis-x"),_=h.select(".sc-bars-wrap"),H=0;return m(),y(),w(),M(),C(),t.render=function(){g(),v(),x(),I(),S()},t.resize=function(e,n){var o,l,d,f,h,g,m;H=e,s=n,t.render(),c&&(o=p.labelThickness()+p.tickPadding()/2,l=r?u.left:o,d=u.top,f=a+(r?0:u[p.orient()]-o),h=i+(r?u[p.orient()]-o:0),g=r?"height":"width",m=r?h:f,b(a,i),k(l,d,f,h),A(l,d,a,i,g,m),D(l,d,g,m))},t.pan=function(t){var n=0,a=0,i="",o=0,l=0;if(e.event){if("zoom"===e.event.type&&e.event.sourceEvent)o=e.event.sourceEvent.deltaX||0,l=e.event.sourceEvent.deltaY||0,n=(Math.abs(o)>Math.abs(l)?o:l)*-1;else if("drag"===e.event.type)o=e.event.dx||0,l=e.event.dy||0,n=r?o:l;else if("click"!==e.event.type)return 0;a=Math.abs(l)>Math.abs(o)?l:0}return H=Math.min(Math.max(H+n,t),-1),i="translate("+(r?H+",0":"0,"+H)+")",(H+n>0||H+n<t)&&s(a),z.attr("transform",i),_.attr("transform",i),E.select(".sc-wrap.sc-axis").attr("transform",i),H},t}var n,r,a,i,o,l,s,c,u={};return t.id=function(e){return arguments.length?(n=e,t):n},t.margin=function(e){return arguments.length?(u.top="undefined"!=typeof e.top?e.top:u.top,u.right="undefined"!=typeof e.right?e.right:u.right,u.bottom="undefined"!=typeof e.bottom?e.bottom:u.bottom,u.left="undefined"!=typeof e.left?e.left:u.left,t):u},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.vertical=function(e){return arguments.length?(r=e,t):r},t.minDimension=function(e){return arguments.length?(o=e,t):o},t.panHandler=function(e){return arguments.length?(l=w.functor(e),t):l},t.enable=function(e){return arguments.length?(c=e,t):c},t}function f(){function t(n){return n.each(function(n){function r(e){var n=e&&e.length,r=(Y-s.left-s.right)/2+s.left,a=(G-s.top-s.bottom)/2+s.top;return w.displayNoData(n,O,t.strings().noData,r,a)}function o(t){var n=e.extent(e.merge(t.map(function(t){return t.values.map(function(t,n){return e.timeParse("%Y-%m-%d")(p(t))})}))),r=[e.timeMonth.floor(n[0]),e.timeDay.offset(e.timeMonth.ceil(n[1]),-1)];return r}function l(t){function n(t){return 32-new Date(t.getFullYear(),t.getMonth(),32).getDate()}var r=e.timeMonth.range(t[0],t[1]),a=r.map(function(t){return e.timeDay.offset(e.timeMonth.floor(t),n(t)/2-1)});return a}function v(t){var n=e.nest().key(x).entries(t),r=1e3/n.length,a=.25*r,i=[0,1],o=[0,1],l=e.scaleLinear().domain(i).range(o),s=[],c=0;return n.map(function(t,e){return t.total=0,t.values=t.values.sort(function(t,e){return e.y<t.y?-1:e.y>t.y?1:0}).map(function(e){return t.total+=e.y,e}),t.group=e,t}).sort(function(t,e){return t.total<e.total?-1:t.total>e.total?1:0}).map(function(t,n){return c+=t.total,i=e.extent(t.values.map(function(t){return t.y})),o=[r*n+a,r*(n+1)-a],l.domain(i).range(o),t.values=t.values.map(function(e){return e.group=t.group,e.opportunity=e.y,e.y=l(e.opportunity),e}),s.push({key:t.key,y:e.min(t.values.map(function(t){return t.y}))}),t}),s}var A,B,H,N,R=this,O=e.select(this),V="bubble",W=n?n.properties||{}:{},q=n?n.data||[]:[],Y=parseInt(O.style("width"),10),G=parseInt(O.style("height"),10),Z=c,j=u,X="datetime"===W.xDataType||!1,K="currency"===W.yDataType||!1,U=function(t,e,n,r){return S(t,e,t,X)},J=function(t,e,n,r){var a=N&&Array.isArray(N)?N[e].key||t:t,i=Math.max(.2*Z,75);return isNaN(a)?w.stringEllipsify(a,O,i):D(t,e,a,K)};if(t.update=function(){O.transition().duration(y).call(t)},t.container=this,r(q))return t;d=d&&W.title,I.disabled=q.map(function(t){return!!t.disabled});var Q=e.nest().key(b).entries(q);A=Q.sort(function(t,e){return parseInt(t.key,10)<parseInt(e.key,10)?-1:parseInt(t.key,10)>parseInt(e.key,10)?1:0}).map(function(t,e){return t.seriesIndex=e,t.classes=t.values[0].classes,t.color=t.values[0].color,t}),B=o(A),N=v(q),H=e.extent(e.merge(A.map(function(t){return t.values.map(function(t,e){return g(t,e)})})).concat(m)),a=T.xScale(),i=T.yScale(),F.orient("bottom").scale(a).valueFormat(U).ticks(e.timeMonths,1).tickValues(l(B)).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),L.orient("left").scale(i).valueFormat(J).ticks(N.length).tickValues(N.map(function(t,e){return N[e].y})).tickPadding(7).highlightZero(!1).showMaxMin(!1),t.render=function(){function e(){i.left=Math.max(X.left,q.left),i.right=Math.max(X.right,q.right),i.top=Math.max(X.top,q.top)+g,i.bottom=Math.max(X.bottom,q.bottom)}function n(){o=Z-i.left-i.right,l=j-i.top-i.bottom,T.resetDimensions(o,l)}var r,a,i,o,l;Y=parseInt(O.style("width"),10),G=parseInt(O.style("height"),10),r=c||Y||960,a=u||G||400,Z=r-s.left-s.right,j=a-s.top-s.bottom,i={top:0,right:0,bottom:0,left:0},o=Z-i.left-i.right,l=j-i.top-i.bottom;var p=Math.sqrt(T.sizeRange()[1]/Math.PI),g=0,m={width:0,height:0},v="",x=O.selectAll("g.sc-chart-wrap").data([A]),b=x.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+V),k=O.select(".sc-chart-wrap").merge(b);b.append("rect").attr("class","sc-background").attr("x",-s.left).attr("y",-s.top).attr("fill","#FFF"),k.select(".sc-background").attr("width",r).attr("height",a),b.append("g").attr("class","sc-title-wrap");var M=k.select(".sc-title-wrap");b.append("g").attr("class","sc-axis-wrap sc-axis-x");var I=k.select(".sc-axis-wrap.sc-axis-x");b.append("g").attr("class","sc-axis-wrap sc-axis-y");var C=k.select(".sc-axis-wrap.sc-axis-y");b.append("g").attr("class","sc-"+V+"-wrap");var S=k.select(".sc-"+V+"-wrap");b.append("g").attr("class","sc-legend-wrap");var D=k.select(".sc-legend-wrap");if(k.attr("transform","translate("+s.left+","+s.top+")"),M.select(".sc-title").remove(),d&&(M.append("text").attr("class","sc-title").attr("x","rtl"===h?Z:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(W.title),m=w.getTextBBox(M.select(".sc-title")),g+=m.height),f){z.id("legend_"+t.id()).strings(t.strings().legend).align("center").height(j-g),D.datum(A).call(z),z.arrange(Z);var P=w.getTextBBox(D.select(".sc-menu-link")),E=Z-m.width-6,_=!!(d&&z.collapsed()&&E>P.width),N="rtl"!==h&&z.collapsed()?Z-z.width():0,R=m.height;_?R=m.height-z.height()/2-P.height/2:d||(R=-z.margin().top),D.attr("transform","translate("+N+","+R+")"),g+=_?12:z.height()}l=j-g-i.top-i.bottom,T.width(o).height(l).id(t.id()).xDomain(B).yDomain(H),S.datum(A.filter(function(t){return!t.disabled})).transition().duration(y).call(T),i.top+=p;var q={top:0,right:0,bottom:0,left:0},X={top:0,right:0,bottom:0,left:0};L.margin(i),C.call(L),q=L.margin(),e(),n(),F.tickSize(0).margin(i),I.call(F),X=F.margin(),e(),n(),L.tickSize(-o,0).margin(i),C.call(L),C.select("path.domain").attr("d","M0,0V0.5H0V"+l),S.transition().duration(t.delay()).call(T),v=i.left+",",v+=i.top+("bottom"===F.orient()?l:0),I.attr("transform","translate("+v+")"),v=i.left+("left"===L.orient()?0:o)+",",v+=i.top,C.attr("transform","translate("+v+")"),S.attr("transform","translate("+i.left+","+i.top+")")},t.render(),z.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,A.filter(function(t){return!t.disabled}).length||A.map(function(t){return t.disabled=!1,O.selectAll(".sc-series").classed("disabled",!1),t}),I.disabled=A.map(function(t){return!!t.disabled}),C.call("stateChange",this,I),O.transition().call(t.render)}),C.on("tooltipShow",function(t){M&&(P=E(t,R.parentNode,W))}),C.on("tooltipMove",function(t){P&&k.position(R.parentNode,P,t,"s")}),C.on("tooltipHide",function(){M&&k.cleanup()}),C.on("changeState",function(e){"undefined"!=typeof e.disabled&&(q.forEach(function(t,n){t.disabled=e.disabled[n]}),I.disabled=e.disabled),O.transition().call(t)}),C.on("chartClick",function(){C.call("tooltipHide",this),z.enabled()&&z.dispatch.call("closeMenu",this)}),T.dispatch.on("elementClick",function(e){C.call("chartClick",this),_(q,e,t)})}),t}var a,i,s={top:10,right:10,bottom:10,left:10},c=null,u=null,d=!1,f=!0,h="ltr",p=function(t){return t.x},g=function(t){return t.y},m=[0],v=200,y=0,x=function(t){return t.y},b=function(t){return t.y},M=(e.timeFormat("%Y-%m-%d"),!0),I={},A={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},C=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),S=function(e,n,r,a){return a?w.dateFormat(r,"MMM",t.locality()):r},D=function(e,n,r,a){var i=2;return w.numberFormatSI(r,i,a,t.locality())},T=l().padData(!0).padDataOuter(-1).size(function(t){return t.y}).sizeRange([256,1024]).singlePoint(!0),F=r(),L=r(),z=o().align("center").key(function(t){return t.key+"%"}),P=null,B=function(t,e){var n=t.series.key,r=t.point.x,a=t.point.y;return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},E=function(t,e,n){var r=B(t,n),a=t.value<0?"n":"s";return k.show(t.e,r,a,null,e)},_=function(t,e,n){};return T.dispatch.on("elementMouseover.tooltip",function(t){C.call("tooltipShow",this,t)}),T.dispatch.on("elementMousemove.tooltip",function(t){C.call("tooltipMove",this,t)}),T.dispatch.on("elementMouseout.tooltip",function(){C.call("tooltipHide",this)}),t.dispatch=C,t.scatter=T,t.legend=z,t.xAxis=F,t.yAxis=L,n.rebind(t,T,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),n.rebind(t,T,"size","zScale","sizeDomain","forceSize","interactive","clipVoronoi","clipRadius"),n.rebind(t,F,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n};break;case"data":i=function(t,e){return t.classes?"inherit":t.color||w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){return T.gradient()(t,t.seriesIndex)}:i;return T.color(i),T.fill(l),T.classes(o),z.color(i),z.classes(o),t},t.margin=function(e){if(!arguments.length)return s;for(var n in e)e.hasOwnProperty(n)&&(s[n]=e[n]);return t},t.width=function(e){return arguments.length?(c=e,t):c},t.height=function(e){return arguments.length?(u=e,t):u},t.showTitle=function(e){return arguments.length?(d=e,t):d},t.showLegend=function(e){return arguments.length?(f=e,t):f},t.tooltips=function(e){return arguments.length?(M=e,t):M},t.tooltipContent=function(e){return arguments.length?(B=e,t):B},t.state=function(e){return arguments.length?(I=e,t):I},t.strings=function(e){if(!arguments.length)return A;for(var n in e)e.hasOwnProperty(n)&&(A[n]=e[n]);return t},t.direction=function(e){return arguments.length?(h=e,F.direction(e),L.direction(e),z.direction(e),t):h},t.duration=function(e){return arguments.length?(y=e,T.duration(e),t):y},t.delay=function(e){return arguments.length?(v=e,T.delay(e),t):v},t.seriesClick=function(e){return arguments.length?(_=e,t):_},t.colorFill=function(e){return t},t.groupBy=function(e){return arguments.length?(x=e,t):x},t.filterBy=function(e){return arguments.length?(b=e,t):b},t.xValueFormat=function(e){return arguments.length?(S=e,t):S},t.yValueFormat=function(e){return arguments.length?(D=e,t):D},t}function h(){function t(n){return n.each(function(n){function a(e){var n=e&&e.length,a=(S-r.left-r.right)/2+r.left,i=(D-r.top-r.bottom)/2+r.top;return w.displayNoData(n,c,t.strings().noData,a,i)}var o=this,c=e.select(this),f="funnel",m=n?n.properties:{},I=n?n.data:null,S=parseInt(c.style("width"),10),D=parseInt(c.style("height"),10);"datetime"===n.properties.xDataType||!1,"currency"===n.properties.yDataType||!1;if(t.update=function(){c.transition().duration(h).call(t)},t.container=this,a(I))return t;t.clearActive=function(){I.map(function(t){return t.active="",t.values[0].active="",c.selectAll(".nv-series").classed("nv-inactive",!1),t})},t.seriesActivate=function(e){t.dataSeriesActivate({series:I[e.seriesIndex]})},t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active","active"===n.active&&I.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t}),I.filter(function(t){return"active"===t.active}).length||t.clearActive(),c.call(t)},I.forEach(function(t,n){var r=y.y();t.seriesIndex=n,t.value||t.values?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[],t.values.forEach(function(e,n){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=r(e))}),t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var T=I.filter(function(t,e){return!t.disabled});if(T.length||(T=[{values:[]}]),m.count=e.sum(T,function(t){return t.count}),m.total=e.sum(T,function(t){return t.value}),s=s&&m.title.length,g.disabled=I.map(function(t){return!!t.disabled}),!m.total)return a(),t;var F=c.selectAll("g.sc-chart-wrap").data([T]),L=F.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+f),z=c.select(".sc-chart-wrap").merge(L);L.append("rect").attr("class","sc-background").attr("x",-r.left).attr("y",-r.top).attr("fill","#FFF"),L.append("g").attr("class","sc-title-wrap");var P=z.select(".sc-title-wrap");L.append("g").attr("class","sc-"+f+"-wrap");var B=z.select(".sc-"+f+"-wrap");L.append("g").attr("class","sc-controls-wrap");z.select(".sc-controls-wrap");L.append("g").attr("class","sc-legend-wrap");var E=z.select(".sc-legend-wrap");t.render=function(){var e,n,a,o,f,p,g;S=parseInt(c.style("width"),10),D=parseInt(c.style("height"),10),e=i||S||960,n=l||D||400,a=e-r.left-r.right,o=n-r.top-r.bottom,f={top:0,right:0,bottom:0,left:0},p=a-f.left-f.right,g=o-f.top-f.bottom,z.attr("transform","translate("+r.left+","+r.top+")"),z.select(".sc-background").attr("width",e).attr("height",n);var v=0,x={width:0,height:0},k=0;if(P.select(".sc-title").remove(),s&&(P.append("text").attr("class","sc-title").attr("x","rtl"===d?a:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(m.title),x=w.getTextBBox(P.select(".sc-title")),v+=x.height),u){b.id("legend_"+t.id()).strings(t.strings().legend).align("center").height(o-f.top),E.datum(I).call(b),b.arrange(a);var M=w.getTextBBox(E.select(".sc-menu-link")),A=a-x.width-6,C=!!(s&&b.collapsed()&&A>M.width),F="rtl"!==d&&b.collapsed()?a-b.width():0,L=x.height;C?L=x.height-b.height()/2-M.height/2:s||(L=-b.margin().top),E.attr("transform","translate("+F+","+L+")"),k=C?12:b.height()-(s?0:b.margin().top)}v+=k,f.top+=v,g=o-f.top-f.bottom,p=a-f.left-f.right,y.width(p).height(g),B.datum(T).attr("transform","translate("+f.left+","+f.top+")").transition().duration(h).call(y)},t.render(),b.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,e.active=!1,I.filter(function(t){return!t.disabled}).length||I.map(function(t){return t.disabled=!1,t}),I.filter(function(t){return"active"===t.active}).length||I.map(function(t){return t.active="",t}),g.disabled=I.map(function(t){return!!t.disabled}),v.call("stateChange",this,g),c.transition().duration(h).call(t)}),v.on("tooltipShow",function(t){p&&(M=A(t,o.parentNode,m))}),v.on("tooltipMove",function(t){M&&k.position(o.parentNode,M,t)}),v.on("tooltipHide",function(){p&&k.cleanup()}),v.on("changeState",function(e){"undefined"!=typeof e.disabled&&(T.forEach(function(t,n){t.disabled=e.disabled[n]}),g.disabled=e.disabled),c.transition().duration(h).call(t)}),v.on("chartClick",function(){x.enabled()&&x.dispatch.call("closeMenu",this),b.enabled()&&b.dispatch.call("closeMenu",this)}),y.dispatch.on("elementClick",function(e){v.call("chartClick",this),C(I,e,t)})}),t}var r={top:10,right:10,bottom:10,left:10},i=null,l=null,s=!1,c=!1,u=!0,d="ltr",f=0,h=0,p=!0,g={},m={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},v=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),y=a(),x=o().align("center"),b=o().align("center"),M=null,I=function(t,e){var n=y.fmtKey()(t),r=y.getValue()(t),a=e.total?(100*r/e.total).toFixed(1):100;return"<h3>"+n+"</h3><p>"+r+" on "+a+"</p>"},A=function(t,e,n){var r=I(t,n);return k.show(t.e,r,null,null,e)},C=function(t,e,n){};return y.dispatch.on("elementMouseover.tooltip",function(t){v.call("tooltipShow",this,t)}),y.dispatch.on("elementMousemove.tooltip",function(t){v.call("tooltipMove",this,t)}),y.dispatch.on("elementMouseout.tooltip",function(){v.call("tooltipHide",this)}),t.dispatch=v,t.funnel=y,t.legend=b,t.controls=x,n.rebind(t,y,"id","x","y","color","fill","classes","gradient","locality","textureFill"),n.rebind(t,y,"getKey","getValue","fmtKey","fmtValue","fmtCount"),n.rebind(t,y,"yScale","yDomain","forceY","wrapLabels","minLabelWidth"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n};break;case"data":i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){var n={orientation:a.orientation||"vertical",position:a.position||"middle"};return y.gradient()(t,t.seriesIndex,n)}:i;return y.color(i),y.fill(l),y.classes(o),b.color(i),b.classes(o),t},t.margin=function(e){if(!arguments.length)return r;for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return t},t.width=function(e){return arguments.length?(i=e,t):i},t.height=function(e){return arguments.length?(l=e,t):l},t.showTitle=function(e){return arguments.length?(s=e,t):s},t.showControls=function(e){return arguments.length?(c=e,t):c},t.showLegend=function(e){return arguments.length?(u=e,t):u},t.tooltips=function(e){return arguments.length?(p=e,t):p},t.tooltipContent=function(e){return arguments.length?(I=e,t):I},t.state=function(e){return arguments.length?(g=e,t):g},t.strings=function(e){if(!arguments.length)return m;for(var n in e)e.hasOwnProperty(n)&&(m[n]=e[n]);return t},t.direction=function(e){return arguments.length?(d=e,y.direction(e),b.direction(e),x.direction(e),t):d},t.duration=function(e){return arguments.length?(h=e,y.duration(e),t):h},t.delay=function(e){return arguments.length?(f=e,y.delay(e),t):f},t.seriesClick=function(e){return arguments.length?(C=e,t):C},t.colorFill=function(e){return t},t}function p(){function t(n){return n.each(function(n){function i(e){var n=e&&e.length,a=(A-r.left-r.right)/2+r.left,i=(C-r.top-r.bottom)/2+r.top;return w.displayNoData(n,d,t.strings().noData,a,i)}var o=this,d=e.select(this),g="gauge",b=n?n.properties:{},I=n?n.data:null,A=parseInt(d.style("width"),10),C=parseInt(d.style("height"),10);"datetime"===n.properties.xDataType||!1,"currency"===n.properties.yDataType||!1;if(t.update=function(){d.transition().duration(f).call(t)},t.container=this,i(I))return t;I.forEach(function(t,n){var r=v.y();t.seriesIndex=n,t.value=r(t),t.value||t.values?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[],t.values.forEach(function(e,n){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=r(e))}),t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var S=I.filter(function(t,e){return!t.disabled});if(S.length||(S=[{values:[]}]),b.count=e.sum(S,function(t){return t.count}),b.total=e.sum(S,function(t){return t.value}),s=s&&b.title.length,p.disabled=I.map(function(t){return!!t.disabled}),!b.total)return i(),t;var D=d.selectAll("g.sc-chart-wrap").data([S]),T=D.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+g),F=d.select(".sc-chart-wrap").merge(T);T.append("rect").attr("class","sc-background").attr("x",-r.left).attr("y",-r.top).attr("fill","#FFF"),T.append("g").attr("class","sc-title-wrap");var L=F.select(".sc-title-wrap");T.append("g").attr("class","sc-"+g+"-wrap");var z=F.select(".sc-"+g+"-wrap");T.append("g").attr("class","sc-legend-wrap");var P=F.select(".sc-legend-wrap");t.render=function(){var e,n,i,o,h,p,g;A=parseInt(d.style("width"),10),C=parseInt(d.style("height"),10),e=a||A||960,n=l||C||400,i=e-r.left-r.right,o=n-r.top-r.bottom,h={top:0,right:0,bottom:0,left:0},p=i-h.left-h.right,g=o-h.top-h.bottom,F.attr("transform","translate("+r.left+","+r.top+")"),F.select(".sc-background").attr("width",e).attr("height",n);var m=0,x={width:0,
height:0},k=0;if(L.select(".sc-title").remove(),s&&(L.append("text").attr("class","sc-title").attr("x","rtl"===u?i:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(b.title),x=w.getTextBBox(L.select(".sc-title")),m+=x.height),c){y.id("legend_"+t.id()).strings(t.strings().legend).align("center").height(o-h.top),P.datum(I).call(y),y.arrange(i);var M=w.getTextBBox(P.select(".sc-menu-link")),D=i-x.width-6,T=!!(s&&y.collapsed()&&D>M.width),B="rtl"!==u&&y.collapsed()?i-y.width():0,E=x.height;T?E=x.height-y.height()/2-M.height/2:s||(E=-y.margin().top),P.attr("transform","translate("+B+","+E+")"),k=T?12:y.height()-(s?0:y.margin().top)}m+=k,h.top+=m,g=o-h.top-h.bottom,p=i-h.left-h.right,v.width(p).height(g),z.datum(S).attr("transform","translate("+h.left+","+h.top+")").transition().duration(f).call(v),v.setPointer(b.total)},t.render(),m.on("tooltipShow",function(t){h&&(x=M(t,o.parentNode,b))}),m.on("tooltipMove",function(t){x&&k.position(o.parentNode,x,t)}),m.on("tooltipHide",function(){h&&k.cleanup()}),m.on("changeState",function(e){"undefined"!=typeof e.disabled&&(S.forEach(function(t,n){t.disabled=e.disabled[n]}),p.disabled=e.disabled),d.transition().duration(f).call(t)}),m.on("chartClick",function(){y.enabled()&&y.dispatch.call("closeMenu",this)})}),t}var r={top:10,right:10,bottom:10,left:10},a=null,l=null,s=!1,c=!0,u="ltr",d=0,f=0,h=!0,p={},g={legend:{close:"Hide legend",open:"Show legend"},noData:"No Data Available.",noLabel:"undefined"},m=e.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),v=i(),y=o().align("center"),x=null,b=function(t,e){var n=v.fmtKey()(t.point.series),r=v.getCount()(t.point.series),a=v.getValue()(t.point.y1-t.point.y0);return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},M=function(t,e,n){var r=b(t,n);return k.show(t.e,r,null,null,e)};return v.dispatch.on("elementMouseover.tooltip",function(t){m.call("tooltipShow",this,t)}),v.dispatch.on("elementMousemove.tooltip",function(t){m.call("tooltipMove",this,t)}),v.dispatch.on("elementMouseout.tooltip",function(){m.call("tooltipHide",this)}),t.dispatch=m,t.gauge=v,t.legend=y,n.rebind(t,v,"id","x","y","color","fill","classes","gradient","locality"),n.rebind(t,v,"getKey","getValue","getCount","fmtKey","fmtValue","fmtCount"),n.rebind(t,v,"values","showLabels","showPointer","setPointer","ringWidth","labelThreshold","maxValue","minValue"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n};break;case"data":i=function(t,e){return t.classes?"inherit":t.color||w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){return v.gradient()(t,t.seriesIndex)}:i;return v.color(i),v.fill(l),v.classes(o),y.color(i),y.classes(o),t},t.margin=function(e){if(!arguments.length)return r;for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(l=e,t):l},t.showTitle=function(e){return arguments.length?(s=e,t):s},t.showLegend=function(e){return arguments.length?(c=e,t):c},t.tooltips=function(e){return arguments.length?(h=e,t):h},t.tooltipContent=function(e){return arguments.length?(b=e,t):b},t.state=function(e){return arguments.length?(p=e,t):p},t.strings=function(e){if(!arguments.length)return g;for(var n in e)e.hasOwnProperty(n)&&(g[n]=e[n]);return t},t.direction=function(e){return arguments.length?(u=e,v.direction(e),y.direction(e),t):u},t.duration=function(e){return arguments.length?(f=e,v.duration(e),t):f},t.delay=function(e){return arguments.length?(d=e,v.delay(e),t):d},t}function g(){function t(n){return n.each(function(n){function r(e){var n=e&&e.length&&e.filter(function(t){return t.values&&t.values.length}).length,r=(P-l.left-l.right)/2+l.left,a=(B-l.top-l.bottom)/2+l.top;return w.displayNoData(n,s,t.strings().noData,r,a)}var o=this,s=e.select(this),g="line",b=n?n.properties:{},L=n?n.data:null,P=parseInt(s.style("width"),10),B=parseInt(s.style("height"),10),E=c,_=u,H=b.groups,N=!!H&&(Array.isArray(H)&&0!==H.length),R=N?H.map(function(e){return e.label||e.l||("string"==typeof e?e:t.strings().noLabel)}):[],O="ordinal"===b.xDataType||N||!1,V="datetime"===b.xDataType||!1,W="numeric"===b.xDataType||!1,q="currency"===b.yDataType||!1,Y=[],G=0,Z=[],j=null,X=null,K=null,U=0,J=!1;if(t.update=function(){s.transition().duration(m).call(t)},t.container=this,r(L))return t;if(d=d&&b.title,L.forEach(function(t,n){t.seriesIndex=n,t.total=e.sum(t.values,function(t,e){return I.y()(t,e)}),t.total||(t.disabled=!0)}),Y=L.filter(function(t){return!t.disabled}),Y.length||(Y=[{seriesIndex:0,key:"Empty",total:0,disabled:!0,values:[]}]),U=e.sum(Y,function(t){return t.total}),!U)return r(),t;O?(G=R.length,X=function(t,e,n){return R[e]}):(Z=e.merge(Y.map(function(t){return t.values})).reduce(function(t,e){return t.indexOf(e.x)===-1&&t.push(e.x),t},[]),G=Math.min(Math.ceil(innerWidth/100),Z.length),V?(Z=Z.map(function(t){return new Date(t)}),j=w.getDateFormat(Z),X=function(e,n,r){return w.dateFormat(e,j,t.locality())}):W&&(X=function(t,e,n){return t})),K=function(e,n,r){return w.numberFormatSI(e,2,q,t.locality())},y.disabled=Y.map(function(t){return!!t.disabled}),y.interpolate=I.interpolate(),y.isArea=I.isArea()(),J=1===e.max(Y,function(t){return t.values.length});var Q=Math.pow(x,2)*Math.PI*(J?3:1);if(I.id(t.id()).xScale(V?e.scaleTime():e.scaleLinear()).singlePoint(J).size(Q).sizeRange([Q,Q]).sizeDomain([Q,Q]),J){var $=e.merge(Y.map(function(t){return t.values.map(function(t,e){return I.x()(t,e)})})).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[]).sort(function(t,e){return t-e}),tt=e.extent($),et=1*(V&&!R.length?864e5:1),nt=e.merge(Y.map(function(t){return t.values.map(function(t,e){return I.y()(t,e)})})),rt=e.extent(nt),at=1===Y.length?2:Math.min((rt[1]-rt[0])/Y.length,rt[0]);I.xDomain([tt[0]-et,tt[1]+et]).yDomain([rt[0]-at,rt[1]+at]),A.orient("bottom").showMaxMin(!1).ticks($.length).tickValues($).highlightZero(!1).showMaxMin(!1),C.orient("left").ticks(J?5:null).highlightZero(!1).showMaxMin(!1)}else I.xDomain(null).yDomain(null),A.orient("bottom").tickValues(O?e.range(1,R.length+1):null).ticks(O?R.length:null).showMaxMin(V).highlightZero(!1),C.orient("left").ticks(null).highlightZero(!0).showMaxMin(!0);a=I.xScale(),i=I.yScale(),A.scale(a).tickPadding(6).tickFormat(X),C.scale(i).tickPadding(6).tickFormat(K);var it=s.selectAll("g.sc-chart-wrap").data([Y]),ot=it.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+g),lt=s.select(".sc-chart-wrap").merge(ot);ot.append("rect").attr("class","sc-background").attr("x",-l.left).attr("y",-l.top).attr("fill","#FFF"),ot.append("g").attr("class","sc-title-wrap");var st=lt.select(".sc-title-wrap");ot.append("g").attr("class","sc-axis-wrap sc-axis-x");var ct=lt.select(".sc-axis-wrap.sc-axis-x");ot.append("g").attr("class","sc-axis-wrap sc-axis-y");var ut=lt.select(".sc-axis-wrap.sc-axis-y");ot.append("g").attr("class","sc-"+g+"-wrap");var dt=lt.select(".sc-"+g+"-wrap");ot.append("g").attr("class","sc-controls-wrap");var ft=lt.select(".sc-controls-wrap");ot.append("g").attr("class","sc-legend-wrap");var ht=lt.select(".sc-legend-wrap");t.render=function(){function e(){i.left=Math.max(Z.left,q.left),i.right=Math.max(Z.right,q.right),i.top=Math.max(Z.top,q.top),i.bottom=Math.max(Z.bottom,q.bottom)}function n(){o=E-i.left-i.right,g=_-k-i.top-i.bottom,I.width(o).height(g),I.scatter.resetDimensions(o,g)}var r,a,i,o,g;P=parseInt(s.style("width"),10),B=parseInt(s.style("height"),10),r=c||P||960,a=u||B||400,E=r-l.left-l.right,_=a-l.top-l.bottom,i={top:0,right:0,bottom:0,left:0},o=E-i.left-i.right,g=_-i.top-i.bottom,lt.attr("transform","translate("+l.left+","+l.top+")"),lt.select(".sc-background").attr("width",r).attr("height",a);var m=0,v=0,y=0,k=0,M={width:0,height:0},F=0,z=0,H="";st.select(".sc-title").remove(),d&&(st.append("text").attr("class","sc-title").attr("x","rtl"===p?E:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(b.title),M=w.getTextBBox(st.select(".sc-title")),k+=M.height),f&&(S.id("controls_"+t.id()).strings(t.strings().controls).align("left").height(_-k),ft.datum(T).call(S),m=S.calcMaxWidth()),h&&(D.id("legend_"+t.id()).strings(t.strings().legend).align("right").height(_-k),ht.datum(L).call(D),v=D.calcMaxWidth()),y=E/(m+v),m=Math.floor(m*y),v=Math.floor(v*y),f&&(S.arrange(m),v=E-S.width()),h&&(D.arrange(v),m=E-D.width());var N,R;if(f&&(N="rtl"===p?E-S.width():0,R=d?M.height:-S.margin().top,ft.attr("transform","translate("+N+","+R+")"),F=S.height()),h){var O=w.getTextBBox(ht.select(".sc-menu-link")),V=E-M.width-6,W=!!(d&&!f&&D.collapsed()&&V>O.width);N="rtl"===p?0:E-D.width(),R=M.height,W?R=M.height-D.height()/2-O.height/2:d||(R=-D.margin().top),ht.attr("transform","translate("+N+","+R+")"),z=W?12:D.height()}k+=Math.max(F,z),g=_-k-i.top-i.bottom,I.width(o).height(g),dt.datum(Y).call(I);var q={top:0,right:0,bottom:0,left:0},Z={top:0,right:0,bottom:0,left:0};C.margin(i),ut.call(C),q=C.margin(),e(),n(),A.ticks(G).tickSize(-g+(I.padData()?x:0),0).margin(i),ct.call(A),Z=A.margin(),e(),n(),C.tickSize(-o+(I.padData()?x:0),0).margin(i),ut.call(C),A.tickSize(-g+(I.padData()?x:0),0).margin(i),ct.call(A),I.width(o).height(g),dt.datum(Y).call(I),i.top+=k,H=i.left+",",H+=i.top+("bottom"===A.orient()?g:0),ct.attr("transform","translate("+H+")"),H=i.left+("left"===C.orient()?0:o)+",",H+=i.top,ut.attr("transform","translate("+H+")"),H=i.left+","+i.top,dt.attr("transform","translate("+H+")")},t.render(),D.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,L.filter(function(t){return!t.disabled}).length||L.map(function(t){return t.disabled=!1,s.selectAll(".sc-series").classed("disabled",!1),t}),y.disabled=L.map(function(t){return!!t.disabled}),M.call("stateChange",this,y),s.transition().duration(m).call(t)}),S.dispatch.on("legendClick",function(e,n){if(e.disabled){switch(T=T.map(function(t){return t.disabled=!0,t}),e.disabled=!1,e.key){case"Basis":I.interpolate("basis");break;case"Linear":I.interpolate("linear");break;case"Monotone":I.interpolate("monotone");break;case"Cardinal":I.interpolate("cardinal");break;case"Line":I.isArea(!1);break;case"Area":I.isArea(!0)}y.interpolate=I.interpolate(),y.isArea=I.isArea(),M.call("stateChange",this,y),s.transition().duration(m).call(t)}}),M.on("tooltipShow",function(t){v&&(F=z(t,o.parentNode,b))}),M.on("tooltipMove",function(t){F&&k.position(o.parentNode,F,t,"s")}),M.on("tooltipHide",function(){v&&k.cleanup()}),M.on("changeState",function(e){"undefined"!=typeof e.disabled&&(L.forEach(function(t,n){t.disabled=e.disabled[n]}),y.disabled=e.disabled),"undefined"!=typeof e.interpolate&&(I.interpolate(e.interpolate),y.interpolate=e.interpolate),"undefined"!=typeof e.isArea&&(I.isArea(e.isArea),y.isArea=e.isArea),s.transition().duration(m).call(t)}),M.on("chartClick",function(){S.enabled()&&S.dispatch.call("closeMenu",this),D.enabled()&&D.dispatch.call("closeMenu",this)})}),t}var a,i,l={top:10,right:10,bottom:10,left:10},c=null,u=null,d=!1,f=!1,h=!0,p="ltr",g=0,m=0,v=!0,y={},x=3,b={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},M=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),I=s().clipEdge(!0),A=r(),C=r(),S=o().color(["#444"]),D=o(),T=[{key:"Linear",disabled:"linear"!==I.interpolate()},{key:"Basis",disabled:"basis"!==I.interpolate()},{key:"Monotone",disabled:"monotone"!==I.interpolate()},{key:"Cardinal",disabled:"cardinal"!==I.interpolate()},{key:"Line",disabled:I.isArea()()===!0},{key:"Area",disabled:I.isArea()()===!1}],F=null,L=function(t,e){var n=t.series.key,r=t.point.x,a=t.point.y;return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},z=function(t,e,n){var r=L(t,n),a=t.value<0?"n":"s";return k.show(t.e,r,a,null,e)};return I.dispatch.on("elementMouseover.tooltip",function(t){M.call("tooltipShow",this,t)}),I.dispatch.on("elementMousemove.tooltip",function(t){M.call("tooltipMove",this,t)}),I.dispatch.on("elementMouseout.tooltip",function(t){M.call("tooltipHide",this,t)}),t.dispatch=M,t.lines=I,t.legend=D,t.controls=S,t.xAxis=A,t.yAxis=C,n.rebind(t,I,"id","x","y","xScale","yScale","xDomain","yDomain","forceX","forceY","clipEdge","color","fill","classes","gradient","locality"),n.rebind(t,I,"defined","isArea","interpolate","size","clipVoronoi","useVoronoi","interactive","nice"),n.rebind(t,A,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){return I.gradient()(t,t.seriesIndex)}:i;return I.color(i),I.fill(l),I.classes(o),D.color(i),D.classes(o),t},t.margin=function(e){if(!arguments.length)return l;for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n]);return t},t.width=function(e){return arguments.length?(c=e,t):c},t.height=function(e){return arguments.length?(u=e,t):u},t.showTitle=function(e){return arguments.length?(d=e,t):d},t.showControls=function(e){return arguments.length?(f=e,t):f},t.showLegend=function(e){return arguments.length?(h=e,t):h},t.tooltips=function(e){return arguments.length?(v=e,t):v},t.tooltipContent=function(e){return arguments.length?(L=e,t):L},t.state=function(e){return arguments.length?(y=e,t):y},t.strings=function(e){if(!arguments.length)return b;for(var n in e)e.hasOwnProperty(n)&&(b[n]=e[n]);return t},t.direction=function(e){return arguments.length?(p=e,I.direction(e),A.direction(e),C.direction(e),D.direction(e),S.direction(e),t):p},t.duration=function(e){return arguments.length?(m=e,I.duration(e),t):m},t.delay=function(e){return arguments.length?(g=e,I.delay(e),t):g},t.pointRadius=function(e){return arguments.length?(x=e,t):x},t}function m(){function t(n){return n.each(function(n){function r(e){var n=e&&e.length&&e.filter(function(t){return t.values&&t.values.length}).length,r=(T-l.left-l.right)/2+l.left,a=(R-l.top-l.bottom)/2+l.top;return w.displayNoData(n,c,t.strings().noData,r,a)}var o=this,c=e.select(this),m=I?"multibar":"multibar-horizontal",b=n?n.properties:{},D=n?n.data:null,T=parseInt(c.style("width"),10),R=parseInt(c.style("height"),10),W=s,q=u,Y=b.groups&&Array.isArray(b.groups)&&b.groups.length,G=Y?b.groups.map(function(e){return e.label||e.l||("string"==typeof e?e:t.strings().noLabel)}):[],Z=G&&Array.isArray(G)&&G.length,j="ordinal"===b.xDataType||Y||!1,X="datetime"===b.xDataType||!1,K="numeric"===b.xDataType||!1,U="currency"===b.yDataType||!1,J=[],Q=0,$=[],tt=0,et=0,nt=null,rt=null,at=null,it=0,ot=!1,lt=z.stacked()&&I?72:32;if(t.update=function(){c.transition().duration(v).call(t)},t.container=this,r(D))return t;if(t.clearActive=function(){D.forEach(function(t){t.active="",t.values.map(function(t){t.active=""})}),delete x.active},t.cellActivate=function(e){D[e.seriesIndex].values[e.groupIndex].active="active",t.render()},t.seriesActivate=function(e){t.dataSeriesActivate({series:D[e.seriesIndex]})},t.dataSeriesActivate=function(e){var n=e.series;n.active="undefined"==typeof n.active||"inactive"===n.active||""===n.active?"active":"inactive",n.values.map(function(t){t.active=n.active}),"active"===n.active&&D.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t.values.map(function(t){t.active="inactive"}),t}),D.filter(function(t){return"active"===t.active}).length?x.active=D.map(function(t){return"undefined"==typeof t.active||"active"===t.active}):t.clearActive(),t.render()},f=f&&b.title,D.forEach(function(t,n){t._values||(t._values=t.values.map(function(t,e){return{x:t.x,y:t.y}})),t.seriesIndex=n,t.values=t._values.map(function(e,r){return{seriesIndex:t.seriesIndex,group:r,color:"undefined"!=typeof t.color?t.color:"",x:z.x()(e,r),y:z.y()(e,r),y0:e.y+(n>0?D[t.seriesIndex-1].values[r].y0:0),active:"undefined"!=typeof t.active?t.active:""}}),t.total=e.sum(t.values,function(t,e){return t.y}),t.disabled=t.disabled||0===t.total,t.values.forEach(function(e,n){e.active="undefined"!=typeof t.active?t.active:""})}),J=D.filter(function(t,e){return!(t.disabled||t.type&&"bar"!==t.type)}).map(function(t,e){return t.seri=e,t.values.forEach(function(e,n){e.seri=t.seri}),t}),Q=J.length,ot=Q>0,$=Z?b.groups.map(function(t,e){return t.total=0,t._height=0,t}):J[0].values.map(function(t,e){return{group:e,label:t.x,total:0,_height:0}}),$.forEach(function(t,e){J.forEach(function(n,r){n.values.filter(function(t,n){return t.group===e}).forEach(function(e,n){t.total+=e.y,t._height+=Math.abs(e.y)})})}),G=$.filter(function(t,e){return!S||0!==t._height}).map(function(e){return e.l||e.label||t.strings().noLabel}),tt=G.length,it=e.sum($,function(t){return t.total}),S&&J.forEach(function(t,e){return t.values=t.values.filter(function(t,e){return 0!==$[e]._height}).map(function(e,n){return e.seri=t.seri,e}),t}),Z=G&&Array.isArray(G)&&G.length,j&&Z?(tt=G.length,et=Math.max(I?2*lt:.2*W,75),rt=function(t,e,n,r){return r?G[e]:w.stringEllipsify(G[e],c,et)}):X?(nt=w.getDateFormat(G),rt=function(e,n,r,a){return w.dateFormat(e,nt,t.locality())}):K&&(rt=function(t,e,n,r){return t}),at=function(e,n,r){return w.numberFormatSI(e,2,U,t.locality())},!ot)return r(),t;J.length||(J=[{values:[]}]),x.disabled=D.map(function(t){return!!t.disabled}),x.active=D.map(function(t){return"active"===t.active}),x.stacked=z.stacked(),a=z.xScale(),i=z.yScale(),P.orient(I?"bottom":"left").scale(a).valueFormat(rt).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),B.orient(I?"left":"bottom").scale(i).valueFormat(at).tickPadding(4).showMaxMin(!0);var st=c.selectAll("g.sc-chart-wrap").data([D]),ct=st.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+m),ut=c.select(".sc-chart-wrap").merge(ct);ct.append("defs"),ct.append("g").attr("class","sc-scroll-background"),ct.append("g").attr("class","sc-title-wrap");var dt=ut.select(".sc-title-wrap");ct.append("g").attr("class","sc-axis-wrap sc-axis-y");var ft=ut.select(".sc-axis-wrap.sc-axis-y");ct.append("g").attr("class","sc-scroll-wrap");var ht=ut.select(".sc-scroll-wrap");ct.select(".sc-scroll-wrap").append("g").attr("class","sc-axis-wrap sc-axis-x");var pt=ut.select(".sc-axis-wrap.sc-axis-x");ct.select(".sc-scroll-wrap").append("g").attr("class","sc-bars-wrap");var gt=ut.select(".sc-bars-wrap");ct.append("g").attr("class","sc-controls-wrap");var mt=ut.select(".sc-controls-wrap");ct.append("g").attr("class","sc-legend-wrap");var vt=ut.select(".sc-legend-wrap");if(A){var yt=d().id(t.id()).vertical(I);yt(ut,ct,ht,P)}t.render=function(){function n(t){return"width"===t?I&&A?Math.max(m,S):m:"height"===t?!I&&A?Math.max(v,S):v:0}function r(){d.left=Math.max(at.left,rt.left),d.right=Math.max(at.right,rt.right),d.top=Math.max(at.top,rt.top)+Y,d.bottom=Math.max(at.bottom,rt.bottom),a()}function a(){m=W-d.left-d.right,v=q-d.top-d.bottom,z.resetDimensions(n("width"),n("height"))}var i,o,d,m,v;T=parseInt(c.style("width"),10),R=parseInt(c.style("height"),10),i=s||T||960,o=u||R||400,W=i-l.left-l.right,q=o-l.top-l.bottom,d={top:0,right:0,bottom:0,left:0},m=W-d.left-d.right,v=q-d.top-d.bottom;var y=x.stacked?lt:lt*Q+lt,k=lt*(x.stacked?.25:1),S=tt*y+k;ut.attr("transform","translate("+l.left+","+l.top+")");var H=0,O=0,V=0,Y=0,G={width:0,height:0},Z=0,j=0,X="";dt.select(".sc-title").remove(),f&&(dt.append("text").attr("class","sc-title").attr("x","rtl"===g?W:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(b.title),G=w.getTextBBox(dt.select(".sc-title")),Y+=G.height),h&&(E.id("controls_"+t.id()).strings(t.strings().controls).align("left").height(q-Y),mt.datum(N).call(E),H=E.calcMaxWidth()),p&&(z.barColor()&&D.forEach(function(t,n){t.color=e.rgb("#ccc").darker(1.5*n).toString()}),_.id("legend_"+t.id()).strings(t.strings().legend).align("right").height(q-Y),vt.datum(D).call(_),O=_.calcMaxWidth()),V=W/(H+O),H=Math.floor(H*V),O=Math.floor(O*V),h&&(E.arrange(H),O=W-E.width()),p&&(_.arrange(O),H=W-_.width());var K,U;if(h&&(K="rtl"===g?W-E.width():0,U=f?G.height:-E.margin().top,mt.attr("transform","translate("+K+","+U+")"),Z=E.height()-(f?0:E.margin().top)),p){var $=w.getTextBBox(vt.select(".sc-menu-link")),et=W-G.width-6,nt=!!(f&&!h&&_.collapsed()&&et>$.width);K="rtl"===g?0:W-_.width(),U=G.height,nt?U=G.height-_.height()/2-$.height/2:f||(U=-_.margin().top),vt.attr("transform","translate("+K+","+U+")"),j=nt?12:_.height()-(f?0:_.margin().top)}Y+=Math.max(Z,j),d.top+=Y,v=q-d.top-d.bottom,m=W-d.left-d.right,z.vertical(I).baseDimension(lt).disabled(D.map(function(t){return t.disabled})),z.width(n("width")).height(n("height")),gt.data([J]).call(z);var rt={top:0,right:0,bottom:0,left:0},at={top:0,right:0,bottom:0,left:0};if(B.margin(d).ticks(v/48),ft.call(B),rt=B.margin(),r(),P.margin(d).ticks(tt),X=d.left+",",X+=d.top+("bottom"===P.orient()?v:0),pt.attr("transform","translate("+X+")").call(P),at=P.margin(),r(),P.tickSize(0).margin(d),pt.call(P),at=P.margin(),r(),B.tickSize(I?-m:-v,0).margin(d),ft.call(B),rt=B.margin(),r(),gt.transition().call(z),X=(I||"left"===P.orient()?0:m)+",",X+=I&&"bottom"===P.orient()?v+2:-2,pt.attr("transform","translate("+X+")"),X=d.left+(I||"bottom"===B.orient()?0:m)+",",X+=d.top+(I||"left"===B.orient()?0:v),ft.attr("transform","translate("+X+")"),ht.attr("transform","translate("+d.left+","+d.top+")"),A){F=S>(I?m:v),pt.select(".sc-axislabel").attr("x",(I?m:-v)/2);var it=(I?m:v)-S,ot=function(){M.call("tooltipHide",this),L=yt.pan(it),pt.select(".sc-axislabel").attr("x",(I?m-2*L:2*L-v)/2)};yt.enable(F).width(m).height(v).margin(d).minDimension(S).panHandler(ot).resize(L,C),yt.panHandler()()}},t.render(),_.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,e.active="inactive",e.values.map(function(t){t.active="inactive"}),S&&D.map(function(t,r){return t._values.map(function(t,r){return t.disabled=r===n?e.disabled:!!t.disabled,t}),t}),D.filter(function(t){return!t.disabled}).length||D.map(function(t){return t.disabled=!1,t}),D.filter(function(t){return"active"===t.active}).length||t.clearActive(),t.update(),M.call("stateChange",this,x)}),E.dispatch.on("legendClick",function(e,n){if(e.disabled){switch(N=N.map(function(t){return t.disabled=!0,t}),e.disabled=!1,e.key){case"Grouped":z.stacked(!1);break;case"Stacked":z.stacked(!0)}x.stacked=z.stacked(),t.update(),M.call("stateChange",this,x)}}),M.on("tooltipShow",function(t){y&&(t.group=$[t.groupIndex],H=O(t,o.parentNode,b))}),M.on("tooltipMove",function(t){H&&k.position(o.parentNode,H,t,I?"s":"w")}),M.on("tooltipHide",function(){y&&k.cleanup()}),M.on("changeState",function(e){"undefined"!=typeof e.disabled&&(D.forEach(function(t,n){t.disabled=e.disabled[n]}),x.disabled=e.disabled),"undefined"!=typeof e.active&&(D.forEach(function(t,n){t.active=e.active[n]?"active":"inactive",t.values.map(function(e){e.active=t.active})}),x.active=e.active,D.filter(function(t){return"active"===t.active}).length||t.clearActive()),"undefined"!=typeof e.stacked&&(z.stacked(e.stacked),x.stacked=e.stacked),t.render()}),M.on("chartClick",function(){E.enabled()&&E.dispatch.call("closeMenu",this),_.enabled()&&_.dispatch.call("closeMenu",this)}),z.dispatch.on("elementClick",function(e){M.call("chartClick",this),V(D,e,t,G)})}),t}var a,i,l={top:10,right:10,bottom:10,left:10},s=null,u=null,f=!1,h=!1,p=!0,g="ltr",m=0,v=0,y=!0,x={},b={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},M=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),I=!0,A=!0,C=function(t){},S=!0,D=function(e,n,r,a){return a?w.dateFormat(r,"%x",t.locality()):r},T=function(e,n,r,a){var i=2;return w.numberFormatSI(e,i,a,t.locality())},F=!1,L=0,z=c().stacked(!1).clipEdge(!1),P=r(),B=r(),E=o().color(["#444"]),_=o();if(A){d().id(z.id()).vertical(I)}var H=null,N=[{key:"Grouped",disabled:x.stacked},{key:"Stacked",disabled:!x.stacked}],R=function(t,e){var n=t.group.label,r=Math.abs(100*a/t.group._height).toFixed(1),a=t.point.y;return"<h3>"+n+"</h3><p>"+a+" on "+r+"</p>"},O=function(t,e,n){var r=R(t,n),a=t.value<0?I?"n":"e":I?"s":"w";return k.show(t.e,r,a,null,e)},V=function(t,e,n,r){};return z.dispatch.on("elementMouseover.tooltip",function(t){M.call("tooltipShow",this,t)}),z.dispatch.on("elementMousemove.tooltip",function(t){M.call("tooltipMove",this,t)}),z.dispatch.on("elementMouseout.tooltip",function(t){M.call("tooltipHide",this,t)}),t.dispatch=M,t.multibar=z,t.legend=_,t.controls=E,t.xAxis=P,t.yAxis=B,n.rebind(t,z,"id","x","y","xScale","yScale","xDomain","yDomain","forceY","clipEdge","color","fill","classes","gradient","locality"),n.rebind(t,z,"stacked","showValues","valueFormat","nice","textureFill"),n.rebind(t,P,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n};break;case"data":i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){var n={orientation:a.orientation||(I?"vertical":"horizontal"),position:a.position||"middle"};return z.gradient()(t,t.seriesIndex,n)}:i;return z.color(i),z.fill(l),z.classes(o),_.color(i),_.classes(o),t},t.margin=function(e){if(!arguments.length)return l;for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n]);return t},t.width=function(e){return arguments.length?(s=e,t):s},t.height=function(e){return arguments.length?(u=e,t):u},t.showTitle=function(e){return arguments.length?(f=e,t):f},t.showControls=function(e){return arguments.length?(h=e,t):h},t.showLegend=function(e){return arguments.length?(p=e,t):p},t.tooltips=function(e){return arguments.length?(y=e,t):y},t.tooltipContent=function(e){return arguments.length?(R=e,t):R},t.state=function(e){return arguments.length?(x=e,M.stateChange(x),t):x},t.strings=function(e){if(!arguments.length)return b;for(var n in e)e.hasOwnProperty(n)&&(b[n]=e[n]);return t},t.direction=function(e){return arguments.length?(g=e,z.direction(e),P.direction(e),B.direction(e),_.direction(e),E.direction(e),t):g},t.duration=function(e){return arguments.length?(v=e,z.duration(e),t):v},t.delay=function(e){return arguments.length?(m=e,z.delay(e),t):m},t.seriesClick=function(e){return arguments.length?(V=e,t):V},t.vertical=function(e){return arguments.length?(I=e,t):I},t.allowScroll=function(e){return arguments.length?(A=e,t):A},t.overflowHandler=function(e){return arguments.length?(C=w.functor(e),t):C},t.hideEmptyGroups=function(e){return arguments.length?(S=e,t):S},t.xValueFormat=function(e){return arguments.length?(D=e,t):D},t.yValueFormat=function(e){return arguments.length?(T=e,t):T},t}function v(){function t(n){return n.each(function(n){function r(e){var n=e&&e.length&&e.filter(function(t){return t.values&&t.values.length}).length,r=(y-l.left-l.right)/2+l.left,a=(b-l.top-l.bottom)/2+l.top;return w.displayNoData(n,s,t.strings().noData,r,a)}var o=this,s=e.select(this),c="pareto",m=n?n.properties:{},v=n?n.data:null,y=parseInt(s.style("width"),10),b=parseInt(s.style("height"),10),A=0,N=0,R=Math.pow(6,2)*Math.PI,O="datetime"===n.properties.xDataType||!1,Y="currency"===n.properties.yDataType||!1,G=F.stacked()?72:32,Z=function(t,e,n,r){var a=J&&Array.isArray(J)?J[e]||t:t,i=S(t,e,a,O),o=Math.max(2*G,75);return r?i:w.stringEllipsify(i,s,o)},j=function(t,e,n,r){return D(t,e,null,Y)};if(t.update=function(){s.transition().call(t)},t.container=this,r(v))return t;t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active",n.values.map(function(t){t.active=n.active}),"active"===n.active&&v.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t.values.map(function(t){t.active="inactive"}),t}),v.filter(function(t){return"active"===t.active}).length||v.map(function(t){return t.active="",t.values.map(function(t){t.active=""}),s.selectAll(".sc-series").classed("sc-inactive",!1),t}),s.call(t)},v.forEach(function(t,e){t._values||(t._values=t.values.map(function(t,e){return{x:Array.isArray(t)?t[0]:t.x,y:Array.isArray(t)?t[1]:t.y}}))});var X=v.filter(function(t){return!t.type||"bar"===t.type}).map(function(t,e){return t.seriesIndex=e,t.values=t._values.map(function(n,r){return{group:r,seriesIndex:t.seriesIndex,color:"undefined"!=typeof t.color?t.color:"",x:F.x()(n,r),y:F.y()(n,r),y0:n.y+(e>0?v[t.seriesIndex-1].values[r].y0:0),active:"undefined"!=typeof t.active?t.active:""}}),t}).filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t.values.forEach(function(e,n){e.seri=t.seri}),t});X=X.length?X:[{values:[]}];var K=v.filter(function(t){return"line"===t.type}).map(function(t,e){return t.seriesIndex=e,F.stacked()?(t.values.forEach(function(t){t.y=0}),X.map(function(e){e.values.map(function(e,n){t.values[n].y+=F.y()(e,n)})}),t.values.forEach(function(e,n){n>0&&(e.y+=t.values[n-1].y)})):t.values=t._values.map(function(e,n){return{seriesIndex:t.seriesIndex,color:"undefined"!=typeof t.color?t.color:"",x:z.x()(e,n)+.25*(t.seriesIndex-n),y:z.y()(e,n)}}),t}).filter(function(t){return!t.disabled}).map(function(t,e){return t.seri=e,t.values.forEach(function(e,n){e.seri=t.seri}),t});K=K.length?K:[{values:[]}];var U=m.groupData,J=U.map(function(e){return[].concat(e.l)[0]||t.strings().noLabel}),Q=m.quota||0,$=m.quotaLabel||"",tt=m.targetQuota||0,et=m.targetQuotaLabel||"",nt=v.filter(function(t){return!t.type||"bar"===t.type}),rt=v.filter(function(t){return"line"===t.type});rt.push({key:$,type:"dash",color:"#444",seriesIndex:rt.length,values:{seriesIndex:rt.length,x:0,y:0}}),tt>0&&rt.push({key:et,type:"dash",color:"#777",seriesIndex:rt.length,values:{seriesIndex:rt.length+1,x:0,y:0}});var at=(v.filter(function(t){return!t.disabled}).map(function(t){return t._values.map(function(t,e){return M(t,e)})}),v.map(function(t){return t._values.map(function(t,e){return I(t,e)})}));f=f&&m.title,a=F.xScale(),i=F.yScale(),P.orient("bottom").scale(a).valueFormat(Z).tickSize(0).tickPadding(4).highlightZero(!1).showMaxMin(!1),B.orient("left").scale(i).valueFormat(j).tickPadding(7).showMaxMin(!0),t.render=function(){function n(){S.left=Math.max(vt,gt.left,mt.left),S.right=Math.max(gt.right,mt.right),S.top=Math.max(gt.top,mt.top)+q,S.bottom=Math.max(gt.bottom,mt.bottom),r()}function r(){D=M-S.left-S.right,O=I-S.top-S.bottom,F.resetDimensions(D,O)}y=parseInt(s.style("width"),10),b=parseInt(s.style("height"),10);var x,k,M,I,S,D,O;x=u||y||960,k=d||b||400,M=x-l.left-l.right,I=k-l.top-l.bottom,S={top:0,right:0,bottom:0,left:0},O=I-S.top-S.bottom,D=M-S.left-S.right;var V=0,q=0,Y={
width:0,height:0},G=s.selectAll("g.sc-chart-wrap").data([v]),Z=G.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+c),j=s.select(".sc-chart-wrap").merge(Z);Z.append("rect").attr("class","sc-background").attr("x",-l.left).attr("y",-l.top).attr("width",x).attr("height",k).attr("fill","#FFF"),Z.append("g").attr("class","sc-title-wrap");var U=j.select(".sc-title-wrap");Z.append("g").attr("class","sc-axis-wrap sc-axis-x");var J=j.select(".sc-axis-wrap.sc-axis-x");Z.append("g").attr("class","sc-axis-wrap sc-axis-y");var it=j.select(".sc-axis-wrap.sc-axis-y");Z.append("g").attr("class","sc-bars-wrap");var ot=j.select(".sc-bars-wrap");Z.append("g").attr("class","sc-quota-wrap");var lt=j.select(".sc-quota-wrap");Z.append("g").attr("class","sc-lines-wrap1");var st=j.select(".sc-lines-wrap1");Z.append("g").attr("class","sc-lines-wrap2");var ct=j.select(".sc-lines-wrap2");Z.append("g").attr("class","sc-legend-wrap sc-bar-legend");var ut=j.select(".sc-legend-wrap.sc-bar-legend");Z.append("g").attr("class","sc-legend-wrap sc-line-legend");var dt=j.select(".sc-legend-wrap.sc-line-legend");j.attr("transform","translate("+l.left+","+l.top+")"),U.select(".sc-title").remove(),f&&(U.append("text").attr("class","sc-title").attr("x","rtl"===p?M:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(m.title),Y=w.getTextBBox(U.select(".sc-title")),q+=Y.height),h&&(E.id("barlegend_"+t.id()).strings(t.strings().barlegend).align("left").height(I-S.top),ut.datum(nt).call(E),A=E.calcMaxWidth(),_.id("linelegend_"+t.id()).strings(t.strings().linelegend).align("right").height(I-S.top),dt.datum(rt).call(_),N=_.calcMaxWidth(),V=M/(A+N),E.arrange(Math.floor(V*A)),_.arrange(Math.floor(V*N)),ut.attr("transform","translate("+("rtl"===p?M-E.width():0)+","+S.top+")"),dt.attr("transform","translate("+("rtl"===p?0:M-_.width())+","+S.top+")")),q+=Math.max(E.height(),_.height())+4,O=I-q-S.top-S.bottom;var ft=Math.max(e.max(e.merge(at)),Q,tt||0),ht=[0,10*Math.ceil(.1*ft)];F.width(D).height(O).forceY(ht).id(t.id()),ot.datum(X).call(F);var pt=a(1)+a.bandwidth()/(F.stacked()||1===K.length?2:4);L.margin({top:0,right:pt,bottom:0,left:pt}).width(D).height(O).forceY(ht).useVoronoi(!1).id("outline_"+t.id()),z.margin({top:0,right:pt,bottom:0,left:pt}).width(D).height(O).forceY(ht).useVoronoi(!1).size(R).sizeRange([R,R]).sizeDomain([R,R]).id("foreground_"+t.id()),st.datum(K).call(L),ct.datum(K).call(z),J.call(P),it.style("opacity",X.length?1:0).call(B);var gt=P.margin(),mt=B.margin(),vt=0,yt=14;lt.selectAll("line").remove(),it.selectAll("text.sc-quota-value").remove(),it.selectAll("text.sc-target-quota-value").remove(),tt>0&&(lt.append("line").attr("class","sc-quota-target").attr("x1",0).attr("y1",0).attr("x2",D).attr("y2",0).attr("transform","translate(0,"+i(tt)+")").style("stroke-dasharray","8, 8"),lt.append("line").datum({key:et,val:tt}).attr("class","sc-quota-target sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",D).attr("y2",0).attr("transform","translate(0,"+i(tt)+")"),it.append("text").text(T(tt,2,!0)).attr("class","sc-target-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===p?"start":"end").attr("transform","translate("+(0-B.tickPadding())+","+i(tt)+")"),vt=Math.round(j.select("text.sc-target-quota-value").node().getBoundingClientRect().width+B.tickPadding())),Q>0&&(lt.append("line").attr("class","sc-quota-line").attr("x1",0).attr("y1",0).attr("x2",D).attr("y2",0).attr("transform","translate(0,"+i(Q)+")").style("stroke-dasharray","8, 8"),lt.append("line").datum({key:$,val:Q}).attr("class","sc-quota-line sc-quota-background").attr("x1",0).attr("y1",0).attr("x2",D).attr("y2",0).attr("transform","translate(0,"+i(Q)+")"),it.append("text").text(T(Q,2,!0)).attr("class","sc-quota-value").attr("dy",".36em").attr("dx","0").attr("text-anchor","rtl"===p?"start":"end").attr("transform","translate("+-B.tickPadding()+","+i(Q)+")"),vt=Math.max(vt,Math.round(j.select("text.sc-quota-value").node().getBoundingClientRect().width+B.tickPadding()))),n(),F.width(D).height(O),ot.call(F),J.call(P),it.call(B),pt=a(1)+a.bandwidth()/(F.stacked()?2:2*K.length),gt=P.margin(),mt=B.margin(),n();var xt="translate("+S.left+","+S.top+")";F.width(D).height(O),ot.attr("transform",xt).call(F),L.margin({top:0,right:pt,bottom:0,left:pt}).width(D).height(O),z.margin({top:0,right:pt,bottom:0,left:pt}).width(D).height(O),st.attr("transform",xt).call(L),ct.attr("transform",xt).call(z),lt.attr("transform",xt).selectAll("line").attr("x2",D),J.attr("transform","translate("+S.left+","+("bottom"===P.orient()?O+S.top:S.top)+")").call(P),B.ticks(Math.ceil(O/48)).tickSize(-D,0),it.attr("transform","translate("+("left"===B.orient()?S.left:S.left+D)+","+S.top+")").call(B),tt>0&&(lt.selectAll("line.sc-quota-target").attr("x2",D).attr("transform","translate(0,"+i(tt)+")"),it.select("text.sc-target-quota-value").attr("transform","translate("+(0-B.tickPadding())+","+i(tt)+")"),yt=Math.round(parseInt(j.select("text.sc-target-quota-value").node().getBoundingClientRect().height,10)/1.15),it.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,n){Math.abs(i(t)-i(tt))<=yt&&e.select(this).style("opacity",0)})),Q>0&&(lt.selectAll("line.sc-quota-line").attr("x2",D).attr("transform","translate(0,"+i(Q)+")"),it.select("text.sc-quota-value").attr("transform","translate("+(0-B.tickPadding())+","+i(Q)+")"),yt=Math.round(parseInt(j.select("text.sc-quota-value").node().getBoundingClientRect().height,10)/1.15),it.selectAll("g.tick, g.sc-axisMaxMin").each(function(t,n){Math.abs(i(t)-i(Q))<=yt&&e.select(this).style("opacity",0)}),tt>0&&Math.abs(i(Q)-i(tt))<=yt&&it.select(".sc-target-quota-value").style("opacity",0)),lt.selectAll("line.sc-quota-background").on("mouseover",function(t){if(g){var n={val:t.val,key:t.key,e:e.event};H=W(n,o.parentNode)}}).on("mousemove",function(){var t=e.event;C.call("tooltipMove",this,t)}).on("mouseout",function(){C.call("tooltipHide",this)})},t.render(),E.dispatch.on("legendClick",function(e,n){var r=e.seriesIndex;e.disabled=!e.disabled,t.stacked()||v.filter(function(t){return t.seriesIndex===r&&"line"===t.type}).map(function(t){return t.disabled=!t.disabled,t}),v.filter(function(t){return!t.disabled&&"bar"===t.type}).length||v.map(function(t){return t.disabled=!1,t}),s.call(t)}),C.on("tooltipShow",function(t){g&&(H=V(t,o.parentNode,U))}),C.on("tooltipMove",function(t){H&&k.position(o.parentNode,H,t,"s")}),C.on("tooltipHide",function(){g&&k.cleanup()}),C.on("changeState",function(e){"undefined"!=typeof e.disabled&&(v.forEach(function(t,n){t.disabled=e.disabled[n]}),x.disabled=e.disabled),"undefined"!=typeof e.stacked&&(F.stacked(e.stacked),x.stacked=e.stacked),s.transition().call(t)}),C.on("chartClick",function(){E.enabled()&&E.dispatch.call("closeMenu",this),_.enabled()&&_.dispatch.call("closeMenu",this)}),F.dispatch.on("elementClick",function(e){C.call("chartClick",this),q(v,e,t,s)})}),t}var a,i,l={top:10,right:10,bottom:10,left:10},u=null,d=null,f=!1,h=!0,p="ltr",g=!0,m=!1,v=0,y=300,x={},b={barlegend:{close:"Hide bar legend",open:"Show bar legend"},linelegend:{close:"Hide line legend",open:"Show line legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},M=function(t){return t.x},I=function(t){return t.y},A=w.buildLocality(),C=e.dispatch("chartClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),S=function(e,n,r,a){return a?w.dateFormat(r,"%x",t.locality()):r},D=function(e,n,r,a){var i=2;return w.numberFormatSI(e,i,a,t.locality())},T=D,F=c().stacked(!0).clipEdge(!1).withLine(!0).nice(!1),L=s().color(function(t,e){return"#FFF"}).fill(function(t,e){return"#FFF"}).useVoronoi(!1).nice(!1),z=s().useVoronoi(!1).color("data").nice(!1),P=r(),B=r(),E=o().align("left").position("middle"),_=o().align("right").position("middle"),H=null,N=function(t,e,n,r,a){return"<p><b>"+t+"</b></p><p><b>"+n+"</b></p><p><b>"+e+"%</b></p>"},R=function(t,e,n,r,a){return"<p><p>"+t+": <b>"+n+"</b></p>"},O=function(t,e,n,r,a){return"<p>"+r.key+": <b>"+n+"</b></p>"},V=function(e,n,r){var a=e.series.key,i=(100*e.point.y/r[e.pointIndex].t).toFixed(1),o=z.y()(e.point,e.pointIndex),l="bar"===e.series.type?N(a,i,o,e,t):R(a,i,o,e,t);return k.show(e.e,l,"s",null,n)},W=function(e,n){var r=O(e.key,0,e.val,e,t);return k.show(e.e,r,"s",null,n)},q=function(t,e,n,r){};return z.dispatch.on("elementMouseover.tooltip",function(t){C.call("tooltipShow",this,t)}),z.dispatch.on("elementMousemove.tooltip",function(t){C.call("tooltipMove",this,t)}),z.dispatch.on("elementMouseout.tooltip",function(){C.call("tooltipHide",this)}),F.dispatch.on("elementMouseover.tooltip",function(t){C.call("tooltipShow",this,t)}),F.dispatch.on("elementMousemove.tooltip",function(t){C.call("tooltipMove",this,t)}),F.dispatch.on("elementMouseout.tooltip",function(){C.call("tooltipHide",this)}),t.dispatch=C,t.linesBackground=L,t.lines=z,t.multibar=F,t.barLegend=E,t.lineLegend=_,t.xAxis=P,t.yAxis=B,n.rebind(t,F,"id","xScale","yScale","xDomain","yDomain","forceY","color","fill","classes","gradient"),n.rebind(t,F,"stacked","showValues","valueFormat","nice","textureFill"),n.rebind(t,P,"rotateTicks","reduceXTicks","staggerTicks","wrapTicks"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex},l=function(t,n){var r=a.lineColor?a.lineColor:{c1:"#1A8221",c2:"#62B464",l:1};return t.color||e.interpolateHsl(e.rgb(r.c1),e.rgb(r.c2))(t.seriesIndex/2)},s=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.barColor.c1),e.rgb(a.barColor.c2))(t.seriesIndex/a.barColor.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n},s=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n+" sc-stroke"+n};break;case"data":i=function(t,e){return t.classes?"inherit":t.color||w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")},s=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var c=a.gradient?function(t,e){var n={orientation:a.orientation||"vertical",position:a.position||"middle"};return F.gradient()(t,t.seriesIndex,n)}:i;return F.color(i),F.fill(c),F.classes(o),z.color(l),z.fill(l),z.classes(s),E.color(i),E.classes(o),_.color(l),_.classes(s),t},t.x=function(e){return arguments.length?(M=e,z.x(e),F.x(e),t):M},t.y=function(e){return arguments.length?(I=e,z.y(e),F.y(e),t):I},t.margin=function(e){if(!arguments.length)return l;for(var n in e)e.hasOwnProperty(n)&&(l[n]=e[n]);return t},t.width=function(e){return arguments.length?(u=e,t):u},t.height=function(e){return arguments.length?(d=e,t):d},t.showTitle=function(e){return arguments.length?(f=e,t):f},t.showControls=function(e){return!!arguments.length&&t},t.showLegend=function(e){return arguments.length?(h=e,t):h},t.tooltipBar=function(e){return arguments.length?(N=e,t):N},t.tooltipLine=function(e){return arguments.length?(R=e,t):R},t.tooltipQuota=function(e){return arguments.length?(O=e,t):O},t.tooltips=function(e){return arguments.length?(g=e,t):g},t.clipEdge=function(e){return arguments.length?(m=e,F.clipEdge(e),L.clipEdge(e),z.clipEdge(e),t):m},t.state=function(e){return arguments.length?(x=e,t):x},t.strings=function(e){if(!arguments.length)return b;for(var n in e)e.hasOwnProperty(n)&&(b[n]=e[n]);return t},t.direction=function(e){return arguments.length?(p=e,F.direction(e),P.direction(e),B.direction(e),E.direction(e),_.direction(e),t):p},t.duration=function(e){return arguments.length?(y=e,F.duration(e),L.duration(e),z.duration(e),t):y},t.delay=function(e){return arguments.length?(v=e,F.delay(e),L.delay(e),z.delay(e),t):v},t.seriesClick=function(e){return arguments.length?(q=e,t):q},t.colorFill=function(e){return t},t.xValueFormat=function(e){return arguments.length?(S=e,t):S},t.yValueFormat=function(e){return arguments.length?(D=e,t):D},t.quotaValueFormat=function(e){return arguments.length?(T=e,t):T},t.locality=function(e){return arguments.length?(A=w.buildLocality(e),F.locality(e),L.locality(e),t):A},t}function y(){function t(n){return n.each(function(n){function o(e){var n=e&&e.length,a=(S-r.left-r.right)/2+r.left,i=(D-r.top-r.bottom)/2+r.top;return w.displayNoData(n,u,t.strings().noData,a,i)}var s=this,u=e.select(this),f="pie",m=n?n.properties:{},I=n?n.data:null,S=parseInt(u.style("width"),10),D=parseInt(u.style("height"),10);"datetime"===n.properties.xDataType||!1,"currency"===n.properties.yDataType||!1;if(t.update=function(){u.transition().duration(h).call(t)},t.container=this,o(I))return t;t.clearActive=function(){I.map(function(t){return t.active="",u.selectAll(".nv-series").classed("nv-inactive",!1),t})},t.seriesActivate=function(e){t.dataSeriesActivate({series:I[e.seriesIndex]})},t.dataSeriesActivate=function(e){var n=e.series;n.active=n.active&&"inactive"!==n.active?"inactive":"active","active"===n.active&&I.filter(function(t){return"active"!==t.active}).map(function(t){return t.active="inactive",t}),I.filter(function(t){return"active"===t.active}).length||t.clearActive(),u.call(t)},I.forEach(function(t,n){var r=y.y();t.seriesIndex=n,t.value||t.values?isNaN(t.value)||(t.values=[{x:0,y:parseInt(t.value,10)}]):t.values=[],t.values.forEach(function(e,n){e.index=n,e.series=t,"undefined"==typeof e.value&&(e.value=r(e))}),t.value=t.value||e.sum(t.values,function(t){return t.value}),t.count=t.count||t.values.length,t.disabled=t.disabled||0===t.value});var T=I.filter(function(t,e){return!t.disabled});if(T.length||(T=[{values:[]}]),m.count=e.sum(T,function(t){return t.count}),m.total=e.sum(T,function(t){return t.value}),l=l&&m.title.length,g.disabled=I.map(function(t){return!!t.disabled}),!m.total)return o(),t;var F=u.selectAll("g.sc-chart-wrap").data([T]),L=F.enter().append("g").attr("class","sc-chart-wrap sc-chart-"+f),z=u.select(".sc-chart-wrap").merge(L);L.append("rect").attr("class","sc-background").attr("x",-r.left).attr("y",-r.top).attr("fill","#FFF"),L.append("g").attr("class","sc-title-wrap");var P=z.select(".sc-title-wrap");L.append("g").attr("class","sc-"+f+"-wrap");var B=z.select(".sc-"+f+"-wrap");L.append("g").attr("class","sc-controls-wrap");z.select(".sc-controls-wrap");L.append("g").attr("class","sc-legend-wrap");var E=z.select(".sc-legend-wrap");t.render=function(){var e,n,o,s,f,p,g;S=parseInt(u.style("width"),10),D=parseInt(u.style("height"),10),e=a||S||960,n=i||D||400,o=e-r.left-r.right,s=n-r.top-r.bottom,f={top:0,right:0,bottom:0,left:0},p=o-f.left-f.right,g=s-f.top-f.bottom,z.attr("transform","translate("+r.left+","+r.top+")"),z.select(".sc-background").attr("width",e).attr("height",n);var v=0,x={width:0,height:0},k=0;if(P.select(".sc-title").remove(),l&&(P.append("text").attr("class","sc-title").attr("x","rtl"===d?o:0).attr("y",0).attr("dy",".75em").attr("text-anchor","start").attr("stroke","none").attr("fill","black").text(m.title),x=w.getTextBBox(P.select(".sc-title")),v+=x.height),c){b.id("legend_"+t.id()).strings(t.strings().legend).align("center").height(s-f.top),E.datum(I).call(b),b.arrange(o);var M=w.getTextBBox(E.select(".sc-menu-link")),A=o-x.width-6,C=!!(l&&b.collapsed()&&A>M.width),F="rtl"!==d&&b.collapsed()?o-b.width():0,L=x.height;C?L=x.height-b.height()/2-M.height/2:l||(L=-b.margin().top),E.attr("transform","translate("+F+","+L+")"),k=C?12:b.height()-(l?0:b.margin().top)}v+=k,f.top+=v,g=s-f.top-f.bottom,p=o-f.left-f.right,y.width(p).height(g),B.datum(T).attr("transform","translate("+f.left+","+f.top+")").transition().duration(h).call(y)},t.render(),b.dispatch.on("legendClick",function(e,n){e.disabled=!e.disabled,e.active=!1,I.filter(function(t){return!t.disabled}).length||I.map(function(t){return t.disabled=!1,t}),I.filter(function(t){return"active"===t.active}).length||I.map(function(t){return t.active="",t}),g.disabled=I.map(function(t){return!!t.disabled}),v.call("stateChange",this,g),u.transition().duration(h).call(t)}),v.on("tooltipShow",function(t){p&&(M=A(t,s.parentNode,m))}),v.on("tooltipMove",function(t){M&&k.position(s.parentNode,M,t)}),v.on("tooltipHide",function(){p&&k.cleanup()}),v.on("changeState",function(e){"undefined"!=typeof e.disabled&&(T.forEach(function(t,n){t.disabled=e.disabled[n]}),g.disabled=e.disabled),u.transition().duration(h).call(t)}),v.on("chartClick",function(){x.enabled()&&x.dispatch.call("closeMenu",this),b.enabled()&&b.dispatch.call("closeMenu",this)}),y.dispatch.on("elementClick",function(e){v.call("chartClick",this),C(I,e,t)})}),t}var r={top:10,right:10,bottom:10,left:10},a=null,i=null,l=!1,s=!1,c=!0,d="ltr",f=0,h=0,p=!0,g={},m={legend:{close:"Hide legend",open:"Show legend"},controls:{close:"Hide controls",open:"Show controls"},noData:"No Data Available.",noLabel:"undefined"},v=e.dispatch("chartClick","elementClick","tooltipShow","tooltipHide","tooltipMove","stateChange","changeState"),y=u(),x=o().align("center"),b=o().align("center"),M=null,I=function(t,e){var n=y.getKey()(t),r=y.getValue()(t),a=e.total?(100*r/e.total).toFixed(1):100;return"<h3>"+n+"</h3><p>"+r+" on "+a+"</p>"},A=function(t,e,n){var r=I(t,n);return k.show(t.e,r,null,null,e)},C=function(t,e,n){};return y.dispatch.on("elementMouseover.tooltip",function(t){v.call("tooltipShow",this,t)}),y.dispatch.on("elementMousemove.tooltip",function(t){v.call("tooltipMove",this,t)}),y.dispatch.on("elementMouseout.tooltip",function(){v.call("tooltipHide",this)}),t.dispatch=v,t.pie=y,t.legend=b,t.controls=x,n.rebind(t,y,"id","x","y","color","fill","classes","gradient","locality","textureFill"),n.rebind(t,y,"getKey","getValue","fmtKey","fmtValue","fmtCount"),n.rebind(t,y,"showLabels","showLeaders","donutLabelsOutside","pieLabelsOutside","labelThreshold"),n.rebind(t,y,"arcDegrees","rotateDegrees","minRadius","maxRadius","fixedRadius","startAngle","endAngle","donut","hole","holeFormat","donutRatio"),t.colorData=function(n){var r=arguments[0],a=arguments[1]||{},i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex};switch(r){case"graduated":i=function(t,n){return e.interpolateHsl(e.rgb(a.c1),e.rgb(a.c2))(t.seriesIndex/a.l)};break;case"class":i=function(){return"inherit"},o=function(t,e){var n=t.seriesIndex*(a.step||1)%14;return n=(n>9?"":"0")+n,"sc-series sc-series-"+t.seriesIndex+" sc-fill"+n};break;case"data":i=function(t,e){return w.defaultColor()(t,t.seriesIndex)},o=function(t,e){return"sc-series sc-series-"+t.seriesIndex+(t.classes?" "+t.classes:"")}}var l=a.gradient?function(t,e){return y.gradient()(t,t.seriesIndex)}:i;return y.color(i),y.fill(l),y.classes(o),b.color(i),b.classes(o),t},t.margin=function(e){if(!arguments.length)return r;for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return t},t.width=function(e){return arguments.length?(a=e,t):a},t.height=function(e){return arguments.length?(i=e,t):i},t.showTitle=function(e){return arguments.length?(l=e,t):l},t.showControls=function(e){return arguments.length?(s=e,t):s},t.showLegend=function(e){return arguments.length?(c=e,t):c},t.tooltips=function(e){return arguments.length?(p=e,t):p},t.tooltipContent=function(e){return arguments.length?(I=e,t):I},t.state=function(e){return arguments.length?(g=e,t):g},t.strings=function(e){if(!arguments.length)return m;for(var n in e)e.hasOwnProperty(n)&&(m[n]=e[n]);return t},t.direction=function(e){return arguments.length?(d=e,y.direction(e),b.direction(e),x.direction(e),t):d},t.duration=function(e){return arguments.length?(h=e,y.duration(e),t):h},t.delay=function(e){return arguments.length?(f=e,y.delay(e),t):f},t.seriesClick=function(e){return arguments.length?(C=e,t):C},t.colorFill=function(e){return t},t}function x(){function t(r){return r.each(function(r){function a(t){T=e.hierarchy(t,function(t){return t.children}),P(T),F=T.descendants(),F.forEach(function(t){y(t,2*t.depth*(p?s.width:s.height))}),L=F.slice(1)}function c(t){x(t,k(t)),b(t,M(t)),t.children&&t.children.length&&t.children.forEach(c)}var m=e.select(this),v=r,S=e.transition("tree").duration(o).ease(e.easeLinear),T=null,F=null,L=null,z=null,P=e.tree().size([null,null]).nodeSize([p?s.height:s.width,1]).separation(function(t,e){return t.parent==e.parent,1}),B={width:parseInt(m.style("width"),10)-n.left-n.right,height:parseInt(m.style("height"),10)-n.top-n.bottom},E=m.selectAll("g.sc-chart-wrap").data([1]),_=E.enter().append("g").attr("class","sc-chart-wrap sc-chart-tree"),H=m.select(".sc-chart-wrap").merge(_),N=_.append("defs"),R=H.select("defs").merge(N),O=w.dropShadow("node_back_"+g,R,{blur:2});N.append("clipPath").attr("id","sc-edge-clip-"+g).append("rect");var V=R.select("#sc-edge-clip-"+g+" rect");V.attr("width",B.width).attr("height",B.height).attr("x",n.left).attr("y",n.top),H.attr("clip-path",D?"url(#sc-edge-clip-"+g+")":""),_.append("rect").attr("class","sc-chart-background").attr("width",B.width).attr("height",B.height).attr("transform","translate("+n.left+","+n.top+")").style("fill","transparent");var W=H.select(".sc-chart-background"),q=_.append("g").attr("class","sc-wrap"),Y=H.select(".sc-wrap");q.append("g").attr("class","sc-tree");var G=H.select(".sc-tree");t.setZoom=function(){z=e.zoom().scaleExtent([l.min,l.max]).on("zoom",function(){Y.attr("transform","translate("+e.event.transform.x+","+e.event.transform.y+")scale("+e.event.transform.k+")"),d(e.event.transform.k)})},t.unsetZoom=function(t){z.on("zoom",null)},t.resetZoom=function(){H.call(z.transform,e.zoomIdentity)},t.orientation=function(e){p="horizontal"===e||!p,P.nodeSize([p?s.height:s.width,1]),t.update(T)},t.showall=function(){function e(t){t._children&&t._children.length&&(t.children=t._children,t._children=null),t.children&&t.children.length&&t.children.forEach(e)}v=r,e(v),t.update(T)},t.zoomStep=function(t){var n=e.zoomTransform(H.node()),r=n.k+t;return this.zoomLevel(r)},t.zoomLevel=function(t){var n=e.zoomTransform(H.node()),r=Math.min(Math.max(t,l.min),l.max),a=n.k,i=[n.x,n.y],o=W.node().getBoundingClientRect(),s=[o.width,o.height],c=[(s[0]-s[0]*r)/2,(s[1]-s[1]*r)/2],u=[r*(i[0]-(s[0]-s[0]*a)/2)/a,r*(i[1]-(s[1]-s[1]*a)/2)/a],d=[c[0]+u[0],c[1]+u[1]],f=e.zoomIdentity.translate(d[0],d[1]).scale(r);return H.call(z.transform,f),r},t.zoomScale=function(){var t=e.zoomTransform(H.node());return t.k},t.filter=function(e){function n(t){C(t)===e?(v=t,a=!0):!a&&t.children&&t.children.forEach(n)}var a=!1;n(r),t.update(T)},t.update=function(e){function n(t,e){var n=M(t)-(p?0:s.height-3*i),r=k(t)-(p?s.width-2*i:0),a=M(e),o=k(e),l=p?(r+o)/2:r,c=p?n:(n+a)/2,u=p?(r+o)/2:o,d=p?a:(n+a)/2;return"M"+r+","+n+"C"+l+","+c+" "+u+","+d+" "+o+","+a}function r(t){if(C(e)===C(T))return n(T,T);var r={x:I(e),y:A(e)};return n(r,r)}function l(t){return n(t,t.parent)}function d(){return n(b,b)}function g(t){t.children?(t._children=t.children,t.children=null):(t.children=t._children,t._children=null)}function m(e){g(e.data),t.update(e)}function y(t){var e="card-"+C(t);return e}function x(t){var e="link-"+(t.parent?C(t.parent):0)+"-"+C(t);return e}var b={x:0,y:0};a(v);var w=(p?i-s.width:s.width/-2)+"px",D=(p?(i-s.height)/2:2*i-s.height)+"px",z=G.selectAll("g.sc-card").data(F,C),P=z.enter().insert("g").attr("class","sc-card").attr("id",y).attr("opacity",function(t){return C(e)===C(t)?1:0}).attr("transform",function(t){return C(e)===C(T)?"translate("+k(T)+","+M(T)+")":"translate("+(p?A(e):I(e))+","+(p?I(e):A(e))+")"});P.each(function(t){var e,n;R.select("#myshape-"+C(t)).empty()&&(e=R.append("svg").attr("class","sc-foreign-object").attr("id","myshape-"+C(t)).attr("version","1.1").attr("xmlns","http://www.w3.org/2000/svg").attr("xmlns:xlink","http://www.w3.org/1999/xlink").attr("x",w).attr("y",D).attr("width",s.width+"px").attr("height",s.height+"px").attr("viewBox","0 0 "+s.width+" "+s.height).attr("xml:space","preserve"),n=e.append("g").attr("class","sc-tree-node-content").attr("transform","translate("+i+","+i+")"),u(n,t,s.width-2*i,s.height-3*i))}),P.append("use").attr("xlink:href",function(t){return"#myshape-"+C(t)}).attr("filter",O).on("click",h).call(f);var B=P.append("g").attr("class","sc-expcoll").style("opacity",1e-6).on("click",m);B.append("circle").attr("class","sc-circ-back").attr("r",i),B.append("line").attr("class","sc-line-vert").attr("x1",0).attr("y1",.5-i).attr("x2",0).attr("y2",i-.5).style("stroke","#bbb"),B.append("line").attr("class","sc-line-hrzn").attr("x1",.5-i).attr("y1",0).attr("x2",i-.5).attr("y2",0).style("stroke","#fff");var E=G.selectAll("g.sc-card").merge(P);E.transition(S).duration(o).attr("opacity",1).attr("transform",function(t){return C(e)===C(t)&&(b={x:p?M(t):k(t),y:p?k(t):M(t)}),"translate("+k(t)+","+M(t)+")"}),E.select(".sc-expcoll").style("opacity",function(t){return t.data.children&&t.data.children.length||t.data._children&&t.data._children.length?1:0}),E.select(".sc-circ-back").style("fill",function(t){return t.data._children&&t.data._children.length?"#777":t.data.children?"#bbb":"none"}),E.select(".sc-line-vert").style("stroke",function(t){return t.data._children&&t.data._children.length?"#fff":"#bbb"}),E.each(function(t){R.select("#myshape-"+C(t)).attr("x",w).attr("y",D)});var _=z.exit().transition(S).duration(o).attr("opacity",0).attr("transform",function(t){return"translate("+k(b)+","+M(b)+")"}).remove();_.selectAll(".sc-expcoll").style("stroke-opacity",1e-6),_.selectAll(".sc-foreign-object").attr("width",1).attr("height",1).attr("x",-1).attr("y",-1);var H=G.selectAll("path.link").data(L,x),N=H.enter().insert("path","g").attr("d",r).attr("class","link").attr("id",x).attr("opacity",0),V=G.selectAll("path.link").merge(N);V.transition(S).duration(o).attr("d",l).attr("opacity",1),H.exit().transition(S).duration(o).attr("d",d).attr("opacity",0).remove(),c(T),t.resize(C(e)===C(T))},t.render=function(){t.resize(!0)},t.resize=function(r){r="undefined"==typeof r||r,t.resetZoom(),B={width:parseInt(m.style("width"),10)-n.left-n.right,height:parseInt(m.style("height"),10)-n.top-n.bottom};var a=[Math.abs(e.min(F,k))+Math.abs(e.max(F,k))+s.width,Math.abs(e.min(F,M))+Math.abs(e.max(F,M))+s.height],i=B.width/a[0],l=B.height/a[1],c=e.min([i,l]),u=[Math.abs(e.min(F,k))+(i<l?0:(B.width/c-a[0])/2),Math.abs(e.min(F,M))+(i<l?(B.height/c-a[1])/2:0)],d=[s.width/(p?1:2),s.height/(p?2:1)],f=[(u[0]+d[0])*c+n.left/(p?2:1),(u[1]+d[1])*c+n.top/(p?1:2)];V.attr("width",B.width).attr("height",B.height),W.attr("width",B.width).attr("height",B.height),G.transition(S).duration(r?0:o).attr("transform","translate("+f+")scale("+c+")")},t.setZoom(),H.call(z),a(v),c(T),t.update(T)}),t}var n={top:10,right:10,bottom:10,left:10},r=null,a=null,i=6,o=300,l={min:.25,max:2},s={width:100,height:50},c="../img/",u=function(t){return'<div class="sc-tree-node"></div>'},d=function(t){},f=function(t){},h=function(t){},p=!1,g=Math.floor(1e4*Math.random()),m=function(t,e){return w.defaultColor()(t,e)},v=function(t,e){return m(t,e)},y=function(t,e){t.y=e},x=function(t,e){t.data.x0=e},b=function(t,e){t.data.y0=e},k=function(t){return p?t.y:t.x},M=function(t){return p?t.x:t.y},I=function(t){return p?t.data.y0:t.data.x0},A=function(t){return p?t.data.x0:t.data.y0},C=function(t){return t.id||t.data.id},S=!1,D=!0,T=!0,F=e.dispatch("chartClick","elementClick","elementDblClick","elementMouseover","elementMouseout");return t.dispatch=F,t.color=function(e){return arguments.length?(m=e,t):m},t.fill=function(e){return arguments.length?(v=e,t):v},t.useClass=function(e){return arguments.length?(S=e,t):S},t.width=function(e){return arguments.length?(r=e,t):r},t.height=function(e){return arguments.length?(a=e,t):a},t.x=function(e){return arguments.length?(k=e,t):k},t.y=function(e){return arguments.length?(M=w.functor(e),t):M},t.showLabels=function(e){return arguments.length?(T=e,t):T},t.id=function(e){return arguments.length?(g=e,t):g},t.radius=function(e){return arguments.length?(i=e,t):i},t.duration=function(e){return arguments.length?(o=e,t):o},t.zoomExtents=function(e){return arguments.length?(l=e,t):l},t.zoomCallback=function(e){return arguments.length?(d=e,t):d},t.margin=function(e){return arguments.length?(n=e,t):n},t.nodeSize=function(e){return arguments.length?(s=e,t):s},t.nodeImgPath=function(e){return arguments.length?(c=e,t):c},t.nodeRenderer=function(e){return arguments.length?(u=e,t):u},t.nodeCallback=function(e){return arguments.length?(f=e,t):f},t.nodeClick=function(e){return arguments.length?(h=e,t):h},t.horizontal=function(e){return arguments.length?(p=e,t):p},t.getId=function(e){return arguments.length?(C=e,t):C},t}e="default"in e?e.default:e,n="default"in n?n.default:n;var b="0.5.6";const w={};w.strip=function(t){return t.replace(/(\s|&)/g,"")},w.identity=function(t){return t},w.functor=function(t){return"function"==typeof t?t:function(){return t}},w.daysInMonth=function(t,e){return new Date(e,t+1,0).getDate()},w.windowSize=function(){var t={width:640,height:480};return document.body&&document.body.offsetWidth&&(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight),"CSS1Compat"===document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(t.width=window.innerWidth,t.height=window.innerHeight),t},w.windowResize=function(t){window.attachEvent?window.attachEvent("onresize",t):window.addEventListener&&window.addEventListener("resize",t,!0)},w.windowUnResize=function(t){window.detachEvent?window.detachEvent("onresize",t):window.removeEventListener&&window.removeEventListener("resize",t,!0)},w.resizeOnPrint=function(t){if(window.matchMedia){var e=window.matchMedia("print");e.addListener(function(e){e.matches&&t()})}else window.attachEvent?window.attachEvent("onbeforeprint",t):window.onbeforeprint=t},w.unResizeOnPrint=function(t){if(window.matchMedia){var e=window.matchMedia("print");e.removeListener(function(e){e.matches&&t()})}else window.detachEvent?window.detachEvent("onbeforeprint",t):window.onbeforeprint=null},w.getColor=function(t){return arguments.length?Array.isArray(t)?function(e,n){return e.color||t[n%t.length]}:"[object String]"===Object.prototype.toString.call(t)?function(e){return e.color||"#"+t.replace("#","")}:t:w.defaultColor()},w.defaultColor=function(){var t=e.scaleOrdinal(e.schemeCategory20).range();return function(e,n){return e.color||t[n%t.length]}},w.customTheme=function(t,n,r){n=n||function(t){return t.key},r=r||e.scaleOrdinal(e.schemeCategory20).range();var a=r.length;return function(e,i){var o=n(e);return a||(a=r.length),"undefined"!=typeof t[o]?"function"==typeof t[o]?t[o]():t[o]:r[--a]}},w.pjax=function(t,n){function r(r){e.html(r,function(r){var a=e.select(n).node();a.parentNode.replaceChild(e.select(r).select(n).node(),a),w.pjax(t,n)})}e.selectAll(t).on("click",function(){history.pushState(this.href,this.textContent,this.href),r(this.href),e.event.preventDefault()}),e.select(window).on("popstate",function(){e.event.state&&r(e.event.state)})},w.NaNtoZero=function(t){return"number"!=typeof t||isNaN(t)||null===t||t===1/0?0:t},w.optionsFunc=function(t){return t&&e.map(t).forEach(function(t,e){"function"==typeof this[t]&&this[t](e)}.bind(this)),this},w.colorLinearGradient=function(t,n,r,a,i){var o="lg_gradient_"+n,l=i.select("#"+o);return l.empty()&&("middle"===r.position?w.createLinearGradient(o,r,i,[{offset:"0%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1},{offset:"20%","stop-color":e.rgb(a).toString(),"stop-opacity":1},{offset:"50%","stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1},{offset:"80%","stop-color":e.rgb(a).toString(),"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1}]):w.createLinearGradient(o,r,i,[{offset:"0%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1},{offset:"50%","stop-color":e.rgb(a).toString(),
"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1}])),"url(#"+o+")"},w.createLinearGradient=function(t,e,n,r){for(var a,i,o="horizontal"===e.orientation?"0%":"100%",l="horizontal"===e.orientation?"100%":"0%",s=n.append("linearGradient").attr("id",t).attr("x1","0%").attr("y1","0%").attr("x2",o).attr("y2",l).attr("spreadMethod","pad"),c=0;c<r.length;c+=1){a=r[c],i=s.append("stop");for(var u in a)a.hasOwnProperty(u)&&i.attr(u,a[u])}},w.colorRadialGradient=function(t,n,r,a,i){var o="rg_gradient_"+n,l=i.select("#"+o);return l.empty()&&w.createRadialGradient(o,r,i,[{offset:r.s,"stop-color":e.rgb(a).brighter().toString(),"stop-opacity":1},{offset:"100%","stop-color":e.rgb(a).darker().toString(),"stop-opacity":1}]),"url(#"+o+")"},w.createRadialGradient=function(t,e,n,r){for(var a,i,o=n.append("radialGradient").attr("id",t).attr("r",e.r).attr("cx",e.x).attr("cy",e.y).attr("gradientUnits",e.u).attr("spreadMethod","pad"),l=0;l<r.length;l+=1){a=r[l],i=o.append("stop");for(var s in a)a.hasOwnProperty(s)&&i.attr(s,a[s])}},w.getAbsoluteXY=function(t){var e=document.documentElement,n=t.getBoundingClientRect(),r=e.scrollLeft+document.body.scrollLeft,a=e.scrollTop+document.body.scrollTop,i=n.left+r,o=n.top+a;return{left:i,top:o}},w.roundedRectangle=function(t,e,n,r,a){return"M"+t+","+e+"h"+(n-2*a)+"a"+a+","+a+" 0 0 1 "+a+","+a+"v"+(r-2-2*a)+"a"+a+","+a+" 0 0 1 "+-a+","+a+"h"+(2*a-n)+"a"+-a+","+a+" 0 0 1 "+-a+","+-a+"v"+(-r+2*a+2)+"a"+a+","+a+" 0 0 1 "+a+","+-a+"z"},w.dropShadow=function(t,e,n){var r=n||{},a=r.height||"130%",i=r.offset||2,o=r.blur||1;if(e.select("#"+t).empty()){var l=e.append("filter").attr("id",t).attr("height",a),s=(l.append("feOffset").attr("in","SourceGraphic").attr("result","offsetBlur").attr("dx",i).attr("dy",i),l.append("feColorMatrix").attr("in","offsetBlur").attr("result","matrixOut").attr("type","matrix").attr("values","1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 1 0"),l.append("feGaussianBlur").attr("in","matrixOut").attr("result","blurOut").attr("stdDeviation",o),l.append("feMerge"));s.append("feMergeNode"),s.append("feMergeNode").attr("in","SourceGraphic")}return"url(#"+t+")"},w.stringSetLengths=function(t,e,n,r,a){var i=[],o=e.select(".tmp-text-strings").select("text");return o.empty()&&(o=e.append("g").attr("class","tmp-text-strings").append("text")),o.classed(r,!0),o.style("display","inline"),t.forEach(function(t,e){o.text(n(t,e)),i.push(o.node().getBoundingClientRect().width)}),o.text("").attr("class","tmp-text-strings").style("display","none"),i},w.stringSetThickness=function(t,e,n,r,a){var i=[],o=e.select(".tmp-text-strings").select("text");return o.empty()&&(o=e.append("g").attr("class","tmp-text-strings").append("text")),o.classed(r,!0),o.style("display","inline"),t.forEach(function(t,e){o.text(n(t,e)),i.push(o.node().getBoundingClientRect().height)}),o.text("").attr("class","tmp-text-strings").style("display","none"),i},w.maxStringSetLength=function(t,n,r){var a=w.stringSetLengths(t,n,r);return e.max(a)},w.stringEllipsify=function(t,e,n){var r=e.select(".tmp-text-strings").select("text"),a=t,i=0,o=0,l=0;for(r.empty()&&(r=e.append("g").attr("class","tmp-text-strings").append("text")),r.style("display","inline"),r.text("..."),o=r.node().getBoundingClientRect().width,r.text(a),i=r.node().getBoundingClientRect().width,l=i;i>n&&i>30;)a=a.slice(0,-1),r.text(a),i=r.node().getBoundingClientRect().width+o;return r.text(""),a+(l>n?"...":"")},w.getTextBBox=function(t,e){var n=t.node().getBoundingClientRect(),r={width:e?n.width:parseInt(n.width,10),height:e?n.height:parseInt(n.height,10)};return r},w.getTextContrast=function(t,n,r){var a=t,i=e.lab(a),o=i.l,l=o>60?i.darker(4+(o-75)/25).l:i.brighter(4+(18-o)/25).l,s=e.lab(l,0,0),c=s.toString();return r&&r(i,s),c},w.isRTLChar=function(t){var e="֑-߿יִ-﷿ﹰ-ﻼ",n=new RegExp("["+e+"]");return n.test(t)},w.polarToCartesian=function(t,e,n,r){var a=w.angleToRadians(r),i=t+n*Math.cos(a),o=e+n*Math.sin(a);return[i,o]},w.angleToRadians=function(t){return t*Math.PI/180},w.angleToDegrees=function(t){return 180*t/Math.PI},w.createTexture=function(t,e,n,r){var a="#sc-diagonalHatch-"+e,i="#sc-textureMask-"+e;return t.append("pattern").attr("id","sc-diagonalHatch-"+e).attr("patternUnits","userSpaceOnUse").attr("width",8).attr("height",8).append("path").attr("d","M-1,1 l2,-2 M0,8 l8,-8 M7,9 l1,-1").attr("class","texture-line").attr("stroke","#fff").attr("stroke-linecap","square"),t.append("mask").attr("id","sc-textureMask-"+e).attr("x",0).attr("y",0).attr("width","100%").attr("height","100%").append("rect").attr("x",n||0).attr("y",r||-1).attr("width","100%").attr("height","100%").attr("fill","url("+a+")"),i},w.numberFormatSI=function(t,n,r,a){var i,o;return isNaN(t)||0===t?t:(n="undefined"==typeof n?2:n,r="undefined"!=typeof r&&!!r,i="undefined"==typeof a?e.format:e.formatLocale(a).format,o=r?"$,":",",r&&t<1e3&&t!==parseInt(t,10)?o+=".2s":Math.abs(t)>1&&Math.abs(t)<=1e3?t=0===n?Math.round(t):Math.round(10*t*n)/(10*n):o+="."+n+"s",t>-1&&t<1?i(o)(t):i(o)(t))},w.round=function(t,e){var n=Math.pow(10,e);return Math.round(t*n)/n},w.numberFormatRound=function(t,n,r,a){var i,o;return isNaN(t)?t:(r="undefined"!=typeof r&&!!r,n="undefined"==typeof n?r?2:0:n,i="undefined"==typeof a?e.format:e.formatLocale(a).format,o=r?"$,."+n+"f":",",i(o)(t))},w.isValidDate=function(t){var e;return!!t&&(e=new Date(t),e instanceof Date&&!isNaN(e.valueOf()))},w.getDateFormat=function(t){var n=["multi",".%L",":%S","%I:%M","%I %p","%x","%b %d","%B","%Y"],r=0;return r=t.length?e.min(t,function(t){var n,r=new Date(t.valueOf()+6e4*t.getTimezoneOffset());return n=e.timeSecond(r)<t?1:e.timeMinute(r)<t?2:e.timeHour(r)<t?3:e.timeDay(r)<t?4:e.timeMonth(r)<t?5:e.timeYear(r)<t?7:8}):0,n[r]},w.multiFormat=function(t){var n,r=".%L",a=":%S",i="%I:%M",o="%I %p",l="%x",s="%B",c="%Y",u=new Date(t.valueOf()+6e4*t.getTimezoneOffset());return n=e.timeSecond(u)<t?r:e.timeMinute(u)<t?a:e.timeHour(u)<t?i:e.timeDay(u)<t?o:e.timeMonth(u)<t?l:e.timeYear(u)<t?s:c},w.dateFormat=function(t,n,r){var a,i,o,l,s;return a=t.toString(),isNaN(parseInt(a,10))||4!==a.length?i=new Date(t):(a+="-1-1",i=new Date(a)),i instanceof Date&&!isNaN(i.valueOf())?(r&&r.hasOwnProperty("timeFormat")?(s=r.timeFormat,l=n&&n.indexOf("%")!==-1?n:w.multiFormat(i)):(o=r||w.buildLocality(r),s=e.timeFormatLocale(o).format,l=n&&n.indexOf("%")!==-1?n:o[n]||w.multiFormat(i)),s(l)(i)):t},w.buildLocality=function(t,e){var n,r=t||{},a=!!e,i=function(t){return t.join("|").split("|").map(function(t){return t?isNaN(t)?t:+t:""})},o={decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%B %-d, %Y at %X %p GMT%Z",date:"%b %-d, %Y",time:"%-I:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],full:"%A, %c",long:"%c",medium:"%x, %X %p",short:"%-m/%-d/%y, %-I:%M %p",yMMMEd:"%a, %x",yMEd:"%a, %-m/%-d/%Y",yMMMMd:"%B %-d, %Y",yMMMd:"%x",yMd:"%-m/%-d/%Y",yMMMM:"%B %Y",yMMM:"%b %Y",MMMd:"%b %-d",MMMM:"%B",MMM:"%b",y:"%Y"};for(var l in r)t.hasOwnProperty(l)&&(n=r[l],o[l]=a&&Array.isArray(n)?i(n):n);return o},w.displayNoData=function(t,e,n,r,a){var i=t?[]:[n],o=e.selectAll(".sc-no-data").data(i),l=o.enter().append("text").attr("class","sc-no-data").attr("dy","-.7em").style("text-anchor","middle"),s=e.selectAll(".sc-no-data").merge(l);return o.exit().remove(),!!i.length&&(s.attr("x",r).attr("y",a).text(w.identity),e.selectAll(".sc-chart-wrap").remove(),!0)};const k={};k.show=function(t,e,n,r,a,i){var o=document.createElement("div"),l=document.createElement("div"),s=document.createElement("div");return n=n||"s",r=r||5,l.className="tooltip-inner",s.className="tooltip-arrow",l.innerHTML=e,o.style.left=0,o.style.top=-1e3,o.style.opacity=0,o.className="tooltip xy-tooltip in",o.appendChild(l),o.appendChild(s),a.appendChild(o),k.position(a,o,t,n,r),o.style.opacity=1,o},k.cleanup=function(){for(var t=document.getElementsByClassName("tooltip"),e=[],n=t.length;n>0;)n-=1,t[n].className.indexOf("xy-tooltip")!==-1&&(e.push(t[n]),t[n].style.transitionDelay="0 !important",t[n].style.opacity=0,t[n].className="sctooltip-pending-removal out");setTimeout(function(){for(var t;e.length;)t=e.pop(),t.parentNode.removeChild(t)},500)},k.position=function(t,e,n,r,a){function i(){var t=f[0]-h/2;return t<v&&(t=v),t+h>g&&(t=g-h),t}function o(){var t=f[1]-p/2;return t<y&&(t=y),t+p>y+m&&(t=y-p),t}function l(t){var n=f[0]-h/2-t-5,r=e.getElementsByClassName("tooltip-arrow")[0];r.style.marginLeft=n+"px"}function s(t){var n=f[1]-p/2-t-5,r=e.getElementsByClassName("tooltip-arrow")[0];r.style.marginTop=n+"px"}r=r||"s",a=a||5;var c,u,d=t.getBoundingClientRect(),f=[n.clientX-d.left,n.clientY-d.top],h=parseInt(e.offsetWidth,10),p=parseInt(e.offsetHeight,10),g=t.clientWidth,m=t.clientHeight,v=t.scrollLeft,y=t.scrollTop,x=e.className.replace(/ top| right| bottom| left/g,"");switch(r){case"e":u=o(),c=f[0]-h-a,s(u),c<v?(c=f[0]+a,x+=" right"):x+=" left";break;case"w":u=o(),c=f[0]+a,s(u),c+h>g?(c=f[0]-h-a,x+=" left"):x+=" right";break;case"n":c=i(),u=f[1]+a,l(c),u+p>y+m?(u=f[1]-p-a,x+=" top"):x+=" bottom";break;case"s":c=i(),u=f[1]-p-a,l(c),y>u?(u=f[1]+a,x+=" bottom"):x+=" top"}e.style.left=c+"px",e.style.top=u+"px",e.className=x};const M={axis:r,funnel:a,gauge:i,menu:o,line:s,multibar:c,pie:u,scatter:l,scroller:d},I={bubbleChart:f,funnelChart:h,gaugeChart:p,lineChart:g,multibarChart:m,paretoChart:v,pieChart:y,treeChart:x},A=function(t,n,r){function a(t){return(t.hasOwnProperty("label")?t.label:String(t))||g}function i(t,e){var n={group:e+1,label:a(t)};return t.values&&(n.total=A(t.values)),n}function o(t){return t.key||a(t)}function l(t){return t&&t.filter(function(t){return t.values&&t.values.length}).length>0}function s(t,e){var n=["multibar","line","area","pie","funnel","gauge"];return n.indexOf(t)!==-1&&l(e)}function c(t){return Array.isArray(t)&&t.length&&Array.isArray(t[0])}function u(t){return 1===e.max(t,function(t){return t.values.length})}var d,f=[],h=t.properties?Array.isArray(t.properties)?t.properties[0]:t.properties:{},p=0,g="Undefined",m=!0,v=!1,y=!1,x=[],b=h.groups||t.label||h.labels||h.label||[],w=[],k="datetime"===h.xDataType||!1,M="ordinal"===h.xDataType||!1,I="numeric"===h.xDataType||!1,A=("currency"===h.yDataType||!1,function(t){return t?t.reduce(function(t,e){return parseFloat(t)+e},0):0});if(v=c(t.values),v?(x=h.keys||t.values.splice(0,1)[0].splice(1),b=[],d=e.transpose(t.values.map(function(t,e){var n=t.splice(0,1)[0];return M&&b.push(i(n,e)),t.map(function(t,r){return k||I?[n,t]:M?[e+1,t]:void 0})})),f=x.map(function(t,e){return{key:t,values:d[e]}})):f=t.data,m=s(n,f)){v=c(f[0].values),y=u(f);var C=v?function(t){return t[0]}:function(t){return t.x},S=v?function(t){return t[1]}:function(t){return t.y},D=v?function(t,e){return{x:T(t[0],e),y:F(t[1],e)}}:function(t,e){return t.x=T(t.x,e),t.y=F(t.y,e),t},T=k?function(t,e,n){var r=4===t.toString().length?"1/1/"+t.toString():t;r.indexOf("GMT")===-1&&(r+=" GMT");var a=new Date(r);return a.toUTCString()}:M?function(t,e){return e+1}:I?function(t,e){return parseFloat(t)}:function(t){return t},F=function(t){return parseFloat(t)};switch(n){case"multibar":"basic"===r?1===f.length?(f=f.map(function(t,e){return t.key=o(t)||"Series "+e,t.values=t.values.map(function(t,e){return D(t,e)}),t}),h.seriesLength=f[0].values.length):(f=[{key:h.key||"Series 0",values:f.reduce(function(t,e,n){return e?v?t.values.map(function(t,n){return{x:T(C(t),n),y:F(S(t),n)+S(e.values[n])}}):t.values.map(function(t,n){return t.x=T(C(t),n),t.y=F(S(t),n)+S(e.values[n]),t}):t})}],h.seriesLength=f[0].values.length):y?(f=f.map(function(t,e){return{key:o(t),values:f.map(function(t,n){var r=t.values[0];return e===n?v?{x:T(C(r),n),y:F(S(r),n)}:(r.x=T(C(r),n),r.y=F(S(r),n),r):{x:T(C(r),n),y:0}})}}),h.seriesLength=f.length):(f=f.map(function(t,e){return t.key=o(t),t.values=t.values.map(function(t,e){return D(t,e)}),t}),h.seriesLength=f.length);break;case"pie":f=f.map(function(t,e){var n={key:o(t),disabled:t.disabled||!1,value:A(t.values)};return void 0!==t.color&&(n.color=t.color),void 0!==t.classes&&(n.classes=t.classes),n}),h.seriesLength=f.length;break;case"funnel":f=f.reverse().map(function(t,n){return{key:o(t),disabled:t.disabled||!1,values:[{series:n,x:0,y:e.sum(t.values,function(t){return S(t)}),y0:0}]}}),h.seriesLength=f.length;break;case"area":case"line":f.forEach(function(t,n){t.seriesIndex=n,t.key=o(t),t.values=v?t.values.map(function(t,e){return{x:T(t[0],n,e),y:parseFloat(t[1])}}):t.values.map(function(t,e){return t.x=T(t.x,n,e),t.y=parseFloat(t.y),t}),t.total=e.sum(t.values,function(t){return t.y}),t.total||(t.disabled=!0)}),h.seriesLength=f.length;break;case"gauge":p=t.values.shift().gvalue;var L=0;f=f.map(function(t,e){var n={key:a(t),y:parseFloat(t.values[0])+L};return L+=parseFloat(t.values[0]),n}),w=[{group:1,label:"Sum",total:p}],h.seriesLength=w.length}b.length&&(h.groups=b.map(i))}else switch(n){case"bubble":if(!t.data){var z={"Negotiation/Review":"Negotiat./Review","Perception Analysis":"Percept. Analysis","Proposal/Price Quote":"Proposal/Quote","Id. Decision Makers":"Id. Deciders"};f={data:t.records.map(function(t){return{id:t.id,x:t.date_closed,y:Math.round(parseInt(t.likely_case,10)/parseFloat(t.base_rate)),shape:"circle",account_name:t.account_name,assigned_user_name:t.assigned_user_name,sales_stage:t.sales_stage,sales_stage_short:z[t.sales_stage]||t.sales_stage,probability:parseInt(t.probability,10),base_amount:parseInt(t.likely_case,10),currency_symbol:"$"}}),properties:{title:"Bubble Chart Data",yDataType:"string",xDataType:"datetime",seriesLength:t.records.length}}}}return{properties:h,data:f}},C=!1,S="sgr";t.development=C,t.build=S,t.version=b,t.utility=w,t.utils=w,t.tooltip=k,t.models=M,t.charts=I,t.transform=A,Object.defineProperty(t,"__esModule",{value:!0})});