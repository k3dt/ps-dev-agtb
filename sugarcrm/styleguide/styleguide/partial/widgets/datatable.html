<!-- datatable
================================================== -->
<section id="datatable">
    <div class="page-header">
        <h1>DataTables <small>jquery.datatables.js</small> <small>[<a href="http://datatables.net/" target="_blank"><i class="icon-book"></i> Docs</a>]</small></h1>
    </div>
    <div class="row">
        <div class="span3 columns">
            <h3>About</h3>
            <p>DataTables is a highly flexible tool, based upon the foundations of progressive enhancement, which will add advanced interaction controls to any HTML table.</p>
            <a href="js/jquery.datatables.js" target="_blank" class="btn">Download file</a>
        </div>
        <div class="span9 columns">
            <h2>Example</h2>
            <p>A basic data table with sorting</p>
            <div id="datatableExample">
            </div>
            <hr>
            <h2>Using jquery.datatables.js</h2>
            <p>Call datatable via javascript:</p>
<pre class="prettyprint linenums">
var aDataSet = [
['','Opp A','Qualified','25%','Jan 12th', '75%', '100,000'],
['','Opp B','Qualified','25%','Feb 12th', '75%', '120,000'],
['','Opp C','Qualified','25%','Mar 12th', '75%', '10,000']
];


$('#datatableExample').html( '&lt;table cellpadding="0" cellspacing="0" border="0" class="table table-striped datatable" id="example"&gt;&lt;/table&gt;' );
$('#example').dataTable( {
"bFilter": false,
"bInfo":false,
"bPaginate": false,
"aaData": aDataSet,
"aoColumns": [
    {
        "sTitle": "Commit",
        "sClass": "center",
        "fnRender": function(obj) {
            sReturn = "&lt;input type='checkbox'&gt;";
            return sReturn;
        }
    },
    { "sTitle": "Opportunity" },
    { "sTitle": "Sales Stage" },
    { "sTitle": "Probability" },
    { "sTitle": "Expected close" },
    { "sTitle": "Chance to close" },
    { "sTitle": "Amount" }

]
} );
</pre>
            <h3>Options</h3>
            <div id="referenceTable"></div>

            <h3>Markup</h3>
            <p>The basic structure you need when generating a tree from JSON data.</p>
<pre class="prettyprint linenums">
&lt;div id="example"&gt;&lt;/div&gt;
</pre>
        </div>
    </div>
</section>

<script src="js/jquery.datatables.js"></script>
<script src="partial/datatable-data.js"></script>

<script>
  $(function(){
      // data table example
      /* Data set - can contain whatever information you want */
      var aDataSet = [
          ['','Opp A','Qualified','25%','Jan 12th', '75%', '100,000'],
          ['','Opp B','Qualified','25%','Feb 12th', '75%', '120,000'],
          ['','Opp C','Qualified','25%','Mar 12th', '75%', '10,000']
      ];

      $('#datatableExample').html( '<table cellpadding="0" cellspacing="0" border="0" class="table table-striped datatable" id="example"></table>' );

      $('#example').dataTable( {
          "bFilter": false,
          "bInfo":false,
          "bPaginate": false,
          "aaData": aDataSet,
          "aoColumns": [
              {
                  "sTitle": "Commit",
                  "sClass": "center",
                  "fnRender": function(obj) {
                      //var sReturn = obj.aData[ obj.iDataColumn ];
                      sReturn = "<input type='checkbox'>";
                      return sReturn;
                  }
              },
              { "sTitle": "Opportunity" },
              { "sTitle": "Sales Stage" },
              { "sTitle": "Probability" },
              { "sTitle": "Expected close" },
              { "sTitle": "Chance to close" },
              { "sTitle": "Amount" }

          ]
      } );

      var anOpen = [];
      var sImageUrl = "/release-datatables/examples/examples_support/";
      //SyntaxHighlighter.config.clipboardSwf = '/media/javascript/syntax/clipboard.swf';

      var search = "";
      if ( window.location.hash !== "" ) {
          search = window.location.hash.substring( 1 );
      }
      //var aData = [];

      $('#referenceTable').html('<table id="reference" border="0" cellspacing="0" cellpadding="0" class="table table-striped datatable unmodified"><thead><tr><th></th><th>Parameter</th><th>Config type</th><th>Purpose</th></tr></thead> <tbody><tr><td colspan="4" class="dataTables_empty">Please wait - loading information...</td></tr></tbody></table>');

      var oTable = $('#reference').dataTable( {
          "bPaginate": true,
          "bFilter":true,
          "bSortClasses": false,
          "aaData" :    aData,
          "aaSorting": [[1, 'asc']],
          "oSearch": { "sSearch": search },
          "aoColumns": [
              {
                  "mDataProp": null,
                  "sClass": "control center",
                  "sDefaultContent": '<i class="icon-plus-sign"></i>',
                  "bSortable": false
              },
              { "mDataProp": 'parameter' },
              { "mDataProp": 'group', "sWidth": "160px" },
              { "mDataProp": 'purpose_short' }
          ],
          "fnInitComplete": function () {
              this.fnAdjustColumnSizing();
              $('div.dataTables_filter input').focus();
          }
      } );

      $('#reference tbody tr').live( 'click', function () {
          if ( $(this).hasClass( 'details' ) ) {
              return;
          }
          var nTr = this;
          var i = $.inArray( nTr, anOpen );
          var oData = oTable.fnGetData( nTr );

          if ( i === -1 ) {
              if( oData.purpose_short != oData.purpose ) {
                  $('div.purposeInner', nTr).html( oData.purpose );
                  $('div.purpose', nTr).animate({
                      "height": $('div.purposeInner', nTr).height()
                  });
              }

              $('i', this).attr( 'class', "icon-minus-sign" );
              var nDetailsRow = oTable.fnOpen( nTr, fnFormatDetails(oTable, nTr), 'details' );

              nDetailsRow.className += ' '+nTr.className;
              $('div.innerDetails', nDetailsRow).slideDown();
              anOpen.push( nTr );
              prettyPrint();
              //SyntaxHighlighter.highlight();
          }
          else {
              $('i', this).attr( 'class', "icon-plus-sign" );
              if( oData.purpose_short != oData.purpose ) {
                  $('div.purpose', nTr).animate({
                      "height": 90
                  });
              }
              $('div.innerDetails', $(nTr).next()[0]).slideUp( function () {
                  if( oData.purpose_short != oData.purpose ) {
                      $('div.purposeInner', nTr).html( oData.purpose_short );
                  }
                  oTable.fnClose( nTr );
                  anOpen.splice( i, 1 );
              } );
          }
      } );

      var tableData = oTable.fnGetData();
      for ( var i=0, iLen=tableData.length; i<iLen ; i++ ) {
          if ( search == tableData[i].parameter ) {
              $(oTable.fnSettings().aoData[i].nTr).click();
              $('div.dataTables_filter input').focus();
          }
      }

      $('.dataTables_wrapper').addClass('unmodified');
      $('.dataTables_wrapper .dataTables_filter input').attr('placeholder','Filter...');

  });

  function fnFormatDetails( oTable, nTr )
  {
      var oData = oTable.fnGetData( nTr );
      var sOut =
              '<div class="innerDetails">'+
                      '<div class="column_details">'+
                      '<table cellpadding="5" cellspacing="0" border="0">'+
                      '<tr><td valign="top" width="30%"><b>Parameter</b>:</td><td>'+oData.parameter+'</td></tr>'+
                      '<tr><td valign="top"><b>Type</b>:</td><td>'+oData.param_type+'</td></tr>';
      if ( oData['default'] !== "" ) {
          sOut +=   '<tr><td valign="top"><b>Default</b>:</td><td>'+oData['default']+'</td></tr>';
      }
      if ( oData.inputs !== "" ) {
          sOut +=   '<tr><td valign="top"><b>Inputs</b>:</td><td>'+oData.inputs+'</td></tr>';
      }
      if ( oData.returns !== "" ) {
          sOut +=   '<tr><td valign="top"><b>Returns</b>:</td><td>'+oData.returns+'</td></tr>';
      }
      sOut +=
              '</table>'+
              '</div>'+
              '<div class="column_code">'+
              '<pre class="prettyprint linenums">'+oData.code+'</pre>'+
              '</div>'+
              '<div class="clear"></div>'+
              '</div>';

      return sOut;
  }
</script>
