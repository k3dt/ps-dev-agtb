<!-- synced dom with sidecar on 1/11/2113 -->
<form class="form-search" action="">
    <div class="row-fluid control-group">
        <div class="filter controls controls-four btn-fit">
            <div class="filter-view search"><div><div class="select2-container select2-container-multi" id="s2id_search_filter26" style="width: 100%">    <ul class="select2-choices">  <li class="select2-search-field">    <input type="text" autocomplete="off" class="select2-input" tabindex="0" style="width: 10px;">  </li></ul></div><input id="search_filter26" type="hidden" style="width: 100%; display: none;" value="">
</div></div>
            <div class="actions" data-toggle="buttons-radio">

                    <a href="" class="btn btn-invisible" data-view="list"><i class="icon-table"></i></a>

            </div>
        </div>
    </div>

    <div class="mu extend hide">
        <article class="filter-header">
            <strong>
                Mass Update
            </strong>
            <div class="pull-right">
                <a href="#" class="btn btn-primary">Update</a>
                <a href="#" class="btn btn-invisible"><i class="icon-remove"></i></a>
            </div>
        </article>
        <article class="filter-body">
            <div class="row-fluid">
                <div class="controls span3">
                    <select class="chzn-select chzn-inherit-width buildit">
                        <option>
                            Name
                        </option>
                        <option>
                            Sales Stage
                        </option>
                    </select>
                </div>
                <div class="controls span3">
                    <select class="chzn-select chzn-inherit-width">
                        <option>
                            matches
                        </option>
                    </select>
                </div>
                <div class="filter-value controls span6">
                    <input type="text" class="inherit-width" placeholder="Enter a name...">
                    <a href="" class="btn btn-invisible addme"><i class="icon-plus"></i></a>
                </div>
            </div>
        </article>
    </div>
<div><div class="filter-options extend">
    <article class="filter-header">
        <input type="text" placeholder="Enter new filter nameâ€¦" class="span6">
        <div class="pull-right">
            <a class="btn btn-link btn-invisible delete_button">Delete</a>
            <a class="btn btn-primary disabled save_button">Save</a>
            <a class="btn btn-invisible filter-close"><i class="icon-remove"></i></a>
        </div>
    </article>
    <article class="filter-body">
      <div class="row-fluid">
        <div class="controls span3">
            <input type="text" value="Module" disabled="disabled" class="disabled inherit-width">
        </div>
        <div class="controls span3">
            <input type="text" value="matches" disabled="disabled" class="disabled inherit-width">
        </div>
        <div class="controls span5">
            <input type="text" value="Leads" disabled="disabled" class="disabled inherit-width">
        </div>
        <div class="filter-value controls span1">
        </div>
      </div>
    </article>
<article class="filter-body newRow">     <div class="row-fluid">       <div class="filter-field controls span3">         <select name="field" class="field_name chzn-select chzn-inherit-width chzn-done" data-placeholder="Select field name..." id="selK3N" style="display: none;">              <option value=""></option>                               <option data-type="name" value="name" selected="selected">Name</option>                              <option data-type="datetime" value="date_entered">Date Created</option>                              <option data-type="datetime" value="date_modified">Date Modified</option>                              <option data-type="datetime" value="last_activity_date">LBL_LAST_ACTIVITY_DATE</option>                              <option data-type="enum" value="salutation">LBL_SALUTATION</option>                              <option data-type="varchar" value="first_name">LBL_FIRST_NAME</option>                              <option data-type="varchar" value="last_name">LBL_LAST_NAME</option>                              <option data-type="varchar" value="title">LBL_TITLE</option>                              <option data-type="varchar" value="linkedin">LBL_LINKEDIN</option>                              <option data-type="varchar" value="facebook">LBL_FACEBOOK</option>                              <option data-type="varchar" value="twitter">LBL_TWITTER</option>                              <option data-type="varchar" value="googleplus">LBL_GOOGLEPLUS</option>                              <option data-type="varchar" value="department">LBL_DEPARTMENT</option>                              <option data-type="enum" value="do_not_call">LBL_DO_NOT_CALL</option>                              <option data-type="varchar" value="email1">LBL_EMAIL_ADDRESS</option>                              <option data-type="varchar" value="email2">LBL_OTHER_EMAIL_ADDRESS</option>                              <option data-type="varchar" value="primary_address_street">Primary Address Street</option>                              <option data-type="varchar" value="primary_address_street_2">Primary Address Street 2</option>                              <option data-type="varchar" value="primary_address_street_3">Primary Address Street 3</option>                              <option data-type="varchar" value="primary_address_city">Primary Address City</option>                              <option data-type="varchar" value="primary_address_state">Primary Address State</option>                              <option data-type="varchar" value="primary_address_postalcode">Primary Address Postal Code</option>                              <option data-type="varchar" value="primary_address_country">Primary Address Country</option>                              <option data-type="varchar" value="alt_address_street">LBL_ALT_ADDRESS_STREET</option>                              <option data-type="varchar" value="alt_address_street_2">LBL_ALT_ADDRESS_STREET_2</option>                              <option data-type="varchar" value="alt_address_street_3">LBL_ALT_ADDRESS_STREET_3</option>                              <option data-type="varchar" value="alt_address_city">LBL_ALT_ADDRESS_CITY</option>                              <option data-type="varchar" value="alt_address_state">LBL_ALT_ADDRESS_STATE</option>                              <option data-type="varchar" value="alt_address_postalcode">LBL_ALT_ADDRESS_POSTALCODE</option>                              <option data-type="varchar" value="alt_address_country">LBL_ALT_ADDRESS_COUNTRY</option>                              <option data-type="varchar" value="assistant">LBL_ASSISTANT</option>                              <option data-type="enum" value="converted">LBL_CONVERTED</option>                              <option data-type="varchar" value="refered_by">LBL_REFERED_BY</option>                              <option data-type="enum" value="lead_source">LBL_LEAD_SOURCE</option>                              <option data-type="enum" value="status">Status</option>                              <option data-type="varchar" value="account_name">LBL_ACCOUNT_NAME</option>                              <option data-type="varchar" value="opportunity_name">Opportunity Name</option>                              <option data-type="varchar" value="opportunity_amount">LBL_OPPORTUNITY_AMOUNT</option>                              <option data-type="varchar" value="accept_status_id">LBL_LIST_ACCEPT_STATUS</option>                              <option data-type="enum" value="accept_status_name">LBL_LIST_ACCEPT_STATUS</option>                              <option data-type="varchar" value="portal_name">LBL_PORTAL_NAME</option>                              <option data-type="varchar" value="portal_app">LBL_PORTAL_APP</option>                              <option data-type="enum" value="preferred_language">Language Preference</option>                              <option data-type="enum" value="optout_primary"></option>                      </select><div id="selK3N_chzn" class="chzn-container chzn-container-single" style="width: 222px;"><a href="javascript:void(0)" class="chzn-single"><span>Name</span><div><b></b></div></a><div class="chzn-drop" style="left: -9000px; width: 220px; top: 0px;"><div class="chzn-search" style=""><input type="text" autocomplete="off" style="width: 185px;"></div><ul class="chzn-results"><li id="selK3N_chzn_o_1" class="active-result result-selected" style="">Name</li><li id="selK3N_chzn_o_2" class="active-result" style="">Date Created</li><li id="selK3N_chzn_o_3" class="active-result" style="">Date Modified</li><li id="selK3N_chzn_o_4" class="active-result" style="">LBL_LAST_ACTIVITY_DATE</li><li id="selK3N_chzn_o_5" class="active-result" style="">LBL_SALUTATION</li><li id="selK3N_chzn_o_6" class="active-result" style="">LBL_FIRST_NAME</li><li id="selK3N_chzn_o_7" class="active-result" style="">LBL_LAST_NAME</li><li id="selK3N_chzn_o_8" class="active-result" style="">LBL_TITLE</li><li id="selK3N_chzn_o_9" class="active-result" style="">LBL_LINKEDIN</li><li id="selK3N_chzn_o_10" class="active-result" style="">LBL_FACEBOOK</li><li id="selK3N_chzn_o_11" class="active-result" style="">LBL_TWITTER</li><li id="selK3N_chzn_o_12" class="active-result" style="">LBL_GOOGLEPLUS</li><li id="selK3N_chzn_o_13" class="active-result" style="">LBL_DEPARTMENT</li><li id="selK3N_chzn_o_14" class="active-result" style="">LBL_DO_NOT_CALL</li><li id="selK3N_chzn_o_15" class="active-result" style="">LBL_EMAIL_ADDRESS</li><li id="selK3N_chzn_o_16" class="active-result" style="">LBL_OTHER_EMAIL_ADDRESS</li><li id="selK3N_chzn_o_17" class="active-result" style="">Primary Address Street</li><li id="selK3N_chzn_o_18" class="active-result" style="">Primary Address Street 2</li><li id="selK3N_chzn_o_19" class="active-result" style="">Primary Address Street 3</li><li id="selK3N_chzn_o_20" class="active-result" style="">Primary Address City</li><li id="selK3N_chzn_o_21" class="active-result" style="">Primary Address State</li><li id="selK3N_chzn_o_22" class="active-result" style="">Primary Address Postal Code</li><li id="selK3N_chzn_o_23" class="active-result" style="">Primary Address Country</li><li id="selK3N_chzn_o_24" class="active-result" style="">LBL_ALT_ADDRESS_STREET</li><li id="selK3N_chzn_o_25" class="active-result" style="">LBL_ALT_ADDRESS_STREET_2</li><li id="selK3N_chzn_o_26" class="active-result" style="">LBL_ALT_ADDRESS_STREET_3</li><li id="selK3N_chzn_o_27" class="active-result" style="">LBL_ALT_ADDRESS_CITY</li><li id="selK3N_chzn_o_28" class="active-result" style="">LBL_ALT_ADDRESS_STATE</li><li id="selK3N_chzn_o_29" class="active-result" style="">LBL_ALT_ADDRESS_POSTALCODE</li><li id="selK3N_chzn_o_30" class="active-result" style="">LBL_ALT_ADDRESS_COUNTRY</li><li id="selK3N_chzn_o_31" class="active-result" style="">LBL_ASSISTANT</li><li id="selK3N_chzn_o_32" class="active-result" style="">LBL_CONVERTED</li><li id="selK3N_chzn_o_33" class="active-result" style="">LBL_REFERED_BY</li><li id="selK3N_chzn_o_34" class="active-result" style="">LBL_LEAD_SOURCE</li><li id="selK3N_chzn_o_35" class="active-result" style="">Status</li><li id="selK3N_chzn_o_36" class="active-result" style="">LBL_ACCOUNT_NAME</li><li id="selK3N_chzn_o_37" class="active-result" style="">Opportunity Name</li><li id="selK3N_chzn_o_38" class="active-result" style="">LBL_OPPORTUNITY_AMOUNT</li><li id="selK3N_chzn_o_39" class="active-result" style="">LBL_LIST_ACCEPT_STATUS</li><li id="selK3N_chzn_o_40" class="active-result" style="">LBL_LIST_ACCEPT_STATUS</li><li id="selK3N_chzn_o_41" class="active-result" style="">LBL_PORTAL_NAME</li><li id="selK3N_chzn_o_42" class="active-result" style="">LBL_PORTAL_APP</li><li id="selK3N_chzn_o_43" class="active-result" style="">Language Preference</li></ul></div></div>       </div>       <div class="filter-operator controls span3">          <select name="operator" class="operator chzn-select chzn-inherit-width chzn-done" data-placeholder="Select operator..." id="selOA6" style="display: none;">         <option value=""></option><option value="$equals">matches</option><option value="$notEquals">does not match</option><option value="$contains">contains</option><option value="$starts">starts with</option><option value="$ends">ends with</option></select><div id="selOA6_chzn" class="chzn-container chzn-container-single chzn-container-single-nosearch" style="width: 222px;"><a href="javascript:void(0)" class="chzn-single chzn-default"><span>Select operator...</span><div><b></b></div></a><div class="chzn-drop" style="left: -9000px; width: 220px; top: 0px;"><div class="chzn-search" style=""><input type="text" autocomplete="off" style="width: 185px;"></div><ul class="chzn-results"><li id="selOA6_chzn_o_1" class="active-result" style="">matches</li><li id="selOA6_chzn_o_2" class="active-result" style="">does not match</li><li id="selOA6_chzn_o_3" class="active-result" style="">contains</li><li id="selOA6_chzn_o_4" class="active-result" style="">starts with</li><li id="selOA6_chzn_o_5" class="active-result" style="">ends with</li></ul></div></div>       </div>       <div class="filter-value hide controls span5"></div>       <div class="filter-actions span1">         <a class="removeme btn btn-invisible btn-dark"><i class="icon-minus"></i></a>         <a class="updateme btn btn-invisible hide btn-dark"><i class="icon-refresh"></i></a>         <a class="addme btn btn-invisible hide btn-dark"><i class="icon-plus"></i></a>       </div>     </div>   </article></div>
</div></form>
<script>
  var availableFilters = [
    {"label":"My Favorites", "id":"filter_1", "disabled":false, "selected":false, "classes":"", "spec":[
      {'field':'favorite','opera':'true'}
    ]},
    {"label":"My {{title}}", "id":"filter_2", "disabled":false, "selected":false, "classes":"", "spec":[
      {'field':'assigned','opera':'matches','value':'westin'}
    ]},
    {"label":"My Custom Filter", "id":"filter_3", "disabled":false, "selected":false, "classes":"", "spec":[
      {'field':'assigned','opera':'matches','value':'westin'},
      {'field':'stage','opera':'closed won'},
      {'field':'created','opera':'Last 7 days'}
    ]},
    {"label":"Create New Filter", "id":"filter_new", "disabled":false, "selected":false, "classes":"primary filter-new", "spec":[]}
  ];
  // add the current module as default chosen filter
  if ( window.location.pathname.split('/').pop() !== 'dashboard.html') {
      availableFilters.unshift(
          {"label":"{{title}}", "id":"filter_module", "disabled":true, "selected":true, "classes":"filter-disabled", "spec":[]}
      );
  }
  var filterFields = {
    'default': {'label':'','opera':'','value':'','disabled':true,'text':false},
    'name': {'label':'Name','opera':'matches,contains,not matches,not contains,true,false','disabled':false,'text':true},
    'assigned': {'label':'Assigned to','opera':'matches','disabled':true,'text':true},
    'stage': {'label':'Sales Stage','opera':'prospecting,value proposition,closed won,closed lost','disabled':false,'text':false},
    'favorite': {'label':'Favorite','opera':'true,false','disabled':false,'text':false},
    'created': {'label':'Created','opera':'Last 7 days,Last 30 days,Last 90 days,Last year','disabled':false,'text':false},
  };
//TODO: do we need an apply or does a search happen each time a filter row is added or updated
//TODO: when result is chosen, should we remove filter row choices or keep them and set create filter to use existing filter row choices.
//TODO: remove choice on single backspace
//TODO: prevent adding blank filter row
  $(document).ready(function() {

      // define global elements
      var _form = $('#{{sourceid}}'),
          _select = $('#{{sourceid}} #search_filter'),
          _options = $('#{{sourceid}} .filter-options'),
          _header = $('#{{sourceid}} .filter-header'),
          _choices,
          _results;

      // set up filter result options
      $.each(availableFilters, function(index,value){
          _select.append(
              '<option value="'+ value.id +'"'+
              ' class="custom-choice custom-result '+ (value.classes!==''?value.classes:'') +'"' +
              (value.selected?' selected="selected"':'') +
              (value.disabled?' disabled="disabled"':'') +'>'+
              value.label +
              '</option>'
          );
      });

      // instatiate filter select chosen
      _select.chosen({
        searchResultConstructor: function (id,classes,style,html,index) {
            var rtn = '<li id="'+ id +'" class="'+ classes +'" style="'+ style +'">'+ html +'</li>';
                rtn += (html.indexOf('Create New Filter')===-1) ? '<span class="icon-ok"></span>' : '<span class="icon-plus"></span>';
            return rtn;
        },
        searchChoiceConstructor: searchChoiceConstructor
      });
      _select.trigger("liszt:updated");

      // define global chosen elements
      _choices = $('#{{sourceid}} #search_filter_chzn .chzn-choices');
      _results = $('#{{sourceid}} #search_filter_chzn .chzn-results');

      // prepend legend to .chzn-choices
      _choices.prepend('<legend class="chzn-select-legend">Filter <i class="icon-caret-down"></i></legend>');

      // create new filter
      _results.on('click', '.filter-new', function(e){
          editFilterForm( availableFilters.length-1, true );
          _select.trigger("liszt:close");
          e.preventDefault();
          e.stopPropagation();
      });

      // edit existing filter
      _choices.on('click', 'a', function(e){
          if ( !$(this).parents('li').hasClass('filter-disabled') ) {
              editFilterForm( $(this).attr('rel'), false );
          }
          _select.trigger("liszt:activate");
          _select.trigger("liszt:close");
          e.preventDefault();
          e.stopPropagation();
      });

      // if form changes enable save button
      _form.on('change', function(){
          enableSaveFilterButton();
      });
      _header.find('input[name="filter"]').on('keyup', function(){
          enableSaveFilterButton();
      });

      function editFilterForm (index,isNewFilter) {

          var data = availableFilters[index];

          if (data.classes.indexOf('filter-new')===-1) {
              _results.find('.filter-new').removeClass('result-selected').addClass('active-result');
          }

          _options.find('article[id*="filter_row_"]').remove();
          _header.find('input[name="filter"]').val( data.classes.indexOf('filter-new')>-1?'':data.label );
          _header.find('input[name="id"]').val(data.id);

          // populate filter rows
          $.each(data.spec, function(index,value){
              createFilterRow(index, value, false);
          });

          // add new defalt row
          createFilterRow('new', {'field':'default','opera':'','value':''}, true);
          _header.find('a[href="#delete"]').toggleClass( 'hide', (_header.find('input[name="id"]').val()==='filter_new') );

          // if click save button then update the filter spec
          // and close filter editor
          _header.find('a[href="#save"]').off('click').on('click', function(e){
              if ( !$(this).hasClass('disabled') ) {
                  saveFilter(index,data);
                  _select.trigger("liszt:updated");
                  _results.find('.filter-new').removeClass('result-selected').addClass('active-result');
                  _options.addClass('hide');
              }
              e.preventDefault();
              e.stopPropagation();
          });

          _header.find('a[href="#delete"]').off('click').on('click', function(e){
                removeFilter(index,data);
                _select.trigger("liszt:updated");
                  _options.addClass('hide');
          });

          // close filter option extend
          // and reinstate the filter being edited
          _header.find('.filter-close').off('click').on('click', function(e){
              _select.trigger("liszt:updated");
              _results.find('.filter-new').removeClass('result-selected').addClass('active-result');
              _options.addClass('hide');
              e.preventDefault();
              e.stopPropagation();
          });

          // add filter row
          _options.off('click','.addme').on('click', '.addme', function(e) {
              var row = $(this).parents('.filter-body'),
                  isNewRow = (row.attr('id')==='filter_row_new'?true:false),
                  filterRows = _options.find('article[id*="filter_row_"]');

              if (isNewRow) {
                  row.attr('id', 'filter_row_'+ filterRows.length);
                  enableRemoveFilterRow( row );
                  createFilterRow('new', {'field':'default','opera':'','value':''}, true);
              }
              if (isNewFilter) {
                  createFieldRowChoice( row, _choices, isNewFilter );
              }
              enableSaveFilterButton();
              e.preventDefault();
              e.stopPropagation();
          });

          // remove filter row
          _options.off('click','.removeme').on('click', '.removeme', function(e) {
              var row = $(this).parents('.filter-body'),
                  id = 'search_filter_chzn_f_'+ parseInt(row.attr('id').substr(11),10);
              _choices.find('#'+id).remove();
              row.remove();
              e.preventDefault();
              e.stopPropagation();
          });

          // show edit filter options form
          _options.removeClass('hide');
      }

      function saveFilter (index,data) {

          var title = _header.find('input[type="text"]').val(),
              filterRows = _options.find('article[id*="filter_row_"]'),
              row,
              filter = {};

              filter.label = title;
              filter.id = data.id;
              filter.disabled = false;
              filter.selected = true;
              filter.classes = '';
              filter.spec = [];

          filterRows.each( function(index,value) {
              row = $(value);
              if ( row.attr('id')!=='filter_row_new' ) {
                  filter.spec.push({
                      'field': row.find('select[name="field"]').val(),
                      'opera': row.find('select[name="opera"]').val(),
                      'value': row.find('input[name="value"]').val()
                  });
              }
          });

          // check to see if this is a new filter
          if ( data.id==='filter_new' ) {
              filter.id = 'filter_'+ availableFilters.length;
              var option = '<option value="'+ filter.id +'" selected="selected" class="custom-choice custom-result">'+ title +'</option>';

              // if module filter exists,
              if ( _select.find('option').first().hasClass('filter-disabled') ) {
                  // insert at second else first
                  _select.find('option').first().after( option );
                  availableFilters.splice(1,0,filter);
              } else {
                  // create new result at top
                  _select.prepend( option );
                  availableFilters.unshift(filter);
              }
          } else {
              availableFilters[index] = filter;
              _select.find( 'option[value="'+ data.id +'"]' ).text(title).attr('selected', 'selected');
          }

          // remove field specific filter choices
          _choices.find('li[id*="search_filter_chzn_f_"]').remove();
      }

      function removeFilter (index,data) {
          availableFilters.splice(index,1);
          _select.find( 'option[value="'+ data.id +'"]' ).remove();
      }

      function createFilterRow (index,spec,isNewRow) {

          loadContent('common/search-filter-row.html', '.filter-options', undefined, 'append');

          if (!isNaN(index)) {
              _form.find('#filter_row_new').attr('id','filter_row_'+ index);
          }

          var row = _form.find('#filter_row_'+ index),
              field = row.find('select[name="field"]'),
              opera = row.find('select[name="opera"]'),
              value = row.find('input[name="value"]');

          // enable chosen for filter row
          row.find('.chzn-select').chosen({ disable_search_threshold: 7 });

          setFilterRowInputs( spec, filterFields[spec.field] );

          if (!isNewRow) {
              enableRemoveFilterRow( row );
          }

          field.on('change', function(){
              spec.field = field.val();
              setFilterRowInputs( spec, filterFields[spec.field] );
          });

          function setFilterRowInputs(spec,fieldDef) {

              //set the field
              if (spec.field!=='') {
                field.val(spec.field);
              }
              field.trigger("liszt:updated");

              //set the operations
              opera.find('option').remove();
              $('<option>').appendTo(opera).attr('value','');
              // $.each( fieldDef.opera.split(','), function(index,value){
              //     opera.append('<option value="'+ value +'">'+ value +'</option>');
              // });

              $.each( fieldDef.opera.split(','), function(index,value){
                  $('<option>').appendTo(opera).attr('value', value).text(value);
              });
              //opera.css('display','inline-block');
              //set opera selected to spec value
              if (spec.opera!=='') {
                  opera.val(spec.opera);
              } else if ( fieldDef.disabled==true && fieldDef.opera!=='' ) {
                  opera.val(fieldDef.opera);
              }
              if (spec.opera!=='' || fieldDef.opera!=='') {
                  row.find('#'+opera.attr('id')+'_chzn').show();
              } else {
                  row.find('#'+opera.attr('id')+'_chzn').hide();
              }
              //set opera enabled to field enabled
              if (fieldDef.disabled) {
                  opera.attr('disabled','disabled');
              } else {
                opera.removeAttr('disabled');
              }
              opera.trigger("liszt:updated");

              // hide text input if spect text is false
              value.css('display', (fieldDef.text?'inline-block':'none'));

              // set text input value if spec value is not empty
              value.val(spec.value);
          }
      }

      function enableRemoveFilterRow (filterRow) {
          filterRow.find('.addme').after(
            '<a href="#" class="removeme btn btn-invisible btn-dark"><i class="icon-minus"></i></a>'
          );
      }

      function enableSaveFilterButton () {
          _header.find('a[href="#save"]').toggleClass( 'disabled', _header.find('input[name="filter"]').val()==='' );
      }

      function createFieldRowChoice (filterRow,choices) {
          var id = 'search_filter_chzn_f_'+ parseInt(filterRow.attr('id').substr(11),10),
              field = filterRow.find('select[name="field"] option:selected').text(),
              opera = filterRow.find('select[name="opera"]').val(),
              html = filterRow.find('input[name="value"]').val(),
              index = 99;

          if (html ==='') {
              html = opera;
          }

          if (_choices.find('#'+id).length ) {
              _choices.find('#'+id).find('a').text(html);
              return false;
          } else {
              $('#{{sourceid}} #search_filter_chzn .search-field').before(
                  searchChoiceConstructor(id, {html:html,array_index:index,classes:'search-choice-field'}, field )
              );
              return true;
          }
      }

      function searchChoiceConstructor (id,item,type) {
          if (typeof type==='undefined') {
            type = item.classes.indexOf('filter-disabled')!==-1 ? 'Module' : 'Filter';
          }
          return item.classes.indexOf('filter-new')===-1 ? '<li class="search-choice search-choice-option '+ item.classes +'" id="'+ id +'"><span>'+ type +'</span><a href="javascript:void(0)" rel="'+ item.array_index +'">'+ item.html +'</a></li>' : '';
      }
  });

</script>
