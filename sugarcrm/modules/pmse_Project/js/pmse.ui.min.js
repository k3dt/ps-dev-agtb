var UITools={index:0,getIndex:function(){return this.index+=1}},getRelativePosition=function(a,b){var c=$(a).offset(),d=$(b).get(0)instanceof Document?{top:0,left:0}:$(b).offset();return{top:c.top-d.top,left:c.left-d.left}};function isHTMLElement(a){try{return a instanceof HTMLElement}catch(b){return"object"===typeof a&&1===a.nodeType&&"object"===typeof a.style&&"object"===typeof a.ownerDocument}}function isInDOM(a){return jQuery(a).parents("body:last").get(0)===document.body}
function cloneObject(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var Style=function(a){this.belongsTo=this.cssClasses=this.cssProperties=null;Style.prototype.initObject.call(this,a)};Style.prototype.type="Style";Style.MAX_ZINDEX=100;Style.prototype.initObject=function(a){var b={cssClasses:[],cssProperties:{},belongsTo:null};$.extend(!0,b,a);this.cssClasses=b.cssClasses;this.cssProperties=b.cssProperties;this.belongsTo=b.belongsTo};
Style.prototype.applyStyle=function(){if(!this.belongsTo.html)throw Error("applyStyle(): can't apply style to an object with no html");var a,b;$(this.belongsTo.html).css(this.cssProperties);for(a=0;a<this.cssClasses.length;a+=1)b=this.cssClasses[a],$(this.belongsTo.html).hasClass(b)||$(this.belongsTo.html).addClass(b);return this};Style.prototype.addProperties=function(a){$.extend(!0,this.cssProperties,a);$(this.belongsTo.html).css(a);return this};
Style.prototype.getProperty=function(a){return this.cssProperties[a]||$(this.belongsTo.html).css(a)||window.getComputedStyle(this.belongsTo.html,null).getPropertyValue(a)};Style.prototype.removeProperties=function(a){var b,c;for(c=0;c<a.length;c+=1)b=a[c],this.cssProperties.hasOwnProperty(b)&&($(this.belongsTo.html).css(b,""),delete this.cssProperties[b]);return this};
Style.prototype.addClasses=function(a){var b,c;if(a&&a instanceof Array)for(b=0;b<a.length;b+=1)if(c=a[b],"string"===typeof c)-1===this.cssClasses.indexOf(c)&&(this.cssClasses.push(c),$(this.belongsTo.html).addClass(c));else throw Error("addClasses(): array element is not of type string");else throw Error("addClasses(): parameter must be of type Array");return this};
Style.prototype.removeClasses=function(a){var b,c;if(a&&a instanceof Array)for(b=0;b<a.length;b+=1)if(c=a[b],"string"===typeof c)c=this.cssClasses.indexOf(c),-1!==c&&($(this.belongsTo.html).removeClass(this.cssClasses[c]),this.cssClasses.splice(c,1));else throw Error("removeClasses(): array element is not of type string");else throw Error("removeClasses(): parameter must be of type Array");return this};
Style.prototype.removeAllClasses=function(){this.cssClasses=[];$(this.belongsTo.html).removeClass();return this};Style.prototype.containsClass=function(a){return-1!==this.cssClasses.indexOf(a)};Style.prototype.getClasses=function(){return this.cssClasses};Style.prototype.stringify=function(){return{cssClasses:this.cssClasses}};
var ArrayList=function(){var a=[],b=0,c,d;return{id:Math.random(),get:function(b){return a[b]},insert:function(c){a[b]=c;b+=1;return this},insertAt:function(c,d){a.splice(d,0,c);b=a.length;return this},remove:function(d){c=this.indexOf(d);if(-1===c)return!1;b-=1;a.splice(c,1);return!0},getSize:function(){return b},isEmpty:function(){return 0===b},indexOf:function(c){for(d=0;d<b;d+=1)if(c.id===a[d].id)return d;return-1},find:function(b,c){var d,g;for(d=0;d<a.length;d+=1)if(g=a[d],g[b]===c)return g},
contains:function(a){return-1!==this.indexOf(a)?!0:!1},sort:function(b){var c=!1;b&&(a.sort(b),c=!0);return c},asArray:function(){return a},getFirst:function(){return a[0]},getLast:function(){return a[b-1]},popLast:function(){var c;b-=1;c=a[b];a.splice(b,1);return c},getDimensionLimit:function(){var c=[1E5,-1,-1,1E5];for(d=0;d<b;d+=1)c[0]>a[d].y&&(c[0]=a[d].y),c[1]<a[d].x+a[d].width&&(c[1]=a[d].x+a[d].width),c[2]<a[d].y+a[d].height&&(c[2]=a[d].y+a[d].height),c[3]>a[d].x&&(c[3]=a[d].x);return c},clear:function(){0!==
b&&(a=[],b=0);return this},getCanvas:function(){return 0<this.getSize()?this.get(0).getCanvas():void 0}}};"undefined"!==typeof exports&&(module.exports=ArrayList);var Base=function(a){var b={id:a&&a.id||"base-ui-"+UITools.getIndex()};$.extend(!0,b,a);this.id=b.id};Base.prototype.setId=function(a){this.id=a;return this};Base.prototype.type="Core";Base.prototype.family="Core";Base.prototype.getType=function(){return this.type};Base.prototype.getFamily=function(){return this.family};
Base.prototype.dispose=function(){for(var a in this)this[a]=null};"undefined"!==typeof exports&&(module.exports=Base);var Modal=function(a){Base.call(this,a);this.visible=null;this.loaded=!1;this.clickHander=this.html=null;Modal.prototype.initObject.call(this,a)};Modal.prototype=new Base;Modal.prototype.type="Modal";Modal.prototype.initObject=function(a){var b={visible:!1,clickHander:function(){}};$.extend(!0,b,a);this.setVisible(b.visible).setClickHandler(b.clickHander)};
Modal.prototype.setVisible=function(a){this.visible=a;return this};Modal.prototype.setClickHandler=function(a){this.clickHander=a;return this};Modal.prototype.show=function(){var a;this.html||(a=document.createElement("div"),a.className="adam-modal",a.id=this.id,this.html=a);document.body.appendChild(this.html);this.setVisible(!0);this.loaded||(this.attachListeners(),this.loaded=!0)};Modal.prototype.hide=function(){this.visible&&(document.body.removeChild(this.html),this.setVisible(!1))};
Modal.prototype.attachListeners=function(){var a=this;this.html&&$(this.html).click(function(b){b.stopPropagation();a.clickHander&&a.clickHander()}).mouseover(function(a){a.stopPropagation()}).mouseout(function(a){a.stopPropagation()}).mouseup(function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()})};var Proxy=function(a){Base.call(this,a);this.callback=this.url=null;Proxy.prototype.initObject.call(this,a)};Proxy.prototype=new Base;Proxy.prototype.type="Proxy";
Proxy.prototype.family="Proxy";Proxy.prototype.initObject=function(a){var b={url:null,callback:null};$.extend(!0,b,a);this.setUrl(b.url).setCallback(b.callback)};Proxy.prototype.setUrl=function(a){this.url=a;return this};Proxy.prototype.setCallback=function(a){this.callback=a;return this};Proxy.prototype.getData=function(){};Proxy.prototype.sendData=function(a,b){};
var Element=function(a){Base.call(this,a);this.zOrder=this.visible=this.style=this.html=this.height=this.width=this.y=this.x=null;Element.prototype.initObject.call(this,a)};Element.prototype=new Base;Element.prototype.type="Base";Element.prototype.family="Base";
Element.prototype.initObject=function(a){var b={style:{cssProperties:{},cssClasses:[]},width:0,height:0,x:0,y:0,zOrder:1,visible:!0};$.extend(!0,b,a);this.setStyle(new Style({belongsTo:this,cssProperties:b.style.cssProperties,cssClasses:b.style.cssClasses})).setDimension(b.width,b.height).setPosition(b.x,b.y).setZOrder(b.zOrder).setVisible(b.visible)};Element.prototype.setId=function(a){this.id=a;this.html&&(this.html.id=this.id);return this};
Element.prototype.setX=function(a){if("number"===typeof a)this.x=a,this.html&&this.style.addProperties({left:this.x});else throw Error("setX: x param is not a number");return this};Element.prototype.setY=function(a){if("number"===typeof a)this.y=a,this.html&&this.style.addProperties({top:this.y});else throw Error("setY: y param is not a number");return this};
Element.prototype.setWidth=function(a){if("number"===typeof a)this.width=a,this.html&&this.style.addProperties({width:this.width});else throw Error("setWidth: w is not a number");return this};Element.prototype.setHeight=function(a){if("number"===typeof a)this.height=a,this.html&&this.style.addProperties({height:this.height});else throw Error("setHeight: h is not a number");return this};Element.prototype.setPosition=function(a,b){this.setX(a);this.setY(b);return this};
Element.prototype.setDimension=function(a,b){this.setWidth(a);this.setHeight(b);return this};Element.prototype.setZOrder=function(a){"number"===typeof a&&0<a&&(this.zOrder=a,this.html&&this.style.addProperties({zIndex:this.zOrder}));return this};Element.prototype.setVisible=function(a){_.isBoolean(a)&&(this.visible=a,this.html&&(a?this.style.addProperties({display:"inline"}):this.style.addProperties({display:"none"})));return this};
Element.prototype.setStyle=function(a){a instanceof Style&&(this.style=a);return this};Element.prototype.createHTMLElement=function(a){return document.createElement(a)};Element.prototype.createHTML=function(){this.html||(this.html=this.createHTMLElement("div"),this.html.id=this.id,this.style.applyStyle(),this.style.addProperties({position:"absolute",left:this.x,top:this.y,width:this.width,height:this.height,zIndex:this.zOrder}));return this.html};Element.prototype.paint=function(){};
Element.prototype.getHTML=function(){this.html||this.createHTML();return this.html};Element.prototype.calculateWidth=function(a,b){var c=b||"12px arial",d=$(this.createHTMLElement("div"));d.text(a).css({position:"absolute","float":"left","white-space":"nowrap",visibility:"hidden",font:c}).appendTo($("body"));c=d.width();d.remove();return c};var Container=function(a){Element.call(this,a);this.items=[];this.bodyHeight=this.body=null;Container.prototype.initObject.call(this,a)};Container.prototype=new Element;
Container.prototype.type="Container";Container.prototype.family="Container";Container.prototype.initObject=function(a){var b={items:[],body:null};$.extend(!0,b,a);this.setItems(b.items).setBody(b.body).setBodyHeight(b.bodyHeight)};Container.prototype.setItems=function(a){this.items=a;return this};
Container.prototype.setBodyHeight=function(a){this.bodyHeight=a;this.body&&("number"===typeof a?this.body.style.height=a+"px":(this.bodyHeight=null,this.body.style.height=""),this.height=$(this.html).height());return this};Container.prototype.setBody=function(a){this.body=a;return this};Container.prototype.getBody=function(){return this.body};
Container.prototype.createHTML=function(){var a;Element.prototype.createHTML.call(this);a=this.createHTMLElement("div");a.className="j-container";this.html.appendChild(a);this.body=a;this.setBodyHeight(this.bodyHeight);return this.html};
var Window=function(a){Container.call(this,a);this.titleLabelObject=this.closeButtonObject=this.windowHeader=this.modalObject=this.modal=this.title=null;this.loaded=!1;this.closeButton=this.modalHandler=this.destroyOnHide=null;this.panels=[];this.selectedTab=this.tabsContainer=this.modalContainer=null;Window.prototype.initObject.call(this,a)};Window.prototype=new Container;Window.prototype.type="Window";
Window.prototype.initObject=function(a){var b={title:"No Title",modal:!0,modalHandler:null,destroyOnHide:!1,closeButton:!0,panels:[]};$.extend(!0,b,a);this.setTitle(b.title).setModalHandler(b.modalHandler).setModal(b.modal).setVisible(!1).setCloseButton(b.closeButton).setDestroyOnHide(b.destroyOnHide).setPanels(b.panels);this.modalContainer=$("body")};Window.prototype.setTitle=function(a){this.title=a;this.titleLabelObject&&(this.titleLabelObject.innerHTML=a);return this};
Window.prototype.setModalHandler=function(a){this.modalHandler=a;return this};Window.prototype.setModal=function(a){this.modalObject=a?new Modal({clickHandler:this.modalHandler}):null;this.modal=a;return this};Window.prototype.setDestroyOnHide=function(a){this.destroyOnHide=a;return this};Window.prototype.setCloseButton=function(a){this.closeButton=a;return this};
Window.prototype.onTabSelectedHandler=function(){var a=this;return function(){var b;this!==a.selectedTab&&($(a.selectedTab.unselect().getContent().getHTML()).detach(),a.selectedTab=this.select(),b=a.selectedTab.getContent(),b.setHeight($(a.body).innerHeight()),a.body.appendChild(b.getHTML()),"function"===typeof b.load&&b.load())}};
Window.prototype.clearPanels=function(){var a;for(a=0;a<this.panels.length;a+=1)$(this.panels[a].getTab()).remove(),$(this.panels[a].getContent().getHTML()).remove();this.panels=[];return this};Window.prototype.setPanels=function(a){var b;if(!(a.hasOwnProperty("length")&&"function"===typeof a.push))return this;this.clearPanels();for(b=0;b<a.length;b+=1)this.addPanel(a[b]);return this};
Window.prototype.addPanel=function(a){var b=a.panel;if(!(a instanceof TabPanelElement))if(a instanceof Panel)b=a,a=new TabPanelElement({content:a});else if(b instanceof Panel)a=new TabPanelElement({title:a.title,content:b});else return this;a.onClick=this.onTabSelectedHandler();a.setParent(this);this.panels.push(a);1===this.panels.length&&(this.selectedTab=a);this.loaded&&(this.tabsContainer.appendChild(a.getTab()),1===this.panels.length&&this.body.appendChild(b.getHTML()));b.setParent(this);return this};
Window.prototype.getPanel=function(a){return this.panels[a]};Window.prototype.getPanels=function(){return this.panels};
Window.prototype.createHTML=function(){var a,b,c,d;Container.prototype.createHTML.call(this);a="-"+parseInt(this.height/2,10)+"px 0 0 -"+parseInt(this.width/2,10)+"px";this.style.addClasses(["adam-window"]);this.style.addProperties({"z-index":1033,left:"50%",top:"50%",margin:a});this.height-=16;this.html.style.height=this.height+"px";c=this.createHTMLElement("div");c.className="adam-window-header";a=this.createHTMLElement("label");a.className="adam-window-title";a.innerHTML=this.title||"&nbsp;";a.title=
a.innerHTML;this.closeButton?(b=this.createHTMLElement("span"),b.className="adam-window-close",c.appendChild(b),this.html.insertBefore(c,this.body),this.closeButtonObject=b):this.html.insertBefore(c,this.body);c.appendChild(a);b=this.createHTMLElement("ul");b.className="adam-tabs";this.html.insertBefore(b,this.body);this.tabsContainer=b;for(d=0;d<this.panels.length;d+=1)b.appendChild(this.panels[d].getTab());1>=d&&(b.style.display="none");this.windowHeader=c;this.titleLabelObject=a;this.body&&(this.body.className=
"adam-window-body",this.body.style.height=this.height-22-(1<d?22:0)+"px");return this.html};Window.prototype.show=function(){var a;this.loaded||this.load();this.modal&&this.modalObject.show();this.selectedTab&&(this.selectedTab.select(),a=this.selectedTab.getContent(),a.setHeight($(this.body).innerHeight()),this.body.appendChild(a.getHTML()),a.load());document.body.appendChild(this.html);this.setVisible(!0)};
Window.prototype.load=function(){this.html||(this.createHTML(),this.attachListeners(),this.loaded=!0)};Window.prototype.close=function(){this.visible&&this.hide();this.dispose&&this.dispose()};Window.prototype.hide=function(a){this.modal&&this.modalObject.hide();document.body.removeChild(this.html);this.setVisible(!1);(a||this.destroyOnHide)&&this.close()};
Window.prototype.attachListeners=function(){var a=this;$(this.html).draggable({cursor:"move",scroll:!1,containment:"document"}).on("keydown keyup keypress",function(a){a.stopPropagation()});this.closeButton&&this.closeButtonObject&&$(this.closeButtonObject).click(function(b){b.stopPropagation();a.hide()})};var TabPanelElement=function(a){Base.call(this,a);this.selected=this.onClick=this.parent=this.content=this.tab=this.title=null;TabPanelElement.prototype.initObject.call(this,a)};
TabPanelElement.prototype.initObject=function(a){var b={title:null,content:null,parent:null,onClick:null};$.extend(!0,b,a);this.onClick=b.onClick;this.setTitle(b.title).setContent(b.content).setParent(b.parent)};TabPanelElement.prototype.setTitle=function(a){this.title=a;return this};TabPanelElement.prototype.getTitle=function(){return this.title};TabPanelElement.prototype.setContent=function(a){a instanceof Panel&&(this.content=a);return this};TabPanelElement.prototype.getContent=function(){return this.content};
TabPanelElement.prototype.setParent=function(a){this.parent=a;return this};TabPanelElement.prototype.getParent=function(){return this.parent};TabPanelElement.prototype.attachListeners=function(){var a=this;$(this.tab).on("click","a",function(a){a.preventDefault()}).on("click",function(){"function"===typeof a.onClick&&a.onClick.call(a)}).on("keydown",function(a){a.stopPropagation()});return this};
TabPanelElement.prototype.createTab=function(){var a,b;if(this.tab)return this.tab;a=document.createElement("li");a.id=this.id;a.className="adam-tab";b=document.createElement("a");b.href="#";this.title?b.appendChild(document.createTextNode(this.title)):b.innerHTML="&nbsp;";a.appendChild(b);this.tab=a;this.attachListeners();return this.tab};TabPanelElement.prototype.getTab=function(){this.tab||(this.createTab(),this.selected?this.select():this.unselect());return this.tab};
TabPanelElement.prototype.isSelected=function(){return this.selected};TabPanelElement.prototype.select=function(){this.selected=!0;this.tab&&$(this.tab).addClass("active");return this};TabPanelElement.prototype.unselect=function(){this.selected=!1;this.tab&&$(this.tab).removeClass("active");return this};var Action=function(a){Base.call(this,a);this.related=this.cssStyle=this.handler=this.hidden=this.disabled=this.text=null;Action.prototype.initObject.call(this,a)};Action.prototype=new Base;
Action.prototype.type="Action";Action.prototype.family="Action";Action.prototype.initObject=function(a){var b={text:null,cssStyle:null,disabled:!1,hidden:!1,handler:function(){},related:null};$.extend(!0,b,a);this.setText(b.text).setCssClass(b.cssStyle).setDisabled(b.disabled).setHidden(b.hidden).setHandler(b.handler).setRelated(b.related)};Action.prototype.setText=function(a){this.text=a;return this};Action.prototype.setHandler=function(a){_.isFunction(a)&&(this.handler=a);return this};
Action.prototype.setCssClass=function(a){this.cssStyle=a;return this};Action.prototype.setDisabled=function(a){_.isBoolean(a)&&(this.disabled=a,this.related&&_.isFunction(this.related.paint)&&this.related.paint());return this};Action.prototype.setHidden=function(a){_.isBoolean(a)&&(this.hidden=a,this.related&&_.isFunction(this.related.paint)&&this.related.paint());return this};Action.prototype.setRelated=function(a){this.related=a;return this};Action.prototype.enable=function(){this.setDisabled(!1)};
Action.prototype.disable=function(){this.setDisabled(!0)};Action.prototype.hide=function(){this.setHidden(!0)};Action.prototype.show=function(){this.setHidden(!1)};Action.prototype.isEnabled=function(){return!this.disabled};Action.prototype.isHidden=function(){return this.hidden};Action.prototype.isAction=!0;
var Menu=function(a){Container.call(this,a);this.items=[];this.currentItem=this.visible=this.canvas=this.parent=this.toolTip=this.state=this.name=null;this.loaded=!1;Menu.prototype.initObject.call(this,a)};Menu.prototype=new Container;Menu.prototype.type="Menu";Menu.prototype.family="Menu";Menu.prototype.initObject=function(a){var b={parent:null,items:[],name:null,state:null,toolTip:null,parentMenu:null,canvas:null,visible:!1,currentItem:null};$.extend(!0,b,a);this.setCanvas(b.canvas).setItems(b.items).setName(b.name).setState(b.state).setParent(b.parent).setToolTip(b.toolTip).setVisible(b.visible).setCurrentItem(b.currentItem)};
Menu.prototype.setItems=function(a){var b,c;for(c=0;c<a.length;c+=1){switch(a[c].jtype){case "separator":b=new SeparatorItem(a[c],this);break;case "checkbox":b=new CheckboxItem(a[c],this);break;default:b=new MenuItem(a[c],this)}this.items.push(b)}this.calculateDimension();return this};Menu.prototype.setName=function(a){this.name=a;return this};Menu.prototype.setState=function(a){this.state=a;return this};Menu.prototype.setToolTip=function(a){this.toolTip=a;return this};
Menu.prototype.setParent=function(a){"object"===typeof a&&(this.parent=a);return this};Menu.prototype.setCanvas=function(a){this.canvas=a;return this};Menu.prototype.setVisible=function(a){this.visible=a;return this};Menu.prototype.setCurrentItem=function(a){this.currentItem&&this.currentItem.hasMenuActive&&(this.currentItem.setFocused(!1),this.currentItem.setHasMenuActive(!1),this.currentItem.setActiveItem(!1),this.currentItem.setActiveMenu(!1));this.currentItem=a;return this};
Menu.prototype.createHTML=function(){Element.prototype.createHTML.call(this);this.style.addClasses(["adam-menu"]);this.setZOrder(1E3);this.generateMenu();return this.html};Menu.prototype.generateMenu=function(){var a,b;b=this.createHTMLElement("ul");b.className="adam-list";for(a=0;a<this.items.length;a+=1)b.appendChild(this.items[a].getHTML());this.html.appendChild(b);return this};Menu.prototype.paint=function(){};
Menu.prototype.show=function(a,b){this.canvas&&(this.loaded||(this.setPosition(a,b),this.calculateItemCoords()),this.canvas.html.appendChild(this.getHTML()),this.loaded||(this.attachListeners(),this.loaded=!0),this.setVisible(!0),"AdamCanvas"===this.parent.type?this.parent.setCurrentMenu(this):"MenuItem"!==this.parent.type&&this.parent.canvas.setCurrentMenu(this))};
Menu.prototype.calculateDimension=function(){var a,b,c,d;b=4;for(c=a=0;c<this.items.length;c+=1){switch(this.items[c].getType()){case "MenuItem":case "CheckboxItem":b+=24;break;case "SeparatorItem":b+=4}d=this.items[c].label||"";""!==d&&(d=this.calculateWidth(d),d>a&&(a=d))}this.setDimension(71+a,b);return this};Menu.prototype.attachListeners=function(){var a;for(a=0;a<this.items.length;a+=1)this.items[a].attachListeners();return this};
Menu.prototype.hide=function(){var a;if(this.canvas&&this.visible){for(a=0;a<this.items.length;a+=1)this.items[a].menu&&this.items[a].menu.hide();this.canvas.html.removeChild(this.getHTML());this.setVisible(!1);"AdamCanvas"===this.parent.type&&this.parent.setCurrentMenu(null)}};
Menu.prototype.calculateItemCoords=function(){var a,b,c;b=2;for(c=0;c<this.items.length;c+=1)switch(this.items[c].getType()){case "CheckboxItem":case "MenuItem":this.items[c].setPosition(this.x,this.y+b);this.items[c].setDimension(this.width-2,24);a=24;b+=a;break;default:this.items[c].setPosition(this.x,b),this.items[c].setDimension(this.width-2,4),a=4,b+=a}};
var Item=function(a,b){Element.call(this,a);this.icon=this.focused=this.disabled=this.toolTip=this.menu=this.parentMenu=this.action=this.label=null;Item.prototype.initObject.call(this,a,b)};Item.prototype=new Element;Item.prototype.type="Item";Item.prototype.family="Item";
Item.prototype.initObject=function(a,b){var c={label:null,menu:null,toolTip:null,parentMenu:b||null,disabled:!1,focused:!1,icon:"adam-menu-icon-empty"};a&&a.isAction?this.loadAction(a,b):($.extend(!0,c,a),this.setLabel(c.label).setToolTip(c.toolTip).setParentMenu(c.parentMenu).setDisabled(c.disabled).setIcon(c.icon).setFocused(c.focused),c.action||(this.action=new Action({text:c.label,cssStyle:c.icon,handler:c.handler})),c.menu&&this.setChildMenu(c.menu))};
Item.prototype.loadAction=function(a,b){this.action=a;this.setLabel(this.action.text);this.setIcon(this.action.cssStyle);this.setDisabled(this.action.disabled);this.setParentMenu(b);this.setFocused(!1);a.menu&&this.setChildMenu(a.menu)};Item.prototype.setLabel=function(a){this.label=a;this.action&&this.action.setText(a);return this};Item.prototype.setIcon=function(a){this.icon=a;this.action&&this.action.setCssClass(a);return this};Item.prototype.paint=function(){};
Item.prototype.setParentMenu=function(a){this.parentMenu=a;return this};Item.prototype.setChildMenu=function(a){a instanceof Menu?(a.setCanvas(this.parentMenu.canvas),a.setParent(this),this.menu=a):(a.canvas=this.parentMenu.canvas,a.parent=this,this.menu=new Menu(a));return this};Item.prototype.setDisabled=function(a){this.disabled=a;return this};Item.prototype.setFocused=function(a){this.focused=a;return this};Item.prototype.setToolTip=function(a){this.toolTip=a;return this};
Item.prototype.createHTML=function(){var a;a=this.createHTMLElement("li");a.className="adam-item";this.disabled&&(a.className+=" adam-disabled");a.id=UITools.getIndex();return this.html=a};Item.prototype.attachListeners=function(){};Item.prototype.closeMenu=function(){this.parentMenu&&(this.parentMenu.canvas&&this.parentMenu.canvas.currentMenu)&&this.parentMenu.canvas.currentMenu.hide()};
var CheckboxItem=function(a,b){Item.call(this,a,b);this.itemAnchor=this.checked=null;CheckboxItem.prototype.initObject.call(this,a)};CheckboxItem.prototype=new Item;CheckboxItem.prototype.type="CheckboxItem";CheckboxItem.prototype.initObject=function(a){var b={checked:!1};$.extend(!0,b,a);this.setChecked(b.checked)};CheckboxItem.prototype.setChecked=function(a){_.isBoolean(a)&&(this.checked=a);return this};
CheckboxItem.prototype.createHTML=function(){var a,b;Item.prototype.createHTML.call(this);this.itemAnchor=this.createHTMLElement("a");this.itemAnchor.href="#";a=this.createHTMLElement("span");a.innerHTML=this.label;a.className="adam-label";b=this.createHTMLElement("span");b.className=this.checked?"adam-check-checked":"adam-check-unchecked";this.itemAnchor.appendChild(b);this.itemAnchor.appendChild(a);this.html.appendChild(this.itemAnchor);return this.html};
CheckboxItem.prototype.attachListeners=function(){var a=this;this.html&&$(this.itemAnchor).click(function(b){b.stopPropagation();a.disabled||(a.closeMenu(),a.action.handler(!a.checked))}).mouseover(function(){a.setActiveItem(!0)}).mouseout(function(){a.setActiveItem(!1)}).mouseup(function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()})};
CheckboxItem.prototype.setActiveItem=function(a){this.disabled||(a?(this.style.addClasses(["adam-item-active"]),this.style.applyStyle(),this.parentMenu.setCurrentItem(this)):(this.style.removeClasses(["adam-item-active"]),this.style.applyStyle()))};var SeparatorItem=function(a,b){Item.call(this,a,b)};SeparatorItem.prototype=new Item;SeparatorItem.prototype.type="SeparatorItem";
SeparatorItem.prototype.createHTML=function(){var a,b;b=this.createHTMLElement("li");b.className="adam-item-separator";a=this.createHTMLElement("span");a.className="adam-separator";a.innerHTML=" ";b.appendChild(a);return this.html=b};var MenuItem=function(a,b){Item.call(this,a,b);this.hasMenuActive=this.itemAnchor=null;MenuItem.prototype.initObject.call(this,a)};MenuItem.prototype=new Item;MenuItem.prototype.type="MenuItem";
MenuItem.prototype.initObject=function(a){var b={hasMenuActive:!1};$.extend(!0,b,a);this.setHasMenuActive(b.hasMenuActive)};MenuItem.prototype.setHasMenuActive=function(a){this.hasMenuActive=a;return this};
MenuItem.prototype.createHTML=function(){var a,b;Item.prototype.createHTML.call(this);this.itemAnchor=this.createHTMLElement("a");this.itemAnchor.href="#";this.menu&&(this.itemAnchor.className="adam-item-arrow");a=this.createHTMLElement("span");a.innerHTML=this.label;a.className="adam-label";b=this.createHTMLElement("span");b.className="adam-item-icon "+this.icon;this.itemAnchor.appendChild(b);this.itemAnchor.appendChild(a);this.html.appendChild(this.itemAnchor);return this.html};
MenuItem.prototype.attachListeners=function(){var a=this;this.html&&$(this.itemAnchor).click(function(b){b.stopPropagation();!a.menu&&!a.disabled&&(a.closeMenu(),a.action.handler());b.preventDefault()}).mouseover(function(){a.setActiveItem(!0);a.setActiveMenu(!0)}).mouseout(function(){a.setActiveItem(!1);a.setActiveMenu(!1)}).mouseup(function(a){a.stopPropagation()}).mousedown(function(a){a.stopPropagation()})};
MenuItem.prototype.setActiveItem=function(a){this.disabled||(a?this.focused||(this.style.addClasses(["adam-item-active"]),this.style.applyStyle(),this.parentMenu.setCurrentItem(this)):this.hasMenuActive||(this.style.removeClasses(["adam-item-active"]),this.style.applyStyle(),this.setFocused(!1)))};MenuItem.prototype.setActiveMenu=function(a){this.menu&&!this.disabled&&(a?this.focused||(this.menu.show(this.x+this.width,this.y),this.setHasMenuActive(!0),this.setFocused(!0)):this.hasMenuActive||this.menu.hide())};
var Layout=function(a){Base.call(this,a);Layout.prototype.initObject.call(this,a)};Layout.prototype=new Base;Layout.prototype.type="Layout";Layout.prototype.family="Layout";Layout.prototype.initObject=function(a){};var Tooltip=function(a,b){Element.call(this,a);this.hoverClass=this.hoverParent=this.messageObject=this.parent=this.message=this.css=this.icon=null;Tooltip.prototype.initObject.call(this,a,b)};Tooltip.prototype=new Element;Tooltip.prototype.type="Tooltip";Tooltip.prototype.family="Tooltip";
Tooltip.prototype.initObject=function(a,b){var c={message:null,icon:"adam-tooltip-icon-default",css:"",parent:b||null,hoverParent:!0,hoverClass:"hovered"};$.extend(!0,c,a);this.setIcon(c.icon).setMessage(c.message).setParent(c.parent).setCss(c.css).setHoverClass(c.hoverClass).setHoverParent(c.hoverParent)};Tooltip.prototype.setIcon=function(a){this.icon=a;return this};Tooltip.prototype.setMessage=function(a){this.message=a;return this};Tooltip.prototype.setParent=function(a){this.parent=a;return this};
Tooltip.prototype.setCss=function(a){this.css=a;return this};Tooltip.prototype.setHoverParent=function(a){this.hoverParent=a;return this};Tooltip.prototype.setHoverClass=function(a){this.hoverClass=a;return this};Tooltip.prototype.createHTML=function(){var a,b;b=this.createHTMLElement("a");b.href="#";b.className="adam-tooltip "+this.css;a=this.createHTMLElement("span");a.className=this.icon;b.appendChild(a);this.html=b;this.attachListeners();return this.html};
Tooltip.prototype.attachListeners=function(){var a=this;$(this.html).click(function(a){a.preventDefault()}).mouseover(function(b){b.stopPropagation();a.show(b.pageX,b.pageY)}).mouseout(function(b){b.stopPropagation();a.hide()})};
Tooltip.prototype.show=function(a,b){var c;this.messageObject||(c=this.createHTMLElement("div"),c.className="adam-tooltip-message",c.innerHTML=this.message,c.style.position="absolute",c.style.top=b+10+"px",c.style.left=a+10+"px",c.style.zIndex=1034,this.messageObject=c);document.body.appendChild(this.messageObject);this.hoverParent&&this.parent&&$(this.parent.html).addClass(this.hoverClass)};
Tooltip.prototype.hide=function(){document.body.removeChild(this.messageObject);this.messageObject=null;this.hoverParent&&this.parent&&$(this.parent.html).removeClass(this.hoverClass)};var Panel=function(a){Container.call(this,a);this.layout=this.footer=this.header=null;this.language={};Panel.prototype.initObject.call(this,a)};Panel.prototype=new Container;Panel.prototype.type="Panel";Panel.prototype.family="Panel";Panel.prototype.initObject=function(a){var b={layout:null};$.extend(!0,b,a);this.setHeader(b.header).setFooter(b.footer).setLayout(b.layout)};
Panel.prototype.setHeader=function(a){this.header=a;return this};Panel.prototype.setFooter=function(a){this.footer=a;return this};Panel.prototype.setLayout=function(a){this.layout=a&&a.family&&"Layout"===a.family?a:new Layout(a);return this};
Panel.prototype.createHTML=function(){var a;Container.prototype.createHTML.call(this);this.style.removeProperties("width height position top left z-index".split(" "));this.style.addClasses(["adam-panel"]);this.header?this.html.insertBefore(this.header,this.body):(a=this.createHTMLElement("div"),a.className="adam-panel-header",this.html.insertBefore(a,this.body),this.header=a);this.footer?this.html.appendChild(this.footer):(a=this.createHTMLElement("div"),a.className="adam-panel-footer",this.html.appendChild(a),
this.footer=a);this.body.className="adam-panel-body";return this.html};Panel.prototype.load=function(){};var Form=function(a){Panel.call(this,a);this.proxy=this.url=this.proxyEnabled=null;this.loaded=!1;this.data=null;this.callback={};this.dirty=!1;this.buttons=[];this.parent=this.closeContainerOnSubmit=this.headerHeight=this.footerHeight=this.labelWidth=this.footerAlign=null;Form.prototype.initObject.call(this,a)};Form.prototype=new Panel;Form.prototype.type="Form";
Form.prototype.initObject=function(a){var b={url:null,data:null,proxyEnabled:!0,callback:{},buttons:[],footerAlign:"center",labelWidth:"30%",footerHeight:40,headerHeight:0,closeContainerOnSubmit:!1,language:{ERROR_INVALID_EMAIL:"You must enter a valid email",ERROR_INVALID_INTEGER:"Please enter only integer values",ERROR_REQUIRED_FIELD:"This field is required",ERROR_COMPARISON:"The comparison failed",ERROR_REGEXP:"The pattern text didn't match with the specified one",ERROR_TEXT_LENGTH:"The text length must be",
ERROR_CHECKBOX_VALUES:"Please insert Checkbox values (0 or 1)",ERROR_TEXT:"Please insert text",ERROR_DATE:"Please insert only valid dates",ERROR_PHONE:"Please enter a valid Phone",ERROR_FLOAT:"Please enter only valid float values",ERROR_DECIMAL:"Please enter only valid decimal values",ERROR_URL:"Please enter only valid url",TITLE_BUSINESS_RULE_EVALUATION:"Business Rules Evaluation",LBL_BUSINESS:"Business",LBL_OPERATOR:"Operator",LBL_RESPONSE:"Response",LBL_LOGIC_OPERATORS:"Logic Operators",LBL_GROUP:"Group",
LBL_DIRECTION:"Direction",LBL_MODULE:"Module",LBL_FIELD:"Field",LBL_VALUE:"Value",LBL_TARGET_MODULE:"Target Module",LBL_VARIABLE:"Variable",LBL_USER:"User",TITLE_MODULE_FIELD_EVALUATION:"Module Field Evaluation",TITLE_FORM_RESPONSE_EVALUATION:"Form Response Evaluation",TITLE_USER_EVALUATION:"User Evaluation",LBL_FORM:"Form",LBL_STATUS:"Status",LBL_APPROVED:"Approved",LBL_REJECTED:"Rejected",BUTTON_SUBMIT:"Submit",BUTTON_CANCEL:"Cancel"}};$.extend(!0,b,a);this.language=b.language;this.setUrl(b.url).setData(b.data).setProxyEnabled(b.proxyEnabled).setProxy(b.proxy).setCallback(b.callback).setButtons(b.buttons).setLabelWidth(b.labelWidth).setFooterHeight(b.footerHeight).setHeaderHeight(b.headerHeight).setCloseContainerOnSubmit(b.closeContainerOnSubmit).setFooterAlign(b.footerAlign)};
Form.prototype.setUrl=function(a){this.url=a;return this};Form.prototype.setProxyEnabled=function(a){this.proxyEnabled=a;return this};Form.prototype.setProxy=function(a){a&&a.family&&"Proxy"===a.family?(this.proxy=a,this.url=a.url,this.proxyEnabled=!0):this.proxyEnabled&&(a?(a.url||(a.url=this.url),this.proxy=new Proxy(a)):this.url&&(this.proxy=new Proxy({url:this.url})));return this};Form.prototype.setData=function(a){this.data=a;this.loaded&&this.applyData();return this};
Form.prototype.setCallback=function(a){this.callback=a;return this};Form.prototype.setFooterAlign=function(a){this.footerAlign=a;return this};Form.prototype.setLabelWidth=function(a){this.labelWidth=a;return this};Form.prototype.setFooterHeight=function(a){this.footerHeight=a;return this};Form.prototype.setHeaderHeight=function(a){this.headerHeight=a;return this};
Form.prototype.setHeight=function(a){Panel.prototype.setHeight.call(this,a);this.setBodyHeight(this.height-this.footerHeight-this.headerHeight);return this};Form.prototype.setCloseContainerOnSubmit=function(a){this.closeContainerOnSubmit=a;return this};
Form.prototype.load=function(){var a=this,b=null;this.loaded||(this.proxy?(b=this.getRelatedFields(),this.proxy.getData(b,{success:function(b){a.data=b;a.applyData.call(a);a.loaded=!0;a.attachListeners();a.setDirty(!1)}})):(this.applyData.call(this),this.attachListeners(),this.loaded=!0))};Form.prototype.getRelatedFields=function(){var a=[];if(this.items)for(i=0;i<this.items.length;i+=1)this.items[i].related&&a.push(this.items[i].related);return 0<a.length?{related:a.join(",")}:null};
Form.prototype.reload=function(){this.loaded=!1;this.load()};
Form.prototype.applyData=function(a){var b,c,d;if(this.data){if(this.data.related)for(c=0;c<this.items.length;c+=1)"ComboboxField"===this.items[c].getType()&&this.items[c].related&&(d=this.items[c].related,this.data.related[d]&&this.items[c].setOptions(this.data.related[d]));for(b in this.data)if(this.data.hasOwnProperty(b))for(c=0;c<this.items.length;c+=1)if(this.items[c].name===b){try{this.items[c].setValue(this.data[b])}catch(e){}break}}this.callback&&(this.callback.loaded&&!a)&&this.callback.loaded.call(this,
this.data,null!==this.proxy)};
Form.prototype.addItem=function(a){var b;if(a&&a.family&&"Field"===a.family)b=a,b.setParent(this);else if($.extend(!0,a,{language:this.language}),a.jtype)switch(a.jtype){case "text":b=new TextField(a,this);break;case "combobox":b=new ComboboxField(a,this);break;case "textarea":b=new TextareaField(a,this);break;case "checkbox":b=new CheckboxField(a,this);break;case "hidden":b=new HiddenField(a,this);break;case "emailpicker":b=new EmailPickerField(a,this);break;case "itemmatrix":b=new ItemMatrixField(a,
this);break;case "multipleitem":b=new MultipleItemField(a,this);break;case "criteria":b=new CriteriaField(a,this);break;case "itemupdater":b=new ItemUpdaterField(a,this);break;case "radio":b=new RadiobuttonField(a,this)}b&&this.items.push(b)};Form.prototype.setItems=function(a){var b;for(b=0;b<a.length;b+=1)this.addItem(a[b]);return this};Form.prototype.setButtons=function(a){var b;for(b=0;b<a.length;b+=1)this.addButton(a[b]);return this};
Form.prototype.reset=function(){var a;for(a=0;a<this.items.length;a+=1)this.items[a].reset();this.setDirty(!1);this.callback.reset&&this.callback.reset()};Form.prototype.submit=function(){var a;this.testRequired()?this.validate()?(a=this.getData(),this.proxy?this.proxy.sendData(a,this.callback):this.callback.submit&&this.callback.submit(a),this.closeContainerOnSubmit&&this.parent&&this.parent.close&&this.parent.close()):this.callback.failed&&this.callback.failed():this.callback.required&&this.callback.required()};
Form.prototype.getData=function(){var a,b={};for(a=0;a<this.items.length;a+=1)$.extend(b,this.items[a].getObjectValue());return b};Form.prototype.setDirty=function(a){this.dirty=a;return this};Form.prototype.isDirty=function(){return this.dirty};
Form.prototype.validate=function(){var a,b=!0,c;for(a=0;a<this.items.length;a+=1)c=this.items[a].isValid(),b=b&&c,!c&&this.items[a].errorTooltip&&($(this.items[a].errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.items[a].errorTooltip.html).addClass("adam-tooltip-error-on"));return b};Form.prototype.testRequired=function(){var a,b=!0;for(a=0;a<this.items.length;a+=1)b=b&&this.items[a].evalRequired();return b};
Form.prototype.addButton=function(a){a&&a.family&&"Button"===a.family?a.setParent(this):a=new Button(a,this);a&&this.buttons.push(a)};Form.prototype.attachListeners=function(){var a;for(a=0;a<this.items.length;a+=1)this.items[a].attachListeners();for(a=0;a<this.buttons.length;a+=1)this.buttons[a].attachListeners();$(this.body).mousedown(function(a){a.stopPropagation()})};
Form.prototype.onEnterFieldHandler=function(a){var b=this;return function(){var c;for(c=0;c<b.items.length;c+=1)b.items[c]!==a&&(b.items[c]instanceof MultipleItemField||b.items[c]instanceof CriteriaField)&&b.items[c].closePanel()}};
Form.prototype.createHTML=function(){var a,b;Panel.prototype.createHTML.call(this);this.footer.style.textAlign=this.footerAlign;for(a=0;a<this.items.length;a+=1)b=this.items[a].getHTML(),$(b).find("select, input, textarea").focus(this.onEnterFieldHandler(this.items[a])),this.body.appendChild(b);for(a=0;a<this.buttons.length;a+=1)this.footer.appendChild(this.buttons[a].getHTML());this.body.style.bottom=this.footerHeight+8+"px";this.footer.style.height=this.footerHeight+"px";return this.html};
Form.prototype.setParent=function(a){this.parent=a;return this};var Field=function(a,b){Element.call(this,a);this.value=this.label=this.parent=null;this.validators=[];this.initialValue=this.messageError=this.required=this.name=null;this.requiredFailed=!1;this.oldRequiredValue=this.proxy=this.submit=this.readOnly=this.change=this.labelObject=this.controlObject=this.errorTooltip=this.helpTooltip=this.fieldWidth=null;Field.prototype.initObject.call(this,a,b)};Field.prototype=new Element;
Field.prototype.type="Field";Field.prototype.family="Field";Field.prototype.initObject=function(a,b){var c={required:!1,label:"",validators:[],value:null,messageError:null,initialValue:null,fieldWidth:null,helpTooltip:null,change:function(){},readOnly:!1,submit:!0,proxy:null};$.extend(!0,c,a);this.setParent(b);this.setRequired(c.required).setLabel(c.label).setName(c.name||this.type+"_"+this.id).setValidators(c.validators).setMessageError(c.messageError).setInitialValue(c.initialValue).setFieldWidth(c.fieldWidth).setHelpTooltip(c.helpTooltip).setErrorTooltip({}).setChangeHandler(c.change).setReadOnly(c.readOnly).setSubmit(c.submit).setProxy(c.proxy).setValue(c.value)};
Field.prototype.setRequired=function(a){this.required=a;return this};Field.prototype._setValueToControl=function(a){this.html&&this.controlObject&&(this.controlObject.value=this.value);return this};Field.prototype.setValue=function(a,b){this.value=b?a:a||this.initialValue;this._setValueToControl(this.value);this.proxy&&this.load();return this};Field.prototype.setName=function(a){this.name=a;return this};Field.prototype.setLabel=function(a){this.label=a;return this};
Field.prototype.setValidators=function(a){var b;for(b=0;b<a.length;b+=1)a[b]&&a[b].family&&"Validator"===a[b].family?this.validators.push(a[b]):this.validators.push(this.validatorFactory(a[b]));return this};Field.prototype.setMessageError=function(a){this.messageError=a;return this};Field.prototype.setParent=function(a){this.parent=a;return this};Field.prototype.setInitialValue=function(a){this.initialValue=a;return this};Field.prototype.setFieldWidth=function(a){this.fieldWidth=a;return this};
Field.prototype.setHelpTooltip=function(a){a?(a.css||(a.css="adam-tooltip-help"),this.helpTooltip=new Tooltip(a,this)):this.helpTooltip=null;return this};Field.prototype.setErrorTooltip=function(a){a?(a.css||(a.css="adam-tooltip-error-off"),a.icon||(a.icon="adam-tooltip-icon-error"),a.visible=!1,this.errorTooltip=new Tooltip(a,this)):this.errorTooltip=null;return this};Field.prototype.setChangeHandler=function(a){this.change=a;return this};
Field.prototype.setReadOnly=function(a){this.readOnly=a;this.html&&(this.controlObject.disabled=a);return this};Field.prototype.setSubmit=function(a){this.submit=a;return this};Field.prototype.setProxy=function(a){this.proxy=a;return this};
Field.prototype.validatorFactory=function(a){var b=null,c={email:{pattern:/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/},integer:{pattern:/^\s*(\+|-)?\d+\s*$/},required:{pattern:/\S/}};if(a&&a.jtype)switch(a.jtype){case "required":a.criteria&&!a.criteria.trim&&(b=new TextLengthValidator({criteria:{trim:!1,minLength:1},errorMessage:a.errorMessage||this.parent.language.ERROR_REQUIRED_FIELD},
this));break;case "email":case "integer":a.criteria=c[a.jtype].pattern;b=new RegExpValidator($.extend({errorMessage:c[a.jtype].message},a),this);break;case "comparison":b=new ComparisonValidator($.extend({errorMessage:this.parent.language.ERROR_COMPARISON},a),this);break;case "regexp":b=new RegExpValidator($.extend({errorMessage:this.parent.language.ERROR_REGEXP},a),this);break;case "textLength":b=new TextLengthValidator($.extend({errorMessage:this.parent.language.ERROR_TEXT_LENGTH},a),this);break;
case "custom":b=new CustomValidator($.extend({errorMessage:""},a),this);break;case "number":b=new NumberValidator($.extend({errorMessage:""},a),this);break;case "range":b=new RangeValidator($.extend({errorMessage:""},a),this);break;default:b=new Validator($.extend({errorMessage:""},a),this)}else b=new Validator(null,this);return b};Field.prototype.getObjectValue=function(){var a={};this.submit&&(a[this.name]=this.value);return a};
Field.prototype.evalRequired=function(){var a=!0;this.required&&((a=null!==this.value&&""!==this.value&&this.value.trim())?$(this.controlObject).removeClass("required"):$(this.controlObject).addClass("required"));return a};Field.prototype.reset=function(){this.setValue(this.initialValue||null,!0);this.errorTooltip&&($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off"));this.required&&this.controlObject&&$(this.controlObject).removeClass("required")};
Field.prototype.attachListeners=function(){};Field.prototype.createHTML=function(){Element.prototype.createHTML.call(this);this.style.removeProperties("position width height top left z-index".split(" "));this.style.addClasses(["adam-field"]);return this.html};
Field.prototype.isValid=function(){var a,b=!0;for(a=0;a<this.validators.length;a+=1)if(b=b&&this.validators[a].isValid(),!b)return this.errorTooltip.setMessage(this.validators[a].getErrorMessage()),$(this.errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.errorTooltip.html).addClass("adam-tooltip-error-on"),b;b&&($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off"));return b};
Field.prototype.onChange=function(a,b){this.required&&this.evalRequired();this.isValid();this.change&&this.change(this,a,b);this.parent.setDirty(!0);return this};Field.prototype.doLoad=function(){this.proxy&&this.load()};Field.prototype.load=function(){};var Validator=function(a,b){Base.call(this,a);this.criteria=this.parent=null;this.validated=!1;this.errorMessage=this.valid=null;Validator.prototype.initObject.call(this,a,b)};Validator.prototype=new Base;Validator.prototype.type="Validator";
Validator.prototype.family="Validator";Validator.prototype.initObject=function(a,b){var c={criteria:null,errorMessage:"the validation has failed"};$.extend(!0,c,a);this.setCriteria(c.criteria).setParent(b).setErrorMessage(c.errorMessage)};Validator.prototype.setErrorMessage=function(a){this.errorMessage=a;return this};Validator.prototype.getErrorMessage=function(){return this.errorMessage};Validator.prototype.setCriteria=function(a){this.criteria=a;return this};
Validator.prototype.setParent=function(a){this.parent=a;return this};Validator.prototype.validate=function(){this.valid=!0};Validator.prototype.isValid=function(){this.validate();this.updateTooltip();return this.valid};Validator.prototype.updateTooltip=function(){this.parent&&this.parent.errorTooltip&&(this.valid?$(this.parent.errorTooltip.html).removeClass("adam-tooltip-error-on").addClass("adam-tooltip-error-off"):(this.parent.errorTooltip.setMessage(this.errorMessage),$(this.parent.errorTooltip.html).removeClass("adam-tooltip-error-off").addClass("adam-tooltip-error-on")))};
var RegExpValidator=function(a,b){Validator.call(this,a,b);RegExpValidator.prototype.initObject.call(this,a)};RegExpValidator.prototype=new Validator;RegExpValidator.prototype.type="RegExpValidator";RegExpValidator.prototype.initObject=function(a){var b={errorMessage:"The text pattern doesn't match"};$.extend(!0,b,a);this.setErrorMessage(b.errorMessage)};
RegExpValidator.prototype.validate=function(){this.valid=this.criteria instanceof RegExp&&this.parent&&this.parent.value?this.criteria.test(this.parent.value):!1};var TextLengthValidator=function(a,b){Validator.call(this,a,b);TextLengthValidator.prototype.initObject(this,a)};TextLengthValidator.prototype=new Validator;TextLengthValidator.prototype.type="TextLengthValidator";
TextLengthValidator.prototype.initObject=function(a){var b={errorMessage:"The text length doesn't match with the specified one"};$.extend(!0,b,a);this.setErrorMessage(b.errorMessage)};
TextLengthValidator.prototype.validate=function(){var a=this.criteria.trim?$.trim(this.parent.value):this.parent.value;this.valid=!0;this.criteria.maxLength&&(this.valid=a.length<=parseInt(this.criteria.maxLength,10));this.criteria.minLength&&(this.valid=(null!==this.valid?this.valid:!0)&&a.length>=parseInt(this.criteria.minLength,10))};var CustomValidator=function(a,b){Validator.call(this,a,b)};CustomValidator.prototype=new Validator;CustomValidator.prototype.type="CustomValidator";
CustomValidator.prototype.validate=function(){"function"===typeof this.criteria.validationFunction&&(this.valid=this.criteria.validationFunction.call(this.parent,this.parent.parent));if("undefined"===typeof this.valid||null===this.valid)this.valid=!1};var NumberValidator=function(a,b){Validator.call(this,a,b);NumberValidator.prototype.initObject.call(this,a)};NumberValidator.prototype=new Validator;
NumberValidator.prototype.initObject=function(a){var b={criteria:{decimalSeparator:".",errorMessage:"The value must be a number"}};$.extend(!0,b,a);this.setDecimalSeparator(b.criteria.decimalSeparator).setErrorMessage(b.errorMessage)};NumberValidator.prototype.setDecimalSeparator=function(a){this.criteria.decimalSeparator=a};
NumberValidator.prototype.validate=function(){var a,b,c,d,e;this.valid=!1;if(this.parent&&this.parent.value&&(a=this.parent.value.replace(/\./g,""),a=a.replace(/,/g,""),/^\s*\d+\s*$/.test(a)&&!("."!==this.criteria.decimalSeparator&&","!==this.criteria.decimalSeparator)&&(e=","===this.criteria.decimalSeparator?".":",",c=RegExp("\\"+e,"g"),a=this.parent.value.split(this.criteria.decimalSeparator),b=this.parent.value.match(RegExp("\\"+this.criteria.decimalSeparator,"g")),!(b&&1<b.length)&&/^\s*\d+\s*$/.test(a[0].replace(RegExp("\\"+
e,"g"),""))))){if(a[0].match(c)&&0!==a[0].match(c).length){if("0"===a[0].charAt(0))return;b=Math.floor(a[0].length/4);b-=a[0].length%4?0:1;if(a[0].match(c).length!==b)return;c=a[0].length-4;for(d=0;0<c;)a[0].charAt(c)===e&&(d+=1),c-=4;if(d!=b)return}if(!a[1]||/^\s*\d+\s*$/.test(a[1]))this.valid=!0}};var ComparisonValidator=function(a,b){Validator.call(this,a,b);ComparisonValidator.prototype.initObject(this,a)};ComparisonValidator.prototype=new Validator;ComparisonValidator.prototype.type="ComparisonValidator";
ComparisonValidator.prototype.initObject=function(a){var b={errorMessage:"The comparison failed"};$.extend(!0,b,a);this.setErrorMessage(b.errorMessage)};
ComparisonValidator.prototype.validate=function(){var a,b,c={"==":function(a,b){return a===b},">":function(a,b){return a>b},">=":function(a,b){return a>=b},"<":function(a,b){return a<b},"<=":function(a,b){return a<=b}},d=this.parent.parent.items.slice(0),e,f;this.valid=!1;if(c[this.criteria.operator]){switch(this.criteria.compare){case "textLength":a=this.parent.value.length;for(b=0;b<this.criteria.compareWith.length;b+=1){for(f=0;f<d.length&&!(e=d.shift(),e.name===this.criteria.compareWith[f]);f+=
1);if(!c[this.criteria.operator](a,e.value.length))return}break;case "numeric":if(isNaN(this.parent.value.replace(/,/g,"")))return;a=parseFloat(this.parent.value.replace(/,/g,""));for(b=0;b<this.criteria.compareWith.length;b+=1){for(f=0;f<d.length&&!(e=d.shift(),e.name===this.criteria.compareWith[f]);f+=1);if(isNaN(e.value.replace(/,/g,""))||!c[this.criteria.operator](a,parseFloat(e.value.replace(/,/g,""))))return}break;default:a=this.parent.value;for(b=0;b<this.criteria.compareWith.length;b+=1){for(f=
0;f<d.length&&!(e=d.shift(),e.name===this.criteria.compareWith[f]);f+=1);if(!c[this.criteria.operator](a,e.value))return}}this.valid=!0}};var RangeValidator=function(a,b){Validator.call(this,a,b);RangeValidator.prototype.initObject.call(this,a)};RangeValidator.prototype=new Validator;RangeValidator.prototype.initObject=function(a){var b={criteria:{type:"string",dateFormat:"yyyy-mm-dd"},errorMessage:"the value is out of ranges"};$.extend(!0,b,a);this.setCriteria(b.criteria).setErrorMessage(b.errorMessage)};
RangeValidator.prototype.validate=function(){var a=this,b=["minValue","maxValue"],c={string:function(a){return a.toString()},numeric:function(a){return isNaN(a)?NaN:parseFloat(a)},date:function(b){var c,d={},e={},k="yyyy mm dd hh ii ss".split(" ");if("object"===typeof b)b=new Date(b.year,b.month-1,b.day,b.hours||0,b.minutes||0,b.seconds||0,b.milliseconds||0);else if("string"===typeof b){a.criteria.dateFormat=$.trim(a.criteria.dateFormat);for(c=0;c<k.length;c+=1){d[k[c]]=a.criteria.dateFormat.toLowerCase().indexOf(k[c]);
switch(k[c]){case "yyyy":case "mm":case "dd":e[k[c]]=0<=d[k[c]]?b.substr(d[k[c]],k[c].length):"x";break;default:e[k[c]]=(0<=d[k[c]]?b.substr(d[k[c]],2):0)||0}if(isNaN(e[k[c]])||!/^\s*\d+\s*$/.test(e[k[c]]))return null;e[k[c]]=parseInt(e[k[c]],10)}if(0>=e.mm&&0>=e.dd)return null;switch(e.mm){case 4:case 6:case 9:case 11:if(30<e.dd)return null;break;case 2:if((0===e.yyyy%4&&0!==e.yyyy%100||0===e.yyyy%400)&&29<e.dd||28<e.dd)return null;break;default:if(31<e.dd)return null}b=new Date(e.yyyy,0<e.mm&&13>
e.mm?e.mm-1:"x",e.dd,0<=e.hh&&24>e.hh?e.hh:"x",0<=e.ii&&60>e.ii?e.ii:"x",0<=e.ss&&60>e.ss?e.ss:"x")}else return null;return"[object Date]"!==Object.prototype.toString.call(b)?null:!isNaN(b.getTime())?b:null}},d,e={};for(d=0;d<b.length;d+=1)this.criteria[b[d]]&&(e[b[d]]=c[this.criteria.type.toLowerCase()](this.criteria[b[d]]));!this.criteria.minValue&&!this.criteria.maxValue?this.valid=!1:(this.valid=!0,e.maxValue&&(this.valid=c[this.criteria.type.toLowerCase()](this.parent.value)<=e.maxValue),e.minValue&&
(this.valid=this.valid&&c[this.criteria.type.toLowerCase()](this.parent.value)>=e.minValue))};var TextField=function(a,b){Field.call(this,a,b);this.maxCharacters=null;TextField.prototype.initObject.call(this,a)};TextField.prototype=new Field;TextField.prototype.type="TextField";TextField.prototype.initObject=function(a){var b={maxCharacters:0};$.extend(!0,b,a);this.setMaxCharacters(b.maxCharacters)};TextField.prototype.setMaxCharacters=function(a){this.maxCharacters=a;return this};
TextField.prototype.createHTML=function(){var a,b;b="";var c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;this.html.appendChild(a);b=this.createHTMLElement("input");b.type="text";b.id=this.name;b.value=this.value||"";this.fieldWidth&&(b.style.width=this.fieldWidth);this.readOnly&&(c=document.createAttribute("readonly"),b.setAttributeNode(c));this.html.appendChild(b);
this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;this.controlObject=b;return this.html};TextField.prototype.attachListeners=function(){var a=this;this.controlObject&&$(this.controlObject).change(function(){a.setValue(this.value,!0);a.onChange()}).keydown(function(a){a.stopPropagation()});return this};
TextField.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required")};TextField.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};
var ComboboxField=function(a,b){Field.call(this,a,b);this.options=[];this.related=null;ComboboxField.prototype.initObject.call(this,a)};ComboboxField.prototype=new Field;ComboboxField.prototype.type="ComboboxField";ComboboxField.prototype.initObject=function(a){var b={options:[],related:null};$.extend(!0,b,a);this.setOptions(b.options).setRelated(b.related)};
ComboboxField.prototype.setOptions=function(a){this.options=a;if(this.html){for(a=0;a<this.options.length;a+=1)this.controlObject.appendChild(this.generateOption(this.options[a]));this.value||(this.value=this.controlObject.value)}return this};ComboboxField.prototype.setRelated=function(a){this.related=a;return this};
ComboboxField.prototype.createHTML=function(){var a,b;b="";var c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;this.html.appendChild(a);b=this.createHTMLElement("select");b.id=this.name;for(c=0;c<this.options.length;c+=1)b.appendChild(this.generateOption(this.options[c]));this.value||(this.value=b.value);this.fieldWidth&&(b.style.width=this.fieldWidth);
this.readOnly&&(c=document.createAttribute("disabled"),b.setAttributeNode(c));this.html.appendChild(b);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;this.controlObject=b;return this.html};ComboboxField.prototype.removeOptions=function(){if(this.options){for(;this.controlObject.firstChild;)this.controlObject.removeChild(this.controlObject.firstChild);this.options=[]}return this};
ComboboxField.prototype.generateOption=function(a){var b,c,d;b=this.createHTMLElement("option");"object"===typeof a?(c=a.value,d=a.text):c=a;b.selected=this.value===c;b.value=c;b.label=d||c;b.appendChild(document.createTextNode(d||c));return b};ComboboxField.prototype.attachListeners=function(){var a=this;this.controlObject&&$(this.controlObject).change(function(b){b=a.value;a.setValue(this.value,!0);a.onChange(this.value,b)});return this};
ComboboxField.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required")};ComboboxField.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};
var TextareaField=function(a,b){Field.call(this,a,b);this.fieldHeight=null;TextareaField.prototype.initObject.call(this,a)};TextareaField.prototype=new Field;TextareaField.prototype.type="TextareaField";TextareaField.prototype.initObject=function(a){var b={fieldHeight:null};$.extend(!0,b,a);this.setFieldHeight(b.fieldHeight)};TextareaField.prototype.setFieldHeight=function(a){this.fieldHeight=a;return this};
TextareaField.prototype.createHTML=function(){var a,b="";Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;a.style.verticalAlign="top";this.html.appendChild(a);a=this.createHTMLElement("textarea");a.id=this.name;a.value=this.value;this.fieldWidth&&(a.style.width=this.fieldWidth);this.fieldHeight&&(a.style.height=this.fieldHeight);this.readOnly&&(b=document.createAttribute("readonly"),
a.setAttributeNode(b));this.html.appendChild(a);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.controlObject=a;return this.html};TextareaField.prototype.attachListeners=function(){var a=this;this.controlObject&&$(this.controlObject).change(function(){a.setValue(this.value,!0);a.onChange()}).keydown(function(a){a.stopPropagation()});return this};
var CheckboxField=function(a,b){Field.call(this,a,b);this.defaults={onClick:function(a,b){}};$.extend(!0,this.defaults,a)};CheckboxField.prototype=new Field;CheckboxField.prototype.type="CheckboxField";
CheckboxField.prototype.createHTML=function(){var a,b;b="";var c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;this.html.appendChild(a);b=this.createHTMLElement("input");b.id=this.name;b.type="checkbox";b.checked=this.value?!0:!1;this.readOnly&&(c=document.createAttribute("readonly"),b.setAttributeNode(c));this.html.appendChild(b);this.errorTooltip&&
this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;this.controlObject=b;return this.html};
CheckboxField.prototype.attachListeners=function(){var a=this;if(this.controlObject){if("undefined"!==typeof this.defaults.onClick&&"function"===typeof this.defaults.onClick)$(this.controlObject).on("click",function(b,c){return a.defaults.onClick()});$(this.controlObject).change(function(b,c){a.setValue(this.checked?!0:!1,!0);a.onChange()})}return this};CheckboxField.prototype.getObjectValue=function(){var a={};a[this.name]=this.value?!0:!1;return a};
CheckboxField.prototype.evalRequired=function(){var a=!0;this.required&&((a=this.value)?$(this.controlObject).removeClass("required"):$(this.controlObject).addClass("required"));return a};CheckboxField.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required")};
CheckboxField.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};var RadiobuttonField=function(a,b){Field.call(this,a,b);this.defaults={options:{},onClick:function(a,b){}};$.extend(!0,this.defaults,a)};RadiobuttonField.prototype=new Field;RadiobuttonField.prototype.type="RadiobuttonField";
RadiobuttonField.prototype.createHTML=function(){var a,b,c="";Field.prototype.createHTML.call(this);this.required&&(c="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";b=this.createHTMLElement("input");b.name=this.name;b.type="radio";b.value=this.value;"undefined"===typeof this.defaults.labelAlign||"left"===this.defaults.labelAlign?(a.style.width=this.parent.labelWidth,a.innerHTML=this.label+": "+c,a.style.verticalAlign="top",a.style.width=this.parent.labelWidth,this.html.appendChild(a),
this.html.appendChild(b)):"right"===this.defaults.labelAlign&&(a.innerHTML="&nbsp;"+this.label+c,b.style.marginLeft=this.defaults.marginLeft?this.defaults.marginLeft+"px":"0px",a.style.width=this.parent.labelWidth,this.html.appendChild(b),this.html.appendChild(a));b.checked=this.value?!0:!1;this.readOnly&&(a=document.createAttribute("readonly"),b.setAttributeNode(a));this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());
this.controlObject=b;return this.html};RadiobuttonField.prototype.attachListeners=function(){var a=this;if(this.controlObject){if("undefined"!==typeof this.defaults.onClick&&"function"===typeof this.defaults.onClick)$(this.controlObject).on("click",function(b,c){return a.defaults.onClick()});$(this.controlObject).change(function(b,c){a.onChange()})}return this};RadiobuttonField.prototype.getObjectValue=function(){return this.value};
RadiobuttonField.prototype.evalRequired=function(){var a=!0;this.required&&((a=this.value)?$(this.controlObject).removeClass("required"):$(this.controlObject).addClass("required"));return a};RadiobuttonField.prototype._setValueToControl=function(a){this.html&&this.controlObject&&(this.controlObject.checked=this.value);return this};var LabelField=function(a,b){Field.call(this,a,b);this.submit=!1;this.defaults={options:{marginLeft:10}};$.extend(!0,this.defaults,a)};LabelField.prototype=new Field;
LabelField.prototype.type="LabelField";LabelField.prototype.createHTML=function(){var a;Field.prototype.createHTML.call(this);a=this.createHTMLElement("span");a.innerHTML=this.label+":";a.style.verticalAlign="top";a.style.marginLeft=this.defaults.options.marginLeft+"px";this.html.appendChild(a);return this.html};var HiddenField=function(a,b){Field.call(this,a,b)};HiddenField.prototype=new Field;HiddenField.prototype.type="HiddenField";
HiddenField.prototype.createHTML=function(){Element.prototype.createHTML.call(this);return this.html};var EmailGroupField=function(a,b){Field.call(this,a,b)};EmailGroupField.prototype=new Field;EmailGroupField.prototype.type="EmailGroupField";var DateField=function(a,b){Field.call(this,a,b);this.maxCharacters=null;DateField.prototype.initObject.call(this,a)};DateField.prototype=new Field;DateField.prototype.type="TextField";
DateField.prototype.initObject=function(a){var b={maxCharacters:0};$.extend(!0,b,a);this.setMaxCharacters(b.maxCharacters)};DateField.prototype.setMaxCharacters=function(a){this.maxCharacters=a;return this};
DateField.prototype.createHTML=function(){var a,b;b="";var c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;this.html.appendChild(a);b=this.createHTMLElement("input");b.id=this.name;b.value=this.value||"";$(b).datepicker();this.fieldWidth&&(b.style.width=this.fieldWidth);this.readOnly&&(c=document.createAttribute("readonly"),b.setAttributeNode(c));
this.html.appendChild(b);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;this.controlObject=b;return this.html};DateField.prototype.attachListeners=function(){var a=this;this.controlObject&&$(this.controlObject).change(function(){a.setValue(this.value,!0);a.onChange()}).keydown(function(a){a.stopPropagation()});return this};
DateField.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required");$(this.controlObject).datepicker("hide")};DateField.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};
var NumberField=function(a,b){Field.call(this,a,b);this.maxCharacters=null;NumberField.prototype.initObject.call(this,a)};NumberField.prototype=new Field;NumberField.prototype.type="TextField";NumberField.prototype.initObject=function(a){var b={maxCharacters:0};$.extend(!0,b,a);this.setMaxCharacters(b.maxCharacters)};NumberField.prototype.setMaxCharacters=function(a){this.maxCharacters=a;return this};
NumberField.prototype.createHTML=function(){var a,b;b="";var c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;this.html.appendChild(a);b=this.createHTMLElement("input");b.id=this.name;b.value=this.value||"";this.fieldWidth&&(b.style.width=this.fieldWidth);this.readOnly&&(c=document.createAttribute("readonly"),b.setAttributeNode(c));this.html.appendChild(b);
this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;this.controlObject=b;return this.html};
NumberField.prototype.attachListeners=function(){var a=this;this.controlObject&&$(this.controlObject).change(function(){a.setValue(this.value,!0);a.onChange()}).keydown(function(a){a.stopPropagation()});$(this.controlObject).on("keydown",function(a){a.stopPropagation();46===a.keyCode||(8===a.keyCode||9===a.keyCode||27===a.keyCode||13===a.keyCode||65===a.keyCode&&!0===a.ctrlKey||35<=a.keyCode&&39>=a.keyCode)||(a.shiftKey||(48>a.keyCode||57<a.keyCode)&&(96>a.keyCode||105<a.keyCode))&&a.preventDefault()}).on("keyup",
function(a){a.stopPropagation()});return this};NumberField.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required")};NumberField.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};
var CheckboxGroup=function(a,b){Field.call(this,a,b);this.controlObject={};CheckboxGroup.prototype.initObject.call(this,a)};CheckboxGroup.prototype=new Field;CheckboxGroup.prototype.type="CheckboxGroup";CheckboxGroup.prototype.initObject=function(a){var b={items:[]};$.extend(!0,b,a);this.items=b.items};
CheckboxGroup.prototype.createHTML=function(){var a,b;b="";var c,d,e,f,h,g=this;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");d=this.createHTMLElement("div");d.style.display="inline-block";d.style.width="30%";d.style.verticalAlign="top";a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b+"&nbsp;&nbsp;&nbsp;&nbsp;";a.style.width=this.parent.labelWidth;d.appendChild(a);this.html.appendChild(d);d=this.createHTMLElement("div");d.style.display=
"inline-block";d.style.width="40%";f=this.createHTMLElement("ul");for(e=0;e<this.items.length;e+=1)h=this.createHTMLElement("li"),h.style.listStyleType="none",b=this.createHTMLElement("input"),b.id=this.items[e].value,b.type="checkbox",b.checked=this.items[e].checked?!0:!1,this.readOnly&&(c=document.createAttribute("readonly"),b.setAttributeNode(c)),h.appendChild(b),c={control:b},this.items[e].checked&&(c.checked=!0),this.controlObject[this.items[e].value]=c,c=document.createElement("Label"),c.innerHTML=
" &nbsp;&nbsp;"+this.items[e].text,h.appendChild(c),f.appendChild(h),$(b).change(function(){this.checked?g.controlObject[$(this).attr("id")].checked=!0:g.controlObject[$(this).attr("id")].checked=!1});d.appendChild(f);this.html.appendChild(d);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.labelObject=a;return this.html};CheckboxGroup.prototype.attachListeners=function(){return this};
CheckboxGroup.prototype.getObjectValue=function(){var a={},b=[];$.each(this.controlObject,function(a,d){d.checked&&b.push(a)});a[this.name]=b;return a};CheckboxGroup.prototype.evalRequired=function(){var a=!0;this.required&&((a=this.value)?$(this.controlObject).removeClass("required"):$(this.controlObject).addClass("required"));return a};
CheckboxGroup.prototype.disable=function(){this.labelObject.className="adam-form-label-disabled";this.controlObject.disabled=!0;this.oldRequiredValue||(this.oldRequiredValue=this.required);this.setRequired(!1);$(this.controlObject).removeClass("required")};CheckboxGroup.prototype.enable=function(){this.labelObject.className="adam-form-label";this.controlObject.disabled=!1;this.oldRequiredValue&&this.setRequired(this.oldRequiredValue)};
var Button=function(a,b){Element.call(this,a);this.icon=this.action=this.caption=this.parent=null;Button.prototype.initObject.call(this,a,b)};Button.prototype=new Element;Button.prototype.type="Button";Button.prototype.family="Button";
Button.prototype.initObject=function(a,b){var c,d=this;if(a.isAction)this.loadAction(a,b);else switch(c={caption:null,parent:b||null,jtype:"normal",handler:function(){},icon:null},$.extend(!0,c,a),this.setCaption(c.caption).setParent(c.parent).setIcon(c.icon),c.jtype){case "reset":this.action=new Action({text:this.caption,handler:function(){d.parent.reset()},cssStyle:this.icon});break;case "submit":this.action=new Action({text:this.caption,handler:function(){d.parent.submit()},cssStyle:this.icon});
break;case "normal":this.action=new Action({text:this.caption,handler:c.handler,cssStyle:this.icon})}};Button.prototype.loadAction=function(a,b){this.action=a;this.setCaption(this.action.text);this.setIcon(this.action.cssStyle);this.setParent(b)};Button.prototype.setCaption=function(a){this.caption=a;return this};Button.prototype.setIcon=function(a){this.icon=a;return this};Button.prototype.setParent=function(a){this.parent=a;return this};
Button.prototype.createHTML=function(){var a,b;a=this.createHTMLElement("a");a.href="#";a.className="adam-button";a.id=this.id;this.icon&&(b=this.createHTMLElement("span"),b.className=this.icon,a.appendChild(b));b=this.createHTMLElement("span");b.className="adam-button-label";b.innerHTML=this.caption;a.appendChild(b);return this.html=a};Button.prototype.attachListeners=function(){var a=this;$(this.html).click(function(b){b.stopPropagation();b.preventDefault();a.action.handler&&a.action.handler()}).mousedown(function(a){a.stopPropagation()})};
var RestProxy=function(a){Proxy.call(this,a);this.uid=this.sendMethod=this.getMethod=this.restClient=null;RestProxy.prototype.initObject.call(this,a)};RestProxy.prototype=new Proxy;RestProxy.prototype.type="RestProxy";RestProxy.prototype.initObject=function(a){var b={restClient:null,sendMethod:"PUT",getMethod:"GET",uid:null};$.extend(!0,b,a);this.setUid(b.uid).setRestClient(b.restClient).setSendMethod(b.sendMethod).setGetMethod(b.getMethod)};RestProxy.prototype.setUid=function(a){this.uid=a;return this};
RestProxy.prototype.setRestClient=function(a){this.restClient=a;return this};RestProxy.prototype.setSendMethod=function(a){this.sendMethod=a;return this};RestProxy.prototype.setGetMethod=function(a){this.getMethod=a;return this};RestProxy.prototype.getData=function(a){var b,c;this.restClient&&(b=this.getOperation(this.getMethod),this.restClient.consume({operation:b,url:this.url,id:this.uid,data:a,success:function(a,b){(status=b.success)&&(c=b)}}));return c};
RestProxy.prototype.sendData=function(a,b){var c;this.restClient&&(c=this.getOperation(this.sendMethod),c={operation:c,url:this.url,id:this.uid,data:a},b&&(b.success&&(c.success=b.success),b.failure&&(c.failure=b.failure)),this.restClient.consume(c))};RestProxy.prototype.getOperation=function(a){var b;switch(a){case "GET":b="read";break;case "POST":b="create";break;case "PUT":b="update";break;case "DELETE":b="delete"}return b};
var SugarProxy=function(a){Proxy.call(this,a);this.sendMethod=this.getMethod=this.uid=null;SugarProxy.prototype.initObject.call(this,a)};SugarProxy.prototype=new Proxy;SugarProxy.prototype.type="SugarProxy";SugarProxy.prototype.initObject=function(a){var b={sendMethod:"PUT",getMethod:"GET",createMethod:"POST",uid:null};$.extend(!0,b,a);this.setUid(b.uid).setSendMethod(b.sendMethod).setGetMethod(b.getMethod).setCreateMethod(b.createMethod)};SugarProxy.prototype.setUid=function(a){this.uid=a;return this};
SugarProxy.prototype.setSendMethod=function(a){this.sendMethod=a;return this};SugarProxy.prototype.setGetMethod=function(a){this.getMethod=a;return this};SugarProxy.prototype.setCreateMethod=function(a){this.createMethod=a;return this};
SugarProxy.prototype.getData=function(a,b){var c,d=this,e;c=this.getOperation(this.getMethod);e="read"===c&&a?App.api.buildURL(this.url,null,null,a):App.api.buildURL(this.url,null,null);App.api.call(c,e,{},{success:function(a){b&&b.success&&b.success.call(d,a)},error:function(a){b&&"function"===typeof b.error&&b.error.call(d,a)}})};
SugarProxy.prototype.sendData=function(a,b){var c,d=this,e;c=this.getOperation(this.sendMethod);e=App.api.buildURL(this.url,null,null);attributes={data:a};App.api.call(c,e,attributes,{success:function(a){b&&b.success&&b.success.call(d,a)}})};SugarProxy.prototype.createData=function(a,b){var c,d=this,e;c=this.getOperation(this.createMethod);e=App.api.buildURL(this.url,null,null);attributes={data:a};App.api.call(c,e,attributes,{success:function(a){b&&b.success&&b.success.call(d,a)}})};
SugarProxy.prototype.removeData=function(a,b){var c=this,d;d=a?App.api.buildURL(this.url,null,null,a):App.api.buildURL(this.url,null,null);App.api.call("delete",d,{},{success:function(a){b&&b.success&&b.success.call(c,a)}})};SugarProxy.prototype.getOperation=function(a){var b;switch(a){case "GET":b="read";break;case "POST":b="create";break;case "PUT":b="update";break;case "DELETE":b="delete"}return b};
var ItemMatrixField=function(a,b){Field.call(this,a,b);this.moduleName=null;this.lockedFields=[];this.terminateFields={};this.nColumns=this.visualStyle=this.searchValue=this.selectedHandler=this.keyDelay=this.fieldHeight=this.fieldWidth=null;ItemMatrixField.prototype.initObject.call(this,a)};ItemMatrixField.prototype=new Field;ItemMatrixField.prototype.initObject=function(a){var b={visualStyle:"list",nColumns:2};$.extend(!0,b,a);this.setFieldWidth(b.fieldWidth).setFieldHeight(b.fieldHeight).setName(b.name).setVisualStyle(b.visualStyle).setNColumns(b.nColumns)};
ItemMatrixField.prototype.createHTML=function(){var a,b="";Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=b+this.label+":";a.style.width=this.parent.labelWidth;a.style.verticalAlign="top";this.html.appendChild(a);"list"===this.visualStyle?(a=this.createHTMLElement("ul"),a.className="adam-item-matrix"):(a=this.createHTMLElement("div"),a.className="adam-item-matrix table");this.fieldWidth&&this.fieldHeight&&
(b=document.createAttribute("style"),this.fieldWidth&&(b.value+="width: "+this.fieldWidth+"px; "),this.fieldHeight&&(b.value+="height: "+this.fieldHeight+"px; "),b.value+="display: inline-block; margin: 0; overflow: auto; padding: 3px;",a.setAttributeNode(b));this.html.appendChild(a);this.controlObject=a;return this.html};
ItemMatrixField.prototype.attachListeners=function(){var a=this;$(this.controlObject).on("click",".item-matrix-field",function(){$(this).is(":checked")?a.addLockedFields($(this).attr("value")):a.removeLockedFields($(this).attr("value"))});$(this.controlObject).on("change",".item-matrix-field",function(){a.parent.setDirty(!0)})};ItemMatrixField.prototype.setFieldHeight=function(a){this.fieldHeight=a;return this};ItemMatrixField.prototype.setFieldWidth=function(a){this.fieldWidth=a;return this};
ItemMatrixField.prototype.setNColumns=function(a){this.nColumns=a;return this};ItemMatrixField.prototype.setNameModule=function(a){this.nameModule=a;return this};ItemMatrixField.prototype.setLockedFields=function(a){"object"===typeof a&&a instanceof Array&&(this.lockedFields=a);return this};ItemMatrixField.prototype.setVisualStyle=function(a){this.visualStyle=a;return this};ItemMatrixField.prototype.addLockedFields=function(a){this.lockedFields.push(a);return this};
ItemMatrixField.prototype.removeLockedFields=function(a){a=this.lockedFields.indexOf(a);this.lockedFields.splice(a,1);return this};ItemMatrixField.prototype.setList=function(a,b){var c,d="";if(this.html){$(this.controlObject).empty();this.lockedFields=[];"table"===this.visualStyle&&(d+='<div class="row">');for(c=0;c<a.length;c+=1)d+=this.generateOption(a[c],b),0===(c+1)%this.nColumns&&(d+='</div><div class="row">');"table"===this.visualStyle&&(d+="</div></div>");this.controlObject.innerHTML=d}return this};
ItemMatrixField.prototype.generateOption=function(a,b){var c="",d,e,f;"object"===typeof a&&(d=a.value,e=a.text);"object"===typeof b&&b instanceof Array&&-1!==b.indexOf(d)&&(this.addLockedFields(d),f='checked = "checked"');return c="list"===this.visualStyle?'<li style="list-style-type: none;"><label><input type="checkbox" name="'+d+'" value="'+d+'" class="item-matrix-field" '+f+"/> "+e+"</label></li>":'<div class="box cell"><input type="checkbox" name="'+d+'" value="'+d+'" class="item-matrix-field" '+
f+"/> <span>"+e+"</span></div>"};ItemMatrixField.prototype.getFieldHeight=function(){return this.fieldHeight};ItemMatrixField.prototype.getFieldWidth=function(){return this.fieldWidth};ItemMatrixField.prototype.getNameModule=function(){return this.nameModule};ItemMatrixField.prototype.getLockedField=function(){return this.lockedFields};ItemMatrixField.prototype.getObjectValue=function(){this.value=JSON.stringify(this.lockedFields);return Field.prototype.getObjectValue.call(this)};
var ItemUpdaterField=function(a,b){Field.call(this,a,b);this.fields=[];this.options=[];this.visualObject=this.fieldHeight=null;this.language={};ItemUpdaterField.prototype.initObject.call(this,a)};ItemUpdaterField.prototype=new Field;ItemUpdaterField.prototype.type="ItemUpdaterField";ItemUpdaterField.prototype.initObject=function(a){var b={fields:[],fieldHeight:null,language:{LBL_ERROR_ON_FIELDS:"Please, correct the fields with errors"}};$.extend(!0,b,a);this.language=b.language;this.setFields(b.fields).setFieldHeight(b.fieldHeight)};
ItemUpdaterField.prototype.setFields=function(a){var b,c=[],d;for(b=0;b<a.length;b+=1)"FieldUpdater"===a[b].type?(a[b].setParent(this),c.push(a[b])):(d=new FieldUpdater(item[b],this),c.push(d));this.fields=c;return this};ItemUpdaterField.prototype.setFieldHeight=function(a){this.fieldHeight=a;return this};
ItemUpdaterField.prototype.getObjectValue=function(){var a,b=[];this.convertOptionsToFields();for(a=0;a<this.fields.length;a+=1)b.push(this.fields[a].getJSONObject());this.value=JSON.stringify(b);return Field.prototype.getObjectValue.call(this)};ItemUpdaterField.prototype.getJsonValue=function(){var a,b=[];for(a=0;a<this.options.length;a++)this.options&&this.options[a].active&&(field=new FieldUpdater(this.options[a],this),b.push(field.getJSONObject()));return JSON.stringify(b)};
ItemUpdaterField.prototype.convertOptionsToFields=function(){var a=[],b;for(b=0;b<this.options.length;b+=1)this.options&&this.options[b].active&&a.push(new FieldUpdater(this.options[b],this));this.fields=a;return this};
ItemUpdaterField.prototype.setOptions=function(a){var b,c=[],d;if(a)for(b=0;b<a.length;b+=1)"id"!==a[b].type.toLowerCase()&&(d="FieldOption"===a[b].type?a[b]:new FieldOption({fieldId:a[b].value,fieldName:a[b].text,fieldType:a[b].type.toLowerCase(),fieldItems:a[b].optionItem,required:!!a[b].required},this),c.push(d));this.options=c;if(this.html){this.visualObject.innerHTML="";for(b=0;b<this.options.length;b+=1)insert=this.options[b].getHTML(),0===b%2&&(insert.className+=" updater-inverse"),this.visualObject.appendChild(insert)}return this};
ItemUpdaterField.prototype.createHTML=function(){var a,b="";Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=b+this.label+":";a.style.width=this.parent.labelWidth;a.style.verticalAlign="top";this.html.appendChild(a);a=this.createHTMLElement("div");a.className="adam-item-updater table";a.id=this.id;if(this.fieldWidth||this.fieldHeight)style=document.createAttribute("style"),this.fieldWidth&&(style.value+=
"width: "+this.fieldWidth+"px; "),this.fieldHeight&&(style.value+="height: "+this.fieldHeight+"px; "),style.value+="display: inline-block; margin: 0; overflow: auto; padding: 3px;",a.setAttributeNode(style);for(i=0;i<this.options.length;i+=1)insert=this.options[i].getHTML(),0===i%2&&(insert.className+=" updater-inverse"),a.appendChild(insert);this.html.appendChild(a);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());
this.visualObject=a;return this.html};
ItemUpdaterField.prototype.setValue=function(a){this.value=a;if(this.options&&0<this.options.length)try{if((fields=JSON.parse(a))&&0<fields.length)for(i=0;i<fields.length;i+=1)for(j=0;j<this.options.length;j+=1)if(fields[i].field===this.options[j].fieldId){this.options[j].active=!0;this.options[j].checkboxControl.checked=!0;this.options[j].textControl.disabled=!1;this.options[j].fieldValue=fields[i].value;this.options[j].value=fields[i].value;"date"===this.options[j].fieldType?$(this.options[j].textControl).datepicker("option",
{disabled:!1}):"datetime"===this.options[j].fieldType&&$(this.options[j].textControl).datetimepicker("option",{disabled:!1});"checkbox"==this.options[j].fieldType&&(this.options[j].textControl.checked="on"==fields[i].value?!0:!1);this.options[j].textControl.value=fields[i].value;break}}catch(b){}return this};
ItemUpdaterField.prototype.isValid=function(){var a,b=!0,c;for(a=0;a<this.options.length&&!(c=this.options[a],b=b&&c.isValid(),!b);a+=1);b?($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off"),b=b&&Field.prototype.isValid.call(this)):(this.visualObject.scrollTop+=getRelativePosition(c.getHTML(),this.visualObject).top,this.errorTooltip.setMessage(this.language.LBL_ERROR_ON_FIELDS),$(this.errorTooltip.html).removeClass("adam-tooltip-error-off"),
$(this.errorTooltip.html).addClass("adam-tooltip-error-on"));return b};var FieldUpdater=function(a,b){Base.call(this,a);this.module=this.label=this.parent=this.value=this.fieldName=this.field=null;FieldUpdater.prototype.initObject.call(this,a,b)};FieldUpdater.prototype=new Base;FieldUpdater.prototype.type="FieldUpdater";
FieldUpdater.prototype.initObject=function(a,b){if(a&&"FieldOption"===a.type)this.setField(a.fieldId).setFieldName(a.fieldName).setValue(a.fieldValue).setParent(b||null);else{var c={field:null,fieldName:null,value:null,label:null,module:null};$.extend(!0,c,a);this.setField(c.field).setFieldName(c.fieldName).setValue(c.value).setLabel(c.label).setModule(c.module).setParent(b||null)}};FieldUpdater.prototype.setField=function(a,b){this.field=a;"undefined"!==typeof b&&(this.fieldName=b);return this};
FieldUpdater.prototype.setFieldName=function(a){this.fieldName=a;return this};FieldUpdater.prototype.setValue=function(a){this.value=a;return this};FieldUpdater.prototype.setParent=function(a){this.parent=a;return this};FieldUpdater.prototype.setLabel=function(a){this.label=a;return this};FieldUpdater.prototype.setModule=function(a){this.module=a;return this};FieldUpdater.prototype.getLabel=function(){!this.label&&(this.field&&this.fieldName)&&(this.label=this.fieldName+" = '"+this.value+"'");return this.label};
FieldUpdater.prototype.getJSONObject=function(){return{field:this.field,fieldName:this.fieldName,value:this.value}};var FieldOption=function(a,b){Element.call(this,a);this.value=this.parent=this.textControl=this.checkboxControl=this.fieldItems=this.fieldValue=this.fieldName=this.fieldId=this.active=this.parent=null;this.language={};this.required=this.maxLength=null;FieldOption.prototype.initObject.call(this,a,b)};FieldOption.prototype=new Element;FieldOption.prototype.type="FieldOption";
FieldOption.prototype.initObject=function(a,b){var c;c={active:!1,fieldId:null,fieldValue:"",fieldName:null,fieldType:null,fieldItems:null,maxLength:0,language:{ERROR_FIELD_REQUIRED:"This field is required",ERROR_INVALID_INTEGER:"This field accepts only a integer value",ERROR_INVALID_DATETIME:"This field accepts only a datetime value",ERROR_INVALID_DATE:"This field accepts only a date value",ERROR_INVALID_PHONE:"This field accepts only a phone value",ERROR_INVALID_FLOAT:"This field accepts only a float value",
ERROR_INVALID_DECIMAL:"This field accepts only a decimal value",ERROR_INVALID_URL:"This field accpets only an url",ERROR_INVALID_CURRENCY:"This field accepts only a currency value",ERROR_INVALID_EMAIL:"This field accepts only e-mail addresses"},required:!1};$.extend(!0,c,a);this.language=c.language;this.setParent(b);this.setRequired(c.required).setMaxLength(c.maxLength).setActive(c.active).setFieldId(c.fieldId).setFieldName(c.fieldName).setFieldValue(c.fieldValue).setFieldType(c.fieldType).setFieldItems(c.fieldItems).setMessageError(c.messageError).setErrorTooltip({})};
FieldOption.prototype.setRequired=function(a){this.required=!!a;this.html&&$(this.html).find(".required.noshadow").show();return this};FieldOption.prototype.setMaxLength=function(a){a=parseInt(a,10);isNaN(a)||(this.maxLength=a,this.textControl&&(0<a?this.textControl.maxLength=a:this.textControl.removeAttribute("maxlength")));return this};FieldOption.prototype.setActive=function(a){this.active=a;return this};FieldOption.prototype.setFieldId=function(a){this.fieldId=a;return this};
FieldOption.prototype.setFieldName=function(a){this.fieldName=a;return this};FieldOption.prototype.setFieldValue=function(a){this.value=this.fieldValue=a;this.textControl&&$(this.textControl).val(a);return this};FieldOption.prototype.setFieldType=function(a){this.fieldType=a;return this};FieldOption.prototype.setFieldItems=function(a){this.fieldItems=a;return this};FieldOption.prototype.setParent=function(a){this.parent=a;return this};
FieldOption.prototype.createHTML=function(){var a,b,c,d,e;Element.prototype.createHTML.call(this);this.style.removeProperties("width height position top left z-index".split(" "));this.style.width="100%";this.style.addClasses(["row"]);a=this.createHTMLElement("div");a.className="cell";a.style.width="30%";b=document.createElement("input");b.id="chk_"+this.id;b.type="checkbox";b.className="adam-updater-checkbox";a.appendChild(b);this.checkboxControl=b;b=document.createElement("span");b.innerHTML=this.fieldName;
b.className="adam-updater-label";a.appendChild(b);b=b.cloneNode(!1);b.className="required noshadow";b.textContent="*";b.style.display=this.required?"inline":"none";a.appendChild(b);this.html.appendChild(a);a=this.createHTMLElement("div");a.className="cell";a.style.width="58%";if("dropdown"===this.fieldType){b=document.createElement("select");for(e in this.fieldItems)d=document.createElement("option"),d.value=e,d.style.marginBottom="0px",d.innerHTML=e,b.appendChild(d);b.id="val_"+this.id;b.type="dropdown";
b.className="adam-updater-value";a.appendChild(b);b.value=this.fieldValue;e=document.createAttribute("disabled");b.setAttributeNode(e);this.textControl=b}else"checkbox"===this.fieldType?(d=document.createElement("input"),d.id="val_"+this.id,d.type="checkbox",d.className="adam-updater-checkbox",b=document.createElement("label"),b.htmlFor="label"+this.id,a.appendChild(b),a.appendChild(d),d.checked="on"==this.fieldValue?!0:!1,e=document.createAttribute("disabled"),readAttLabel=document.createAttribute("disabled"),
d.setAttributeNode(e),b.setAttributeNode(readAttLabel),this.textControl=d):(c=document.createElement("input"),c.id="val_"+this.id,c.type="text",c.className="adam-updater-value",c.readOnly="date"===this.fieldType||"datetime"===this.fieldType,a.appendChild(c),c.value=this.fieldValue,e=document.createAttribute("disabled"),c.setAttributeNode(e),"password"===this.fieldType&&(c.type="password"),this.textControl=c);this.setMaxLength(this.maxLength);"date"===this.fieldType&&$(c).datepicker({showOn:"button",
constrainInput:!1,disabled:!0}).next("button").text("").button({icons:{primary:"ui-icon-calendar"}});"datetime"===this.fieldType&&$(c).datetimepicker({showOn:"button",constrainInput:!1,disabled:!0}).next("button").text("").button({icons:{primary:"ui-icon-calendar"}});this.html.appendChild(a);a=this.createHTMLElement("div");a.className="cell";a.style.width="5%";this.errorTooltip&&a.appendChild(this.errorTooltip.getHTML());this.html.appendChild(a);a=this.createHTMLElement("div");a.className="clear";
this.html.appendChild(a);this.attachListeners();return this.html};
FieldOption.prototype.attachListeners=function(){var a=this;$(this.checkboxControl).click(function(b){a.checkboxControl.checked?(a.textControl.disabled=!1,a.setActive(!0).setFieldValue(a.textControl.value),("date"===a.fieldType||"datetime"===a.fieldType)&&$(a.textControl).datepicker("option",{disabled:!1})):(a.textControl.disabled=!0,a.setActive(!1),$(a.textControl).removeClass("required"),$(a.errorTooltip.html).addClass("adam-tooltip-error-off"),("date"===a.fieldType||"datetime"===a.fieldType)&&
$(a.textControl).datepicker("option",{disabled:!0}),a.setFieldValue(""))});$(this.textControl).change(function(b){"checkbox"==a.textControl.type&&(a.textControl.value="off",!0==a.textControl.checked&&(a.textControl.value="on"));a.setFieldValue(a.textControl.value);!a.isValid()&&a.errorTooltip&&($(a.errorTooltip.html).removeClass("adam-tooltip-error-off"),$(a.errorTooltip.html).addClass("adam-tooltip-error-on"))});$(this.checkboxControl).change(function(b){a.parent.parent.setDirty(!0)})};
FieldOption.prototype.setMessageError=function(a){this.messageError=a;return this};FieldOption.prototype.setErrorTooltip=function(a){a?(a.css||(a.css="adam-tooltip-error-off"),a.icon||(a.icon="adam-tooltip-icon-error"),a.visible=!1,this.errorTooltip=new Tooltip(a,this)):this.errorTooltip=null;return this};FieldOption.prototype.evalRequired=function(){if(this.required)switch(this.fieldType){case "checkbox":return!0;default:return!!this.textControl.value}else return!0};
FieldOption.prototype.validInput=function(){var a=this.textControl.value,b;switch(this.fieldType){case "integer":return/^-?\d+$/.test(a);case "datetime":if(!/^\d\d(\/\d\d){2}(\d){2}\s\d\d(:\d\d){1,2}$/.test(a))return!1;b=a.split(" ");a=b[1];a=a.split(":");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10);a[2]=a[2]?parseInt(a[2],10):null;if(23<a[0]||59<a[1]||(!a[2]?0:59<a[2]))return!1;a=b[0];case "date":if(!/^\d\d\/\d\d\/(\d){4}$/.test(a))return!1;a=a.split("/");b={};b.y=parseInt(a[2],10);b.m=parseInt(a[0],
10);b.d=parseInt(a[1],10);if(1>b.m||12<b.m||1>b.d||31<b.d)return!1;if(4===b.m||6===b.m||9===b.m||11===b.m){if(30<b.d)return!1}else if(2===b.m)if(0===b.y%4&&0!==b.y%100||0===b.y%400){if(29<b.d)return!1}else if(28<b.d)return!1;break;case "float":return/^-?\d*(\.\d+)?$/.test(a);case "decimal":return/^-?\d+(\.\d{1,2})?$/.test(a);case "url":return/^(ht|f)tps?:\/\/\w+([\.\-\w]+)?\.([a-z]{2,4}|travel)(:\d{2,5})?(\/.*)?$/i.test(a);case "currency":return/^-?\d*(\.\d+)?$/.test(a);case "email":return/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(a)}return!0};
FieldOption.prototype.isValid=function(){var a=!0,b;if(!this.checkboxControl.checked)return!0;if(a=this.evalRequired()){switch(this.fieldType){case "currency":case "date":case "datetime":case "decimal":case "float":case "integer":case "email":a=this.validInput();break;default:a=this.textControl.value?this.validInput():!0}if(!a){switch(this.fieldType){case "integer":b=this.language.ERROR_INVALID_INTEGER;break;case "datetime":b=this.language.ERROR_INVALID_DATETIME;break;case "date":b=this.language.ERROR_INVALID_DATE;
break;case "phone":b=this.language.ERROR_INVALID_PHONE;break;case "float":b=this.language.ERROR_INVALID_FLOAT;break;case "decimal":b=this.language.ERROR_INVALID_DECIMAL;break;case "url":b=this.language.ERROR_INVALID_URL;break;case "currency":b=this.language.ERROR_INVALID_CURRENCY;break;case "email":b=this.language.ERROR_INVALID_EMAIL;break;case "checkbox":case "dropdown":case "textfield":case "name":case "password":case "textarea":b=""}this.errorTooltip.setMessage(b)}}else this.errorTooltip.setMessage(this.language.ERROR_FIELD_REQUIRED);
a?($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off")):($(this.errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.errorTooltip.html).addClass("adam-tooltip-error-on"));return a};var HtmlPanel=function(a){Panel.call(this,a);this.source=this;this.parent=this.scroll=null;HtmlPanel.prototype.initObject.call(this,a)};HtmlPanel.prototype=new Panel;HtmlPanel.prototype.type="HtmlPanel";
HtmlPanel.prototype.initObject=function(a){var b={source:null,scroll:!0};$.extend(!0,b,a);this.setSource(b.source).setScroll(b.scroll)};HtmlPanel.prototype.setSource=function(a){this.source=a;return this};HtmlPanel.prototype.setScroll=function(a){this.scroll=a;return this};
HtmlPanel.prototype.createHTML=function(){var a,b;Panel.prototype.createHTML.call(this);this.source&&(b=this.scroll?"auto":"none",a=this.createHTMLElement("div"),a.id=this.id,a.innerHTML=this.source,a.style.overflow=b,a.style.height=this.height-2+"px",this.body.appendChild(a),this.body.style.bottom="8px");this.attachListeners();return this.html};HtmlPanel.prototype.setParent=function(a){this.parent=a;return this};HtmlPanel.prototype.attachListeners=function(){$(this.body).on("mousedown",function(a){a.stopPropagation()})};
var Store=function(a){this.records=[];this.proxy=this.model=null;Store.prototype.initObject.call(this,a)};Store.prototype.type="Store";Store.prototype.initObject=function(a){$.extend(!0,{},a)};Store.prototype.addRecord=function(a){this.records.push(a);return this};Store.prototype.getRecord=function(a){return this.records[a]};Store.prototype.getSize=function(){return this.records.length};
var Grid=function(a){Container.call(this,a);this.columns=[];this.store=null;Grid.prototype.initObject.call(this,a)};Grid.prototype=new Container;Grid.prototype.type="Grid";Grid.prototype.family="Panel";Grid.prototype.initObject=function(a){var b={store:null,columns:[]};$.extend(!0,b,a);this.setStore(b.store).setColumns(b.columns)};
Grid.prototype.createHTML=function(){var a,b,c;Container.prototype.createHTML.call(this);b=document.createElement("table");this.createTableHeaders(b,this.columns);for(a=0;this.store&&a<this.store.getSize();a+=1)c=this.store.getRecord(a),this.createTableRow(b,this.columns,c);this.body.html.appendChild(b)};
Grid.prototype.createTableHeaders=function(a,b){var c=document.createElement("tr"),d,e;for(e=0;e<b.length;e+=1)d=document.createElement("th"),d.innerHTML=b[e].text,c.appendChild(d);a.appendChild(c);return a};Grid.prototype.setParent=function(a){this.parent=a;return this};Grid.prototype.createTableRow=function(a,b,c){var d,e,f=document.createElement("tr");for(d=0;d<b.length;d+=1)e=document.createElement("td"),e.innerHTML=c[b[d].dataIndex]||"",f.appendChild(e);a.appendChild(f);return a};
Grid.prototype.setStore=function(a){this.store=a;return this};Grid.prototype.getStore=function(){return this.store};Grid.prototype.setColumns=function(a){this.columns=a;return this};Grid.prototype.getColumns=function(){return this.columns};
var HistoryPanel=function(a){Panel.call(this,a);this.proxy=this.url=this.proxyEnabled=null;this.loaded=!1;this.data=null;this.callback={};this.dirty=!1;this.buttons=[];this.parent=this.closeContainerOnSubmit=this.headerHeight=this.footerHeight=this.labelWidth=this.footerAlign=null;HistoryPanel.prototype.initObject.call(this,a)};HistoryPanel.prototype=new Panel;HistoryPanel.prototype.type="HistoryPanel";
HistoryPanel.prototype.initObject=function(a){var b={url:null,data:null,proxyEnabled:!0,callback:{},buttons:[],footerAlign:"center",labelWidth:"30%",footerHeight:10,headerHeight:0,closeContainerOnSubmit:!1,logType:"message"};$.extend(!0,b,a);this.setUrl(b.url).setCallback(b.callback).setLabelWidth(b.labelWidth).setFooterAlign(b.footerAlign).setLogType(b.logType)};HistoryPanel.prototype.setUrl=function(a){this.url=a;return this};
HistoryPanel.prototype.setProxyEnabled=function(a){this.proxyEnabled=a;return this};HistoryPanel.prototype.setProxy=function(a){a&&a.family&&"Proxy"===a.family?(this.proxy=a,this.url=a.url,this.proxyEnabled=!0):this.proxyEnabled&&(a?(a.url||(a.url=this.url),this.proxy=new Proxy(a)):this.url&&(this.proxy=new Proxy({url:this.url})));return this};HistoryPanel.prototype.setData=function(a){this.data=a;this.loaded&&this.applyData();return this};
HistoryPanel.prototype.setCallback=function(a){this.callback=a;return this};HistoryPanel.prototype.setFooterAlign=function(a){this.footerAlign=a;return this};HistoryPanel.prototype.setLabelWidth=function(a){this.labelWidth=a;return this};HistoryPanel.prototype.setFooterHeight=function(a){this.footerHeight=a;return this};HistoryPanel.prototype.setHeaderHeight=function(a){this.headerHeight=a;return this};HistoryPanel.prototype.setCloseContainerOnSubmit=function(a){this.closeContainerOnSubmit=a;return this};
HistoryPanel.prototype.setLogType=function(a){this.logType=a;return this};HistoryPanel.prototype.load=function(){this.loaded||(this.proxy&&(this.data=this.proxy.getData()),this.callback.loaded&&this.callback.loaded(this.data,null!==this.proxy),this.attachListeners(),this.loaded=!0)};HistoryPanel.prototype.addLog=function(a){var b;b=new LogField(a);b.setParent(this);a=b.createHTML();this.body.appendChild(a);this.items.push(b);return this};
HistoryPanel.prototype.getData=function(){var a,b={};for(a=0;a<this.items.length;a+=1)$.extend(b,this.items[a].getObjectValue());return b};HistoryPanel.prototype.setDirty=function(a){this.dirty=a;return this};HistoryPanel.prototype.isDirty=function(){return this.dirty};
HistoryPanel.prototype.validate=function(){var a,b=!0,c;for(a=0;a<this.items.length;a+=1)c=this.items[a].isValid(),b=b&&c,!c&&this.items[a].errorTooltip&&($(this.items[a].errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.items[a].errorTooltip.html).addClass("adam-tooltip-error-on"));return b};HistoryPanel.prototype.testRequired=function(){var a,b=!0;for(a=0;a<this.items.length;a+=1)b=b&&this.items[a].evalRequired();return b};
HistoryPanel.prototype.attachListeners=function(){var a;for(a=0;a<this.items.length;a+=1)this.items[a].attachListeners();$(this.body).mousedown(function(a){a.stopPropagation()})};HistoryPanel.prototype.setHeight=function(a){Panel.prototype.setHeight.call(this,a);this.setBodyHeight(this.height-this.footerHeight-this.headerHeight);return this};
HistoryPanel.prototype.createHTML=function(){var a,b;Panel.prototype.createHTML.call(this);this.footer.style.textAlign=this.footerAlign;for(a=0;a<this.items.length;a+=1)this.items[a].setParent(this),b=this.items[a].getHTML(),this.body.appendChild(b);this.body.style.bottom="8px";return this.html};HistoryPanel.prototype.setParent=function(a){this.parent=a;return this};
HistoryPanel.prototype.getLogField=function(a){var b=null,c;for(c=0;c<this.items.length;c+=1)if(this.items[c].id===a){b=this.items[c];break}return b};var LogField=function(a,b){Field.call(this,a,b);this.submit=!1;this.items=[];this.deleteBtn=!1;this.deleteControl=null;LogField.prototype.initObject.call(this,a)};LogField.prototype=new Field;LogField.prototype.type="LogField";
LogField.prototype.initObject=function(a){var b={marginLeft:10,timeTextSize:11,picture:"/img/default_user.png",user:"",message:"default message",items:[],startDate:"3 July 2013",duration:null,completed:!1,deleteBtn:!1};$.extend(!0,b,a);this.setMarginLeft(b.marginLeft).setPicture(b.picture).setUser(b.user).setTimeTextSize(b.timeTextSize).setStartDate(b.startDate).setMessage(b.message).setDuration(b.duration).setItems(b.items).setCompleted(b.completed).setDeleteBtn(b.deleteBtn)};
LogField.prototype.setMarginLeft=function(a){this.marginLeft=a;return this};LogField.prototype.setPicture=function(a){this.picture=a;return this};LogField.prototype.setUser=function(a){this.user=a;return this};LogField.prototype.setTimeTextSize=function(a){this.timeTextSize=a;return this};LogField.prototype.setStartDate=function(a){this.startDate=a;return this};LogField.prototype.setMessage=function(a){this.message=a;return this};LogField.prototype.setDuration=function(a){this.duration=a;return this};
LogField.prototype.setItems=function(a){this.items=a;return this};LogField.prototype.setCompleted=function(a){this.completed=a;return this};LogField.prototype.setDeleteBtn=function(a){this.deleteBtn=a;return this};
LogField.prototype.createHTML=function(){var a,b;Field.prototype.createHTML.call(this);this.html.style.fontSize="12px";this.html.style.display="table";this.html.style.width="98%";b=this.createHTMLElement("div");b.style.width="70 %";b.style.display="table-cell";a=this.createHTMLElement("img");a.style.width="32px";a.style.height="32px";a.style.cssFloat="left";a.style.marginRight="10px";a.src=this.picture;b.appendChild(a);a=this.createHTMLElement("p");a.innerHTML="<strong>"+this.user+"</strong> "+this.label;
a.style.marginLeft=this.marginLeft+"px";a.style.display="block";b.appendChild(a);a=this.createHTMLElement("time");a.style.color="#707070";a.style.fontSize=this.timeTextSize+"px";a.textContent=this.startDate;b.appendChild(a);this.html.appendChild(b);this.duration&&(b=this.createHTMLElement("div"),b.style.width="10%",b.style.paddingLeft="15px",b.style.display="table-cell",b.style.color="#707070",b.style.fontSize=this.timeTextSize+"px",b.innerHTML="<p> "+this.duration+"</p>",this.durationSection=b,this.html.appendChild(b));
b=this.createHTMLElement("div");b.style.width="2%";b.style.paddingLeft="5px";b.style.display="table-cell";b.style.fontSize=this.timeTextSize+"px";this.completed&&(b.className="adam-completed-log");this.html.appendChild(b);return this.html};
LogField.prototype.attachListeners=function(){var a,b,c,d,e;e=this;$(this.html).click(function(f){a=$(f.currentTarget).attr("id");e.parent.getLogField(a).parent.itemShowed&&e.parent.getLogField(a).parent.itemShowed===a?($("#logPanel").slideToggle(),e.parent.getLogField(a).parent.itemShowed=null):($("#logPanel").remove(),0<e.parent.getLogField(a).items.length?(b=e.createHTMLElement("div"),b.id="logPanel",b.style.display="none",b.style.overflow="auto",b.style.padding="10px",b.style.border="1px solid silver",
b.style.backgroundColor="#FAFAFA",$("#"+a).after(b),"difList"===e.parent.logType?(c=e.parent.getLogField(a).createDifList("before"),$(b).append(c),d=e.createHTMLElement("div"),d.style.width="5%",d.style.cssFloat="left",d.innerHTML="&nbsp;",$(b).append(d),c=e.parent.getLogField(a).createDifList("after"),$(b).append(c),e.parent.getLogField(a).parent.itemShowed=a):b.innerHTML='<h2 style="text-align: center; font-family: Verdana;">"'+e.message+'"<h2>',$("#logPanel").slideToggle()):e.parent.getLogField(a).parent.itemShowed=
null)})};LogField.prototype.createDifList=function(a){var b,c,d="",e,f;b=this.createHTMLElement("div");b.style.width="45%";b.style.position="relative";b.style.cssFloat="left";b.style.backgroundColor="before"===a?"#fdd":"#cfc";for(e=0;e<this.items.length;e+=1)f=this.items[e],c=this.createHTMLElement("p"),d="before"===a?"-":"+",d+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",d+=f.field+": ",d+="before"===a?f.before:f.after,c.innerHTML=d,$(b).append(c);return b};
LogField.prototype.setParent=function(a){this.parent=a;return this};var MessagePanel=function(a){Container.call(this,a);this.windowHeader=this.closeButtonObject=this.modalContainer=this.modalObject=this.modal=null;this.loaded=!1;this.footer=this.message=this.destroyOnHide=null;this.buttons=[];this.headerHeight=this.footerHeight=null;this.positionFixed=!1;MessagePanel.prototype.initObject.call(this,a)};MessagePanel.prototype=new Container;MessagePanel.prototype.type="MessagePanel";
MessagePanel.prototype.classPictureMap={Information:"adam-message-panel-picture-information",Error:"adam-message-panel-picture-error",Warning:"adam-message-panel-picture-warning",Confirm:"adam-message-panel-picture-question"};
MessagePanel.prototype.initObject=function(a){var b={title:"",modal:!0,closeButton:!0,modalHandler:null,destroyOnHide:!1,wtype:"Warning",message:"",footerHeight:40,headerHeight:0,buttons:[],height:100,width:400};$.extend(!0,b,a);this.setTitle(b.title).setModal(b.modal).setVisible(!1).setCloseButton(b.closeButton).setDestroyOnHide(b.destroyOnHide).setMessageType(b.wtype).setMessage(b.message).setFooterHeight(b.footerHeight).setHeaderHeight(b.headerHeight).setButtons(b.buttons).setHeight(b.height).setWidth(b.width);this.modalContainer=
$("body")};MessagePanel.prototype.setTitle=function(a){this.title=a;this.titleLabelObject&&(this.titleLabelObject.innerHTML=a);return this};
MessagePanel.prototype.createHTML=function(){var a,b,c;Container.prototype.createHTML.call(this);parseInt(this.height/2,10);parseInt(this.width/2,10);this.style.addClasses(["adam-message-panel"]);this.style.addProperties({"z-index":1034,left:"50%",top:"50%"});this.height-=16;this.html.style.height=this.height+"px";this.html.tabIndex="-1";c=this.createHTMLElement("div");c.className="adam-message-panel-header";b=this.createHTMLElement("label");b.className="adam-message-panel-title";b.innerHTML=this.title||
"&nbsp;";b.title=b.innerHTML;this.closeButton?(a=this.createHTMLElement("span"),a.className="adam-message-panel-close",c.appendChild(a),this.html.insertBefore(c,this.body),this.closeButtonObject=a):this.html.insertBefore(c,this.body);c.appendChild(b);this.windowHeader=c;this.body&&(this.body.className="adam-message-panel-body",this.body.style.textAlign="center",this.body.style.paddingTop="10px",this.body.style.paddingBottom="10px",a=this.createHTMLElement("div"),a.className=this.classPictureMap[this.wtype],
this.body.appendChild(a),a=this.createHTMLElement("div"),a.className="adam-message-panel-text",a.innerHTML=this.getMessage()||"&nbsp;",this.body.appendChild(a));this.generateButtons(this.wtype);this.footer?this.html.appendChild(this.footer):(a=this.createHTMLElement("div"),a.className="adam-message-panel-footer",this.html.appendChild(a),this.footer=a);for(a=0;a<this.buttons.length;a+=1)this.footer.appendChild(this.buttons[a].getHTML());this.body.style.bottom=this.footerHeight+8+"px";this.footer.style.height=
this.footerHeight+"px";this.footer.style.textAlign="right";this.footer.style.bottom="0px";return this.html};MessagePanel.prototype.show=function(a){this.loaded||this.load(a);this.modal&&(this.modalObject.show(),this.modalObject.html&&(this.modalObject.html.style.zIndex="1034"));this.setHeight($(this.body).innerHeight());document.body.appendChild(this.html);this.setVisible(!0);this.fixPositions()};
MessagePanel.prototype.setModal=function(a){this.modalObject=a?new Modal({clickHandler:this.modalHandler}):null;this.modal=a;return this};MessagePanel.prototype.load=function(a){this.html||(this.createHTML(),this.attachListeners(),this.loaded=!0)};MessagePanel.prototype.setDestroyOnHide=function(a){this.destroyOnHide=a;return this};MessagePanel.prototype.setCloseButton=function(a){this.closeButton=a;return this};
MessagePanel.prototype.attachListeners=function(){var a=this,b,c,d=this;$(this.html).draggable({cursor:"move",scroll:!1,containment:"document"}).on("keydown keyup keypress",function(a){a.stopPropagation()});this.closeButton&&this.closeButtonObject&&$(this.closeButtonObject).click(function(b){b.stopPropagation();a.hide()});for(b=0;b<this.buttons.length;b+=1)this.buttons[b].attachListeners();$("input").blur();$("a").blur();$(this.html).attr("tabindex",-1).focus();setTimeout(function(){$(document).on("focusin",
c)},0);c=function(a){$(a.target).parents().andSelf().is("#"+d.id)||$(d.html).focus()}};MessagePanel.prototype.setMessage=function(a){this.message=a;return this};MessagePanel.prototype.getMessage=function(a){return this.message};MessagePanel.prototype.setMessageType=function(a){this.wtype=a;return this};MessagePanel.prototype.getMessageType=function(a){return this.wtype};
MessagePanel.prototype.hide=function(a){this.modal&&this.modalObject.hide();document.body.removeChild(this.html);this.setVisible(!1);(a||this.destroyOnHide)&&this.close()};MessagePanel.prototype.generateButtons=function(a){var b=this;if(0===this.buttons.length)switch(a){case "Information":case "Error":case "Warning":case "Confirm":this.addButton({jtype:"normal",caption:"OK",handler:function(){b.close()}})}return this};
MessagePanel.prototype.setButtons=function(a){var b;for(b=0;b<a.length;b+=1)this.addButton(a[b],this);return this};MessagePanel.prototype.addButton=function(a){a&&a.family&&"Button"===a.family?a.setParent(this):a=new Button(a,this);a&&this.buttons.push(a)};MessagePanel.prototype.setHeight=function(a){this.setBodyHeight(this.height-this.footerHeight-this.headerHeight);return this};MessagePanel.prototype.setFooterHeight=function(a){this.footerHeight=a;return this};
MessagePanel.prototype.setHeaderHeight=function(a){this.headerHeight=a;return this};MessagePanel.prototype.close=function(){this.visible&&this.hide();this.dispose&&this.dispose()};MessagePanel.prototype.fixPositions=function(){if(!this.positionFixed){var a=$(this.html).width(),b=$(this.html).height(),c=$(this.html).offset(),b=c.top-b/2,a=c.left-a/2;this.html.style.top=b+"px";this.html.style.left=a+"px";this.positionFixed=!0}return this};
var UpdaterField=function(a,b){Field.call(this,a,b);this.fields=[];this.options=[];this.visualObject=this.fieldHeight=null;this.language={};this._variables=[];this._variablesList=this._datePanel=null;this._attachedListeners=!1;this._numberGroupingSeparator=this._decimalSeparator=null;UpdaterField.prototype.initObject.call(this,a)};UpdaterField.prototype=new Field;UpdaterField.prototype.type="UpdaterField";
UpdaterField.prototype.initObject=function(a){var b={fields:[],fieldHeight:null,language:{LBL_ERROR_ON_FIELDS:"Please, correct the fields with errors"},hasCheckbox:!1,decimalSeparator:".",numberGroupingSeparator:","};$.extend(!0,b,a);this.language=b.language;this.setFields(b.fields);this.hasCheckbox=b.hasCheckbox;this._decimalSeparator=b.decimalSeparator;this._numberGroupingSeparator=b.numberGroupingSeparator};
UpdaterField.prototype.setFields=function(a){var b,c=[];for(b=0;b<a.length;b+=1)"FieldUpdater"===a[b].type?(a[b].setParent(this),c.push(a[b])):c.push(void 0);this.fields=c;return this};UpdaterField.prototype.getObjectValue=function(){var a,b=[];for(a=0;a<this.options.length;a+=1)this.options[a].isDisabled()||b.push(this.options[a].getData());this.value=JSON.stringify(b);return Field.prototype.getObjectValue.call(this)};
UpdaterField.prototype._parseSettings=function(a){var b={value:"name",text:"label",type:"fieldType",len:"maxLength",optionItem:"options",required:"required"},c={},d;for(d in a)a.hasOwnProperty(d)&&b[d]&&(c[b[d]]=a[d]);return c};
UpdaterField.prototype.setOptions=function(a){var b,c=[],d,e=[];d={};this.list=a;for(b=0;b<a.length;b+=1){a[b]=this._parseSettings(a[b]);a[b].parent=this;a[b].allowDisabling=this.hasCheckbox;a[b].disabled=this.hasCheckbox;switch(a[b].fieldType){case "TextField":d=new TextUpdaterItem(a[b]);break;case "TextArea":d=new TextAreaUpdaterItem(a[b]);break;case "Date":case "Datetime":d=new DateUpdaterItem(a[b]);break;case "DropDown":e=[];a[b].options instanceof Array?"assigned_user_id"===a[b].value&&(e=[{text:translate("LBL_PMSE_FORM_OPTION_CURRENT_USER"),
value:"currentuser"},{text:translate("LBL_PMSE_FORM_OPTION_RECORD_OWNER"),value:"owner"},{text:translate("LBL_PMSE_FORM_OPTION_SUPERVISOR"),value:"supervisor"}],d=e.concat(a[b].options),a[b].options=d):(a[b].options&&$.each(a[b].options,function(a,b){e.push({value:a,text:b})}),a[b].options=e);d=new DropdownUpdaterItem(a[b]);break;case "Checkbox":d=new CheckboxUpdaterItem(a[b]);break;case "Integer":case "Currency":case "Decimal":case "Float":d=new NumberUpdaterItem(a[b]);break;default:d=new TextUpdaterItem(a[b])}c.push(d)}this.options=
c;this.setOptionsHTML();return this};UpdaterField.prototype.setOptionsHTML=function(){var a,b;if(this.html){this.visualObject.innerHTML="";for(a=0;a<this.options.length;a+=1)b=this.options[a].getHTML(),0===a%2&&(b.className+=" updater-inverse"),this.visualObject.appendChild(b)}return this};UpdaterField.prototype.closePanels=function(){this._datePanel&&this._datePanel.close();this._variablesList&&this._variablesList.close();return this};
UpdaterField.prototype.attachListeners=function(){var a=this;this.html&&!this._attachedListeners&&(jQuery(this.visualObject).on("scroll",function(){jQuery(this.parent.body).trigger("scroll")}),jQuery(this.parent.body).on("scroll",function(){a.closePanels()}),this._attachedListeners=!0);return this};
UpdaterField.prototype.createHTML=function(){var a,b="",c;Field.prototype.createHTML.call(this);this.required&&(b="<i>*</i> ");a=this.createHTMLElement("span");a.className="adam-form-label";a.innerHTML=this.label+": "+b;a.style.width=this.parent.labelWidth;a.style.verticalAlign="top";this.html.appendChild(a);a=this.createHTMLElement("div");a.className="adam-item-updater table";a.id=this.id;if(this.fieldWidth||this.fieldHeight)b=document.createAttribute("style"),this.fieldWidth&&(b.value+="width: "+
this.fieldWidth+"px; "),this.fieldHeight&&(b.value+="height: "+this.fieldHeight+"px; "),b.value+="display: inline-block; margin: 0; overflow: auto; padding: 3px;",a.setAttributeNode(b);for(c=0;c<this.options.length;c+=1)b=this.options[c].getHTML(),0===c%2&&(b.className+=" updater-inverse"),a.appendChild(b);this.html.appendChild(a);this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML());this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML());this.visualObject=a;return this.html};
UpdaterField.prototype.setValue=function(a){this.value=a;if(this.options&&0<this.options.length)try{var b,c,d;if((b=JSON.parse(a))&&0<b.length)for(c=0;c<b.length;c+=1)for(d=0;d<this.options.length;d+=1)if(b[c].field===this.options[d].getName()){this.options[d].enable();this.options[d].setValue(b[c].value);break}}catch(e){}return this};
UpdaterField.prototype.isValid=function(){var a,b=!0,c;for(a=0;a<this.options.length;a+=1){c=this.options[a];if(c.isRequired())switch(c.type){case "CheckboxUpdaterItem":b=c.getValue();break;case "DateUpdaterItem":case "NumberUpdaterItem":b=!!c.getValue().length;break;default:""===c.getValue()&&(b=!1)}c._parent.hasCheckbox&&c.isDisabled()&&(b=!0);if(!b)break}b?($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off"),b=b&&Field.prototype.isValid.call(this)):
(this.visualObject.scrollTop+=getRelativePosition(c.getHTML(),this.visualObject).top,this.errorTooltip.setMessage(this.language.LBL_ERROR_ON_FIELDS),$(this.errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.errorTooltip.html).addClass("adam-tooltip-error-on"));return b};
UpdaterField.prototype._onValueGenerationHandler=function(a){var b=this;return function(c,d,e){d=b.currentField;var f,h,g=d.getValue();f=d._control;this instanceof ExpressionControl?e=c.getValueObject():(e="{::"+a+"::"+e.name+"::}",h=(h=f.selectionStart)||0,f=g.substr(0,h),g=g.substr(h),e=f+e+g);d.setValue(e);c instanceof ExpressionControl||c.close()}};
UpdaterField.prototype.openPanelOnItem=function(a){var b=this;project.getMetadata("targetModuleFieldsDataSource");var c,d,e,f=a.getFieldType();if(a instanceof DateUpdaterItem||a instanceof NumberUpdaterItem){this._datePanel||(this._datePanel=new ExpressionControl({className:"updateritem-panel",onChange:this._onValueGenerationHandler(PROJECT_MODULE),appendTo:this.parent&&this.parent.parent&&this.parent.parent.html||null,decimalSeparator:this._decimalSeparator,numberGroupingSeparator:this._numberGroupingSeparator,
onOpen:function(){jQuery(b.currentField.html).addClass("opened")},onClose:function(){jQuery(b.currentField.html).removeClass("opened")}}));if(!this.currentField||this.currentField.constructor!==a.constructor)a instanceof DateUpdaterItem?this._datePanel.setOperators({arithmetic:["+","-"]}).setConstantPanel({date:!0,timespan:!0}):this._datePanel.setOperators({arithmetic:!0}).setConstantPanel({basic:{number:!0}}),this._datePanel.setVariablePanel({data:[{name:PROJECT_MODULE,value:PROJECT_MODULE,items:this._variables}],
dataFormat:"hierarchical",typeField:"fieldType",typeFilter:a._fieldType,textField:"label",valueField:"name",dataChildRoot:"items",moduleTextField:"name",moduleValueField:"value"});this.currentField=a;this._datePanel.setValue(a.getValue());this._variablesList&&this._variablesList.isOpen()&&this._variablesList.close();e=this._datePanel}else this._variablesList||(this._variablesList=new FieldPanel({className:"updateritem-panel",items:[{type:"list",bodyHeight:100,collapsed:!1,itemsContent:"{{label}}",
fieldToFilter:"type",title:translate("LBL_PMSE_UPDATERFIELD_VARIABLES_LIST_TITLE").replace(/%MODULE%/g,PROJECT_MODULE)}],onItemValueAction:this._onValueGenerationHandler(PROJECT_MODULE),onOpen:function(){jQuery(b.currentField.html).addClass("opened")},onClose:function(){jQuery(b.currentField.html).removeClass("opened")}})),this._datePanel&&this._datePanel.isOpen()&&this._datePanel.close(),e=this._variablesList,d=this._variablesList.getItems()[0],c=d.getFilter(),"TextField"===f||"TextArea"===f||"Name"===
f?"inclusive"===d.getFilterMode()&&d.setFilterMode("exclusive").setDataItems(this._variables,"fieldType",["Checkbox","DropDown"]):1===c.length&&0<c.indexOf(a._fieldType)||d.setFilterMode("inclusive").setDataItems(this._variables,"fieldType",a._fieldType),this.currentField=a;a=a._control;e.getOwner()!==a?(e.close(),e.setOwner(a),e.open()):e.isOpen()?e.close():e.open();return this};UpdaterField.prototype.setVariables=function(a){this._variables=a;return this};
var UpdaterItem=function(a){Element.call(this,a);this._required=this._label=this._name=this._parent=null;this._dom={};this._configButton=this._fieldType=this._value=this._disabled=this._control=this._activationControl=null;this._dirty=this._attachedListeners=!1;this._allowDisabling=!0;UpdaterItem.prototype.init.call(this,a)};UpdaterItem.prototype=new Element;UpdaterItem.prototype.constructor=UpdaterItem;UpdaterItem.prototype.type="UpdaterItem";
UpdaterItem.prototype.init=function(a){var b={parent:null,name:this.id,label:"[updater item]",required:!1,disabled:!0,allowDisabling:!0,value:"",fieldType:null};jQuery.extend(!0,b,a);this.setParent(b.parent).setName(b.name).setLabel(b.label).setRequired(b.required).setValue(b.value).setFieldType(b.fieldType);b.disabled?this.disable():this.enable();b.allowDisabling?this.allowDisabling():this.disallowDisabling()};
UpdaterItem.prototype.allowDisabling=function(){this._allowDisabling=!0;this._activationControl&&(this._activationControl.style.display="");return this};UpdaterItem.prototype.disallowDisabling=function(){this._allowDisabling=!1;this._activationControl&&(this._activationControl.style.display="none")};UpdaterItem.prototype.setParent=function(a){if(!(null===a||a instanceof UpdaterField))throw Error("setParent(): The parameter must be an instance of UpdaterField or null.");this._parent=a;return this};
UpdaterItem.prototype.setName=function(a){if(!("string"===typeof a&&a))throw Error("setName(): The parameter must be a non empty string.");this._name=a;return this};UpdaterItem.prototype.getName=function(){return this._name};UpdaterItem.prototype.setLabel=function(a){if("string"!==typeof a)throw Error("setLabel(): The parameter must be a string.");this._label=a;this._dom.labelText&&(this._dom.labelText.textContent=a);return this};
UpdaterItem.prototype.setRequired=function(a){var b="*";this._required=!!a;this._dom.requiredContainer&&(this._required||(b=""),this._dom.requiredContainer.textContent=b);return this};UpdaterItem.prototype.isRequired=function(){return this._required};UpdaterItem.prototype.isValid=function(){return!(!this._required||!this._value)};UpdaterItem.prototype.clear=function(){this._control&&(this._control.value="");this._value="";return this};
UpdaterItem.prototype.disable=function(){this._activationControl&&(this._activationControl.checked=!1,this._disableControl());this.clear();this._disabled=!0;return this};UpdaterItem.prototype.enable=function(){this._activationControl&&(this._activationControl.checked=!0,this._enableControl());this._disabled=!1;return this};UpdaterItem.prototype.isDisabled=function(){return this._disabled};UpdaterItem.prototype._setValueToControl=function(a){this._control.value=a;return this};
UpdaterItem.prototype._getValueFromControl=function(){return this._control.value};UpdaterItem.prototype.setValue=function(a){if("string"!==typeof a)throw Error("setValue(): The parameter must be a string.");this._control?(this._setValueToControl(a),this._value=this._getValueFromControl()):this._value=a;return this};UpdaterItem.prototype.getValue=function(){return this._value};
UpdaterItem.prototype.setFieldType=function(a){if(!(null===a||"string"===typeof a))throw Error("setFieldType(): The parameter must be a string or null.");this._fieldType=a;return this};UpdaterItem.prototype.getFieldType=function(){return this._fieldType};UpdaterItem.prototype._createControl=function(){if(!this._control)throw Error("_createControl(): This method must be called from anUpdaterItem's subclass.");jQuery(this._control).addClass("updateritem-control");return this._control};
UpdaterItem.prototype._createConfigButton=function(){var a=this.createHTMLElement("a");a.href="#";a.className="adam-itemupdater-cfg icon-cog";return this._configButton=a};UpdaterItem.prototype._disableControl=function(){this._control.disabled=!0;return this};UpdaterItem.prototype._enableControl=function(){this._control.disabled=!1;return this};UpdaterField.prototype.isDirty=function(){return this._dirty};
UpdaterItem.prototype._onChange=function(){var a=this;return function(b){b=a._value;a._value=a._getValueFromControl();a._value!==b&&(a._dirty=!0)}};UpdaterItem.prototype.getData=function(){return{name:this._label,field:this._name,value:this._value,type:this._fieldType}};
UpdaterItem.prototype.attachListeners=function(){var a=this;this.html&&!this._attachedListeners&&(jQuery(this._activationControl).on("change",function(b){b.target.checked?a.enable():a.disable()}),jQuery(this._configButton).on("click",function(b){b.preventDefault();b.stopPropagation();a._parent&&!a._disabled&&a._parent.openPanelOnItem(a)}),jQuery(this._control).on("change",this._onChange()));return this};
UpdaterItem.prototype.createHTML=function(){var a,b,c,d,e,f,h;this.html||(Element.prototype.createHTML.call(this),jQuery(this.html).addClass("updaterfield-item"),this.style.removeProperties("width height position top left z-index".split(" ")),a=this.createHTMLElement("label"),a.className="adam-itemupdater-label",b=this.createHTMLElement("div"),b.className="adam-itemupdater-controlcontainer",c=this.createHTMLElement("input"),c.type="checkbox",c.className="adam-itemupdater-activation",d=this.createHTMLElement("span"),
d.className="adam-itemupdater-labelcontent",e=this.createHTMLElement("span"),e.className="adam-itemupdater-labeltext",f=this.createHTMLElement("span"),f.className="adam-itemupdater-required required noshadow",h=this.createHTMLElement("div"),h.className="adam-itemupdater-message",d.appendChild(e),d.appendChild(f),a.appendChild(c),a.appendChild(d),b.appendChild(this._createControl()),this._createConfigButton(),this._configButton&&b.appendChild(this._configButton),this._dom.labelText=e,this._dom.requiredContainer=
f,this._activationControl=c,this.html.appendChild(a),this.html.appendChild(b),this.html.appendChild(h),this.setLabel(this._label).setRequired(this._required),this._disabled?this.disable():this.enable(),this._allowDisabling?this.allowDisabling():this.disallowDisabling(),this.attachListeners(),this.setValue(this._value));return this.html};var TextUpdaterItem=function(a){UpdaterItem.call(this,a);this._maxLength=null;TextUpdaterItem.prototype.init.call(this,a)};TextUpdaterItem.prototype=new UpdaterItem;
TextUpdaterItem.prototype.constructor=TextUpdaterItem;TextUpdaterItem.prototype.type="TextUpdaterItem";TextUpdaterItem.prototype.init=function(a){var b={maxLength:0};jQuery.extend(!0,b,a);this.setMaxLength(b.maxLength)};
TextUpdaterItem.prototype.setMaxLength=function(a){"string"===typeof a&&/\d+/.test(a)&&(a=parseInt(a,10));if("number"!==typeof a)throw Error("setMaxLength(): The parameter must be a number.");this._maxLength=a;this._control&&(a?this._control.maxLength=a:this._control.removeAttribute("maxlength"));return this};TextUpdaterItem.prototype._createControl=function(){var a=this.createHTMLElement("input");a.type="text";this._control=a;this.setMaxLength(this._maxLength);return UpdaterItem.prototype._createControl.call(this)};
var DateUpdaterItem=function(a){UpdaterItem.call(this,a);DateUpdaterItem.prototype.init.call(this,a)};DateUpdaterItem.prototype=new UpdaterItem;DateUpdaterItem.prototype.constructor=DateUpdaterItem;DateUpdaterItem.prototype.type="DateUpdaterItem";DateUpdaterItem.prototype.init=function(a){var b={value:"[]"};jQuery.extend(!0,b,a);this.setValue(b.value)};DateUpdaterItem.prototype._setValueToControl=function(a){var b="";a.forEach(function(a,d,e){b+=" "+a.expLabel});this._control.value=b;return this};
DateUpdaterItem.prototype.setValue=function(a){"string"===typeof a&&(a=JSON.parse(a||"[]"));this._control&&this._setValueToControl(a);this._value=a;return this};DateUpdaterItem.prototype.clear=function(){UpdaterItem.prototype.clear.call(this);this._value="[]";return this};DateUpdaterItem.prototype._createControl=function(){var a=this.createHTMLElement("input");a.type="text";a.readOnly=!0;this._control=a;return UpdaterItem.prototype._createControl.call(this)};
DateUpdaterItem.prototype._createConfigButton=function(){return null};DateUpdaterItem.prototype.attachListeners=function(){var a=this;this.html&&!this._attachedListeners&&(UpdaterItem.prototype.attachListeners.call(this),jQuery(this._control).on("focus",function(){a._parent&&!this._disabled&&a._parent.openPanelOnItem(a)}),this._attachedListeners=!0)};var CheckboxUpdaterItem=function(a){UpdaterItem.call(this,a)};CheckboxUpdaterItem.prototype=new UpdaterItem;
CheckboxUpdaterItem.prototype.constructor=CheckboxUpdaterItem;CheckboxUpdaterItem.prototype.type="CheckboxUpdaterItem";CheckboxUpdaterItem.prototype.setValue=function(a){this._control?(this._setValueToControl(a),this._value=this._getValueFromControl()):this._value=!!a;return this};CheckboxUpdaterItem.prototype._createControl=function(){var a=this.createHTMLElement("input");a.type="checkbox";this._control=a;return UpdaterItem.prototype._createControl.call(this)};
CheckboxUpdaterItem.prototype._createConfigButton=function(){return null};CheckboxUpdaterItem.prototype.clear=function(){this._control&&(this._control.checked=!1);this._value=!1;return this};CheckboxUpdaterItem.prototype._setValueToControl=function(a){this._control.checked=!!a;return this};CheckboxUpdaterItem.prototype._getValueFromControl=function(){return this._control.checked};
CheckboxUpdaterItem.prototype._onChange=function(){var a=this;return function(b){b=a._value;a._value=a._getValueFromControl();a._value!==b&&(a._dirty=!0)}};var TextAreaUpdaterItem=function(a){TextUpdaterItem.call(this,a)};TextAreaUpdaterItem.prototype=new TextUpdaterItem;TextAreaUpdaterItem.prototype.constructor=TextAreaUpdaterItem;TextAreaUpdaterItem.prototype.type="TextAreaUpdaterItem";TextAreaUpdaterItem.prototype._createControl=function(){this._control=this.createHTMLElement("textarea");return UpdaterItem.prototype._createControl.call(this)};
var NumberUpdaterItem=function(a){UpdaterItem.call(this,a);NumberUpdaterItem.prototype.init.call(this,a)};NumberUpdaterItem.prototype=new UpdaterItem;NumberUpdaterItem.prototype.constructor=NumberUpdaterItem;NumberUpdaterItem.prototype.type="NumberUpdaterItem";NumberUpdaterItem.prototype.init=function(a){var b={value:"[]"};jQuery.extend(!0,b,a);this.setValue(b.value)};
NumberUpdaterItem.prototype._setValueToControl=function(a){var b="";a.forEach(function(a,d,e){b+=" "+a.expLabel});this._control.value=b;return this};NumberUpdaterItem.prototype.setValue=function(a){"string"===typeof a&&(a=JSON.parse(a||"[]"));this._control&&this._setValueToControl(a);this._value=a;return this};NumberUpdaterItem.prototype._createControl=function(){var a=this.createHTMLElement("input");a.type="text";a.readOnly=!0;this._control=a;return UpdaterItem.prototype._createControl.call(this)};
var DropdownUpdaterItem=function(a){UpdaterItem.call(this,a);this._options=[];this._initialized=this._massiveAction=!1;DropdownUpdaterItem.prototype.init.call(this,a)};DropdownUpdaterItem.prototype=new UpdaterItem;DropdownUpdaterItem.prototype.constructor=DropdownUpdaterItem;DropdownUpdaterItem.prototype.type="DropdownUpdaterItem";DropdownUpdaterItem.prototype.init=function(a){var b={options:[],value:""};jQuery.extend(!0,b,a);this.setOptions(b.options).setValue(b.value);this._initialized=!0};
DropdownUpdaterItem.prototype._existsValueInOptions=function(a){var b;for(b=0;b<this._options.length;b+=1)if(this._options[b].value===a)return!0;return!1};DropdownUpdaterItem.prototype._getFirstAvailabelValue=function(){return this._options[0]&&this._options[0].value||""};
DropdownUpdaterItem.prototype.setValue=function(a){if(this._options){if(!("string"===typeof a||"number"===typeof a))throw Error("setValue(): The parameter must be a string.");isInDOM(this._control)?(this._setValueToControl(a),this._value=this._getValueFromControl()):this._existsValueInOptions(a)?this._value=a:this._value=this._getFirstAvailabelValue()}return this};
DropdownUpdaterItem.prototype._paintItem=function(a){var b;b=this.createHTMLElement("option");b.textContent=b.label=a.text;b.value=b.value;this._control.appendChild(b);return this};DropdownUpdaterItem.prototype._paintItems=function(){var a;if(this._control){jQuery(this._control).empty();for(a=0;a<this._options.length;a+=1)this._paintItem(this._options[a])}return this};
DropdownUpdaterItem.prototype.addOption=function(a){a="string"===typeof a||"number"===typeof a?{text:a,value:a}:{text:a.text||a.value,value:a.value||a.text};this._options.push(a);!this._massiveAction&&this.html&&this._paintItem(a);return this};DropdownUpdaterItem.prototype.clearOptions=function(){this._options=[];this._control&&jQuery(this._control).empty();return this};
DropdownUpdaterItem.prototype.setOptions=function(a){var b;if(!jQuery.isArray(a))throw Error("setOptions(): The parameter must be an array.");this._massiveAction=!0;this.clearOptions();for(b=0;b<a.length;b+=1)this.addOption(a[b]);this._massiveAction=!1;this._paintItems();this._initialized&&this.setValue(this._value);return this};DropdownUpdaterItem.prototype._createConfigButton=function(){return null};
DropdownUpdaterItem.prototype._createControl=function(){this._control||(this._control=this.createHTMLElement("select"));return UpdaterItem.prototype._createControl.call(this)};DropdownUpdaterItem.prototype.createHTML=function(){this.html||(UpdaterItem.prototype.createHTML.call(this),this._paintItems(),this.setValue(this._value));return this.html};
var NotePanel=function(a){Panel.call(this,a);this.proxy=this.url=this.proxyEnabled=null;this.loaded=!1;this.data=null;this.callback={};this.dirty=!1;this.buttons=[];this.parent=this.closeContainerOnSubmit=this.headerHeight=this.footerHeight=this.labelWidth=this.footerAlign=null;NotePanel.prototype.initObject.call(this,a)};NotePanel.prototype=new Panel;NotePanel.prototype.type="NotePanel";
NotePanel.prototype.initObject=function(a){var b={url:null,data:null,proxyEnabled:!0,callback:{},buttons:[],footerAlign:"center",labelWidth:"30%",footerHeight:10,headerHeight:0,closeContainerOnSubmit:!1,logType:"message",caseId:null,caseIndex:null};$.extend(!0,b,a);this.setUrl(b.url).setCallback(b.callback);this.caseId=b.caseId;this.caseIndex=b.caseIndex};NotePanel.prototype.setUrl=function(a){this.url=a;return this};NotePanel.prototype.setCallback=function(a){this.callback=a;return this};
NotePanel.prototype.load=function(){this.loaded||(this.proxy&&(this.data=this.proxy.getData()),this.callback.loaded&&this.callback.loaded(this.data,null!==this.proxy),this.attachListeners(),this.loaded=!0)};
NotePanel.prototype.addLog=function(a){var b,c,d,e;c=new LogField(a);c.setParent(this);c.logId=a.logId;b=c.createHTML();d=this.createHTMLElement("a");d.id="deleteNoteBtn";d.innerHTML="Delete";c.durationSection.appendChild(d);c.deleteControl=d;$(d).click(function(a){a.preventDefault();a.stopPropagation();App.alert.show("upload",{level:"process",title:"LBL_LOADING",autoclose:!1});e=new SugarProxy({url:"pmse_Inbox/delete_notes/"+c.logId,callback:null});e.removeData(null,{success:function(a){$(c.html).remove();
App.alert.dismiss("upload")}})});this.body.appendChild(b);this.items.push(c);a.callback&&a.callback.success();return this};NotePanel.prototype.getData=function(){var a,b={};for(a=0;a<this.items.length;a+=1)$.extend(b,this.items[a].getObjectValue());return b};NotePanel.prototype.setDirty=function(a){this.dirty=a;return this};
NotePanel.prototype.attachListeners=function(){var a,b=this,c,d;for(a=0;a<this.items.length;a+=1)this.items[a].attachListeners();$(this.body).mousedown(function(a){a.stopPropagation()});$(this.addNoteBtn).click(function(a){a.preventDefault();a.stopPropagation();App.alert.show("upload",{level:"process",title:"LBL_LOADING",autoclose:!1});var f=App.api.buildFileURL({module:"Users",id:App.user.id,field:"picture"});b.items[0].value&&""!==b.items[0].value.trim()&&(d={not_content:b.items[0].value,cas_id:b.caseId,
cas_index:b.caseIndex,not_user_id:1},c=new SugarProxy({url:"pmse_Inbox/save_notes/",callback:null}),c.createData(d,{success:function(a){a={name:"log",label:b.items[0].value,user:App.user.attributes.full_name,picture:f,duration:"5 Second",startDate:Date.parse(a.date_entered).toString("MMMM d, yyyy HH:mm"),deleteBtn:!0,logId:a.id};b.addLog(a);b.items[0].setValue("");App.alert.dismiss("upload")}}))})};
NotePanel.prototype.setHeight=function(a){Panel.prototype.setHeight.call(this,a);this.setBodyHeight(this.height-this.footerHeight-this.headerHeight);return this};
NotePanel.prototype.createHTML=function(){var a,b,c,d;Panel.prototype.createHTML.call(this);this.footer.style.textAlign=this.footerAlign;for(a=0;a<this.items.length;a+=1)this.items[a].setParent(this),b=this.items[a].getHTML(),c=this.createHTMLElement("a"),c.href="#",c.className="adam-button",c.id="noteBtn",d=this.createHTMLElement("span"),d.className="adam-button-label",d.innerHTML="Add Note",c.appendChild(d),b.appendChild(c),this.addNoteBtn=c,b.removeChild(b.firstChild),this.body.appendChild(b);
this.body.style.bottom="8px";return this.html};NotePanel.prototype.setParent=function(a){this.parent=a;return this};NotePanel.prototype.getLogField=function(a){var b=null,c;for(c=0;c<this.items.length;c+=1)if(this.items[c].id===a){b=this.items[c];break}return b};var ReassignField=function(a,b){Field.call(this,a,b);this.submit=!1;this.items=[];this.comboId=null;ReassignField.prototype.initObject.call(this,a);$.extend(!0,this.defaults,a)};ReassignField.prototype=new Field;
ReassignField.prototype.type="ReassignField";
ReassignField.prototype.initObject=function(a){var b={marginLeft:50,timeTextSize:11,picture:"/img/default_user.png",user:"",message:"default message",items:[],startDate:"3 July 2013",duration:null,completed:!1,options:[],comboId:"comboboxID"};this.act_name=a.act_name;this.cas_delegate_date=a.cas_delegate_date;this.cas_due_date=a.cas_due_date;this.cas_index=a.cas_index;this.defaultValue=a.defaultValue;this.act_expected_time=a.act_expected_time;$.extend(!0,b,a);this.setMarginLeft(b.marginLeft).setPicture(b.picture).setTask(b.task).setTimeTextSize(b.timeTextSize).setStartDate(b.startDate).setMessage(b.message).setDuration(b.duration).setItems(b.items).setCompleted(b.completed).setOptions(b.options).setComboId(b.comboId)};
ReassignField.prototype.setMarginLeft=function(a){this.marginLeft=a;return this};ReassignField.prototype.setPicture=function(a){this.picture=a;return this};ReassignField.prototype.setTask=function(a){this.task=a;return this};ReassignField.prototype.setTimeTextSize=function(a){this.timeTextSize=a;return this};ReassignField.prototype.setStartDate=function(a){this.startDate=a;return this};ReassignField.prototype.setMessage=function(a){this.message=a;return this};
ReassignField.prototype.setDuration=function(a){this.duration=a;return this};ReassignField.prototype.setItems=function(a){this.items=a;return this};ReassignField.prototype.setCompleted=function(a){this.completed=a;return this};ReassignField.prototype.setOptions=function(a){this.options=a;return this};ReassignField.prototype.setComboId=function(a){this.comboId=a;return this};
ReassignField.prototype.createTableHeaders=function(){var a,b,c,d;d=this.createHTMLElement("div");d.style.fontSize="12px";d.style.display="table";d.style.width="97%";for(a=0;a<this.parent.columns.length;a+=1)b=this.createHTMLElement("div"),b.style.width="20%",b.style.display="table-cell",c=this.createHTMLElement("p"),c.innerHTML="<strong>"+this.parent.columns[a]+"</strong> ",b.appendChild(c),d.appendChild(b);this.html.appendChild(d);this.parent.hasHeaders=!0};
ReassignField.prototype.createHTML=function(){var a,b,c,d;Field.prototype.createHTML.call(this);this.parent.hasHeaders||this.createTableHeaders();d=this.createHTMLElement("div");d.style.fontSize="12px";d.style.display="table";d.style.width="97%";b=this.createHTMLElement("div");b.style.width="20%";b.style.display="table-cell";b.style.marginLeft="5px";a=this.createHTMLElement("p");a.innerHTML=this.act_name;b.appendChild(a);d.appendChild(b);b=this.createHTMLElement("div");b.style.width="20%";b.style.display=
"table-cell";b.style.marginLeft="5px";a=this.createHTMLElement("p");a.innerHTML=this.cas_delegate_date;b.appendChild(a);d.appendChild(b);b=this.createHTMLElement("div");b.style.width="20%";b.style.display="table-cell";b.style.marginLeft="5px";a=this.createHTMLElement("p");a.innerHTML=this.act_expected_time;b.appendChild(a);d.appendChild(b);b=this.createHTMLElement("div");b.style.width="20%";b.style.display="table-cell";b.style.marginLeft="5px";a=this.createHTMLElement("p");a.innerHTML=this.cas_due_date;
b.appendChild(a);d.appendChild(b);a=this.createHTMLElement("div");a.style.width="20%";a.style.display="table-cell";b.style.marginLeft="5px";a.style.fontSize=this.timeTextSize+"px";b=this.createHTMLElement("select");b.id=this.comboId;for(c=0;c<this.options.length;c+=1)b.appendChild(this.generateOption(this.options[c]));this.control=b;a.appendChild(b);d.appendChild(a);this.html.appendChild(d);return this.html};
ReassignField.prototype.generateOption=function(a){var b,c,d;b=this.createHTMLElement("option");"object"===typeof a?(c=a.value,d=a.text):c=a;b.selected=this.defaultValue===c;b.value=c;b.label=d||c;b.appendChild(document.createTextNode(d||c));return b};ReassignField.prototype.attachListeners=function(){};
ReassignField.prototype.createDifList=function(a){var b,c,d="",e,f;b=this.createHTMLElement("div");b.style.width="45%";b.style.position="relative";b.style.cssFloat="left";b.style.backgroundColor="before"===a?"#fdd":"#cfc";for(e=0;e<this.items.length;e+=1)f=this.items[e],c=this.createHTMLElement("p"),d="before"===a?"-":"+",d+="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",d+=f.field+": ",d+="before"===a?f.before:f.after,c.innerHTML=d,$(b).append(c);return b};
ReassignField.prototype.setParent=function(a){this.parent=a;return this};ReassignField.prototype.getObjectValue=function(){var a={};a.cas_id=this.comboId;a.cas_user_id=this.control.value;a.cas_index=this.cas_index;a.old_cas_user_id=this.defaultValue;return a};var ReassignForm=function(a){Form.call(this,a);ReassignForm.prototype.initObject.call(this,a)};ReassignForm.prototype=new Form;ReassignForm.prototype.type="ReassignForm";
ReassignForm.prototype.initObject=function(a){var b={columns:[]};this.hasHeaders=!1;$.extend(!0,b,a);this.setColumns(b.columns)};ReassignForm.prototype.setColumns=function(a){this.columns=a};var DataItem=function(a){Element.call(this,a);this._parent=null;this._data={};this._text=null;this._eventListenersAttached=!1;this.onClick=this._htmlItemContent=null;this._disabled=!1;DataItem.prototype.init.call(this,a)};DataItem.prototype=new Element;DataItem.prototype.constructor=DataItem;
DataItem.prototype.type="DataItem";DataItem.prototype.init=function(a){var b={data:{},onClick:null,text:"[item]",parent:null,disabled:!1};jQuery.extend(!0,b,a);this.setFullData(b.data).setOnClickHandler(b.onClick).setText(b.text).setParent(b.parent);b.disabled?this.disable():this.enable()};DataItem.prototype.disable=function(){this.html&&this.style.addClasses(["adam-disabled"]);this._disabled=!0;return this};
DataItem.prototype.enable=function(){this.html&&this.style.removeClasses(["adam-disabled"]);this._disabled=!1;return this};DataItem.prototype.setParent=function(a){if(!(null===a||a instanceof ItemContainer))throw Error("setParent(): The parameter must be an instace of ItemContainer or null.");this._parent=a;return this};DataItem.prototype.getParent=function(){return this._parent};
DataItem.prototype._getFinalText=function(){var a,b,c;b=this._text;if("string"===typeof b)if(a=b.match(/^\{\{([a-zA-z0-9\.\-]+)\}\}$/)){a=a[1].split(".");b=this._data;for(c=0;c<a.length&&!(b=b[a[c]],!b);c++);a=b&&"object"!==typeof b?b:""}else a=b;else a=this._text(this,this.getData())||"";return a};
DataItem.prototype.setText=function(a){if(!("string"===typeof a||"function"===typeof a))throw Error("setText(): The parameter must be a string or function.");this._text=a;this._htmlTextContainer&&(this._htmlTextContainer.textContent=this._getFinalText());return this};DataItem.prototype.getText=function(){return this._htmlTextContainer?this._htmlTextContainer.textContent:this._getFinalText()};
DataItem.prototype.setOnRemoveHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnRemoveHandler(): The parameter must be a function or null.");this.onRemove=a;return this};DataItem.prototype.setOnClickHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnClickHandler(): The parameter must be a function or null.");this.onClick=a;return this};DataItem.prototype.clearData=function(a){void 0===a?this._data={}:delete this._data[a];return this};
DataItem.prototype.setData=function(a,b){this._data[a]=b;return this};DataItem.prototype.setFullData=function(a){var b;this.clearData();for(b in a)a.hasOwnProperty(b)&&this.setData(b,a[b]);this._htmlTextContainer&&this.setText(this._text);return this};DataItem.prototype._onClick=function(){var a=this;return function(b){b.preventDefault();b.stopPropagation();if("function"===typeof a.onClick&&!a._disabled)a.onClick(a)}};
DataItem.prototype.getData=function(){var a={},b;for(b in this._data)a[b]=this._data[b];return a};DataItem.prototype._attachListeners=function(){this.html&&!this._eventListenersAttached&&(jQuery(this._htmlItemContent).on("click",this._onClick()),this._eventListenersAttached=!0);return this};DataItem.prototype.createHTML=function(){throw Error("createHTML(): Calling an abstract method in DataItem.");};
var SingleItem=function(a){DataItem.call(this,a);this._htmlItemContent=this._htmlRemoveButton=this._htmlIconContainer=this._htmlTextContainer=this.onRemove=null;SingleItem.prototype.init.call(this,a)};SingleItem.prototype=new DataItem;SingleItem.prototype.constructor=SingleItem;SingleItem.prototype.init=function(a){var b={onRemove:null,removable:!0};jQuery.extend(!0,b,a);this.setOnRemoveHandler(b.onRemove)};
SingleItem.prototype.disable=function(){this.html&&(this._htmlRemoveButton.style.display="none");return DataItem.prototype.disable.call(this)};SingleItem.prototype.enable=function(){this.html&&(this._htmlRemoveButton.style.display="");return DataItem.prototype.enable.call(this)};SingleItem.prototype.setOnRemoveHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnRemoveHandler(): The parameter must be a function or null.");this.onRemove=a;return this};
SingleItem.prototype._onRemoveButtonClick=function(){var a=this;return function(b){b.preventDefault();b.stopPropagation();if("function"===typeof a.onRemove)a.onRemove(a)}};SingleItem.prototype._attachListeners=function(){this.html&&!this._eventListenersAttached&&(DataItem.prototype._attachListeners.call(this),jQuery(this._htmlRemoveButton).on("click",this._onRemoveButtonClick()),jQuery(this.html).on("focus focusin focusout blur",function(a){a.stopPropagation()}),this._eventListenersAttached=!0);return this};
SingleItem.prototype.createHTML=function(){var a,b,c,d;if(this.html)return this.html;this.html=this.createHTMLElement("li");this.html.id=this.id;this.html.className="adam single-item";a=this.createHTMLElement("span");a.className="adam single-item-text";b=this.createHTMLElement("span");b.className="adam single-item-icon";d=this.createHTMLElement("a");d.className="adam single-item-content";d.href="#";c=this.createHTMLElement("a");c.href="#";c.className="adam single-item-remove icon-remove-sign";d.appendChild(b);
d.appendChild(a);this.html.appendChild(d);this.html.appendChild(c);this._htmlTextContainer=a;this._htmlIconContainer=b;this._htmlRemoveButton=c;this._htmlItemContent=d;this.setText(this._text);this._disabled?this.disable():this.enable();return this._attachListeners().html};var ListItem=function(a){DataItem.call(this,a);ListItem.prototype.init.call(this,a)};ListItem.prototype=new DataItem;ListItem.prototype.constructor=ListItem;ListItem.prototype.type="ListItem";
ListItem.prototype.init=function(a){var b={text:"[listitem]"};jQuery.extend(!0,b,a);this.setText(b.text)};ListItem.prototype.setVisible=function(a){_.isBoolean(a)&&(this.visible=a,this.html&&(a?this.style.addProperties({display:""}):this.style.addProperties({display:"none"})));return this};
ListItem.prototype.setText=function(a){if(!("string"===typeof a||"function"===typeof a))throw Error("setText(): The parameter must be a string or function.");this._text=a;this._htmlItemContent&&(a=this._getFinalText(),isHTMLElement(a)?this._htmlItemContent.appendChild(a):this._htmlItemContent.textContent=a);return this};
ListItem.prototype.createHTML=function(){this.html||(this.html=this.createHTMLElement("li"),this.html.className="adam list-item",this._htmlItemContent=this.html,this.setText(this._text),this._attachListeners(),this.setVisible(this.visible));return this.html};
var ItemContainer=function(a){Element.call(this,a);this._items=new ArrayList;this._massiveAction=!1;this._textInputMode=this.onInputChar=this.onSelect=this.onRemoveItem=this.onAddItem=null;this._textInputs=new ArrayList;this._blurTimer=this.onFocus=this.onBlur=this._className=this.onBeforeAddItemByInput=this._selectedIndex=this._inputValidationFunction=null;this._blurSemaphore=this._blurred=!0;this._disabled=!1;ItemContainer.prototype.init.call(this,a)};ItemContainer.prototype=new Element;
ItemContainer.prototype.constructor=ItemContainer;ItemContainer.prototype.textInputMode={NONE:0,END:1,ALL:2};
ItemContainer.prototype.init=function(a){var b={items:[],onAddItem:null,onRemoveItem:null,width:200,height:80,textInputMode:this.textInputMode.ALL,inputValidationFunction:null,onBeforeAddItemByInput:null,onSelect:null,onInputChar:null,onBlur:null,onFocus:null,className:"",disbaled:!1};jQuery.extend(!0,b,a);if("number"!==typeof b.textInputMode)throw Error("init(): The textInputMode config option must be a number");this._textInputMode=b.textInputMode;this.setWidth(b.width).setHeight(b.height).setItems(b.items).setOnAddItemHandler(b.onAddItem).setInputValidationFunction(b.inputValidationFunction).setOnBeforeAddItemByInput(b.onBeforeAddItemByInput).setOnRemoveItemHandler(b.onRemoveItem).setOnSelectHandler(b.onSelect).setOnInputCharHandler(b.onInputChar).setOnBlurHandler(b.onBlur).setOnFocusHandler(b.onFocus).setClassName(b.className);
b.disabled?this.disable():this.enable()};ItemContainer.prototype.getText=function(){var a,b=this._items.asArray(),c="";for(a=0;a<b.length;a+=1)c+=" "+b[a].getText();return c.substr(1)};ItemContainer.prototype.setWidth=function(a){if(!("number"===typeof a||"string"===typeof a&&("auto"===a||/^\d+(\.\d+)?(em|px|pt|%)?$/.test(a))))throw Error("setWidth(): invalid parameter.");this.width=a;this.html&&this.style.addProperties({width:this.width});return this};
ItemContainer.prototype.disable=function(){var a,b;if(!this._disabled){b=this._items.asArray();for(a=0;a<b.length;a+=1)b[a].disable();jQuery(this.html).find("input").attr("disabled",!0);this._disabled=!0}return!0};ItemContainer.prototype.enable=function(){if(this._disabled){items=this._items.asArray();for(i=0;i<items.length;i+=1)items[i].enable();jQuery(this.html).find("input").attr("disabled",!1);this._disabled=!1}return this};
ItemContainer.prototype.setClassName=function(a){if("string"!==typeof a)throw Error("setClassName(): The parameter must be a string.");this.style.addClasses([a]);return this};ItemContainer.prototype.setOnFocusHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnFocusHandler(): The parameter must be a function or null.");this.onFocus=a;return this};
ItemContainer.prototype.setOnBlurHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnBlurHandler(): The parameter must be a function or null.");this.onBlur=a;return this};ItemContainer.prototype.setOnInputCharHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnInputCharHandler(): The parameter must be a function or null.");this.onInputChar=a;return this};
ItemContainer.prototype.setOnSelectHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnSelectHandler(): The parameter must be a function or null.");this.onSelect=a;return this};ItemContainer.prototype.setOnBeforeAddItemByInput=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnBeforeAddItemByInput(): The parameter must be a function or null.");this.onBeforeAddItemByInput=a;return this};
ItemContainer.prototype.setInputValidationFunction=function(a){if(!(null===a||"function"===typeof a))throw Error("setInputValidationFunction(): The parameter must be a function or null.");this._inputValidationFunction=a;return this};ItemContainer.prototype.setOnAddItemHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnAddItemHandler(): The parameter must be a function or null.");this.onAddItem=a;return this};
ItemContainer.prototype.setOnRemoveItemHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnRemoveItemHandler(): The parameter must be a function or null.");this.onRemoveItem=a;return this};
ItemContainer.prototype._addInputText=function(a){var b=this.createHTMLElement("input");b.className="adam item-container-input";b.disabled=this._disabled;this._textInputs.insert(b);this.html&&("number"===typeof a&&(a=this._items.get(a)),a&&a instanceof SingleItem?this.html.insertBefore(b,a.getHTML()):this.html.appendChild(b));return this};
ItemContainer.prototype.clearItems=function(){jQuery(this.html).empty();this._items.clear();this._textInputs.clear();this._textInputMode!==this.textInputMode.NONE&&this._addInputText();return this};ItemContainer.prototype.isParentOf=function(a){return this===a.getParent()};
ItemContainer.prototype._paintItem=function(a,b){this.html&&this.isParentOf(a)&&("number"===typeof b?0===b?jQuery(this.html).prepend(a.getHTML()):b<this._items.getSize()-1?jQuery(this.html).find(".item-container-input").eq(b).before(a.getHTML()):jQuery(this.html).find(".item-container-input").last().before(a.getHTML()):this._textInputMode===this.textInputMode.NONE?this.html.appendChild(a.getHTML()):jQuery(this.html).find(".item-container-input").last().before(a.getHTML()),this._textInputMode===this.textInputMode.ALL&&
this._addInputText(b||a));return this};ItemContainer.prototype._paintItems=function(){var a,b=this._items.asArray();if(this.html){this._textInputMode===this.textInputMode.ALL&&this._addInputText();for(a=0;a<b.length;a++)this._paintItem(b[a]);this._textInputMode===this.textInputMode.END&&this._addInputText()}return this};ItemContainer.prototype._onRemoveItemHandler=function(){var a=this;return function(b){a.removeItem(b);if("function"===typeof a.onRemoveItem)a.onRemoveItem(a,b)}};
ItemContainer.prototype.addItem=function(a,b,c){if(!(a instanceof SingleItem||"object"===typeof a))throw Error("The paremeter must be an object literal or null.");a instanceof SingleItem||(a=new SingleItem(a));a.setParent(this);a.setOnRemoveHandler(this._onRemoveItemHandler());"number"===typeof b&&0<=b?this._items.insertAt(a,b):this._items.insert(a);this._massiveAction||(this._paintItem(a,b),!c&&jQuery(a.getHTML()).next().get(0)!==jQuery(":focus").get(0)?jQuery(a.getHTML()).next().focus():(this._selectedIndex+=
1,this.html&&(this.html.scrollTop+=this.html.scrollHeight)));"function"===typeof this.onAddItem&&(a="number"===typeof b&&0<=b?this._items.get(b):this._items.get(this._items.getSize()-1),this.onAddItem(this,a,b));return this};ItemContainer.prototype.removeItem=function(a){this.isParentOf(a)&&(this._items.remove(a),jQuery(a.getHTML()).prev(".item-container-input").remove().end().next().focus().end().remove());return this};
ItemContainer.prototype.setVisible=function(a){_.isBoolean(a)&&(this.visible=a,this.html&&(a?this.style.addProperties({display:""}):this.style.addProperties({display:"none"})));return this};ItemContainer.prototype.setItems=function(a){var b;if(!jQuery.isArray(a))throw Error("setItems(): The parameter must be an array.");this._massiveAction=!0;this.clearItems();for(b=0;b<a.length;b++)this.addItem(a[b]);this._paintItems();this._massiveAction=!1;return this};ItemContainer.prototype.getItems=function(){return this._items.asArray()};
ItemContainer.prototype._getTextWidth=function(a,b){var c,d;c=this.createHTMLElement("span");d=window.getComputedStyle(b);c.style.padding=0;c.style.fontFamily=d.getPropertyValue("font-family");c.style.fontSize=d.getPropertyValue("font-size");c.style.fontWeight=d.getPropertyValue("font-weight");c.style.whiteSpace="nowrap";c.style.display="none";c.textContent=a.replace(/\s/g,"_");b.parentNode.appendChild(c);d=jQuery(c);c=d.outerWidth();d.remove();return c};
ItemContainer.prototype._isValidInput=function(a){var b=!0;"function"===typeof this._inputValidationFunction&&(b=this._inputValidationFunction(this,a));return b};ItemContainer.prototype.select=function(a){if(this.html&&!this._disabled&&("number"===typeof a?jQuery(this.html).find(".adam.item-container-input").eq(a).focus():jQuery(this.html).find(".adam.item-container-input").last().focus(),"function"===typeof this.onSelect))this.onSelect(this);return this};
ItemContainer.prototype.getData=function(){var a=[],b=this._items.asArray();for(i=0;i<b.length;i+=1)a.push(b[i].getData());return a};ItemContainer.prototype.getSelectedIndex=function(){return this._selectedIndex};ItemContainer.prototype._onBlur=function(){var a=this;return function(){clearInterval(a._blurTimer);"function"===typeof a.onBlur&&(a._blurred=!0,a.onBlur(a))}};
ItemContainer.prototype._attachListeners=function(){var a,b="";this.html&&(a=this,jQuery(this.html).on("mousedown",function(){a._blurred||(a._blurSemaphore=!1)}).on("click",function(){a._blurSemaphore=!0;a.select()}).on("focusin",function(b){clearInterval(a._blurTimer);a._blurred&&("function"===typeof a.onFocus&&a._blurSemaphore)&&(a._blurred=!1,a.onFocus(a))}).on("focusout",function(b){a._blurred||(a._blurTimer=setInterval(a._onBlur(),20))}).on("focus",".adam.item-container-input",function(){a._selectedIndex=
$(this.parentNode).find("input").index(this)}).on("click",".adam.item-container-input",function(a){a.stopPropagation()}).on("focusout",".adam.item-container-input",function(b){a._blurSemaphore||(b.stopPropagation(),a._blurSemaphore=!0)}).on("keydown",".adam.item-container-input",function(b){var d,e;switch(b.keyCode){case 37:case 39:b.shiftKey&&(d=jQuery(a.html).find(".adam.item-container-input").index(this),b=jQuery(a.html).find(".adam.item-container-input").eq(d+(37===b.keyCode?-1:1)),b.length&&
(this.value="",this.style.width="1px",b.get(0).focus()));break;case 27:this.value="";break;case 13:b.preventDefault();a._isValidInput(this.value)&&(b=new SingleItem({text:this.value}),d=jQuery(a.html).find(".adam.item-container-input").index(this),"function"===typeof a.onBeforeAddItemByInput&&(e=a.onBeforeAddItemByInput(a,b,this.value,d),!1===e?b=null:e instanceof SingleItem&&(b=e)),b instanceof SingleItem&&a.addItem(b,d),this.value="",this.style.width="1px");this.select();break;default:try{d=(d=
b.originalEvent.keyIdentifier)?eval('"\\u'+d.replace(/(U\+)/,"")+'"'):"string"===typeof b.char?b.char:String.fromCharCode(b.which)}catch(f){d=""}d=this.selectionStart!==this.selectionEnd?String.fromCharCode(b.keyCode):this.value+d;d=a._getTextWidth(d,this)||1;this.style.width=d+"px"}}).on("keyup",".adam.item-container-input",function(c){var d;try{d=(d=c.originalEvent.keyIdentifier)?eval('"\\u'+d.replace(/(U\+)/,"")+'"'):"string"===typeof c.char?c.char:String.fromCharCode(c.which)}catch(e){}if((d||
b!==this.value)&&"function"===typeof a.onInputChar)a.onInputChar(a,d,this.value,c.keyCode);b=this.value}).on("blur",".adam.item-container-input",function(){""!==this.value&&(this.value="",this.style.width="1px")}));return this};
ItemContainer.prototype.createHTML=function(){this.html||(this.html=this.createHTMLElement("ul"),this.html.className="adam item-container",this.style.applyStyle(),this.style.addProperties({left:this.x,top:this.y,width:this.width,height:this.height,zIndex:this.zOrder}),this._paintItems(),this._attachListeners(),this.setVisible(this.visible));return this.html};var FieldPanelItem=function(a){Element.call(this,a);this.onValueAction=this._parent=null;FieldPanelItem.prototype.init.call(this,a)};
FieldPanelItem.prototype=new Element;FieldPanelItem.prototype.constructor=FieldPanelItem;FieldPanelItem.prototype.family="FieldPanelItem";FieldPanelItem.prototype.type="FieldPanelItem";FieldPanelItem.prototype.init=function(a){var b={parent:null,onValueAction:null};jQuery.extend(!0,b,a);this.setParent(b.parent).setOnValueActionHandler(b.onValueAction)};
FieldPanelItem.prototype.setParent=function(a){if(!(null===a||a instanceof FieldPanel))throw Error("setParent(): The parameter must be an instance of FieldPanel or null.");this._parent=a;return this};FieldPanelItem.prototype.getParent=function(){return this._parent};FieldPanelItem.prototype.setVisible=function(a){this.visible=!!a;this.html&&(a?this.style.addProperties({display:""}):this.style.addProperties({display:"none"}));return this};
FieldPanelItem.prototype.setOnValueActionHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnValueActionHandler(): The parameter must be a function or null.");this.onValueAction=a;return this};FieldPanelItem.prototype._onValueAction=function(a){if("function"===typeof this.onValueAction)this.onValueAction(this,this.getValueObject(a));return this};FieldPanelItem.prototype.getValueObject=function(){throw Error("getValueObject(): Trying to call an abstract method.");};
var FieldPanelButton=function(a){FieldPanelItem.call(this,a);this._value=this._text=null;FieldPanelButton.prototype.init.call(this,a)};FieldPanelButton.prototype=new FieldPanelItem;FieldPanelButton.prototype.constructor=FieldPanelButton;FieldPanelButton.prototype.type="FieldPanelButton";FieldPanelButton.prototype.init=function(a){var b={text:"[button]",value:""};jQuery.extend(!0,b,a);this.setText(b.text).setValue(b.value)};
FieldPanelButton.prototype.setValue=function(a){if("string"!==typeof a)throw Error("setValue(): The parameter must be a string.");this._value=a;return this};FieldPanelButton.prototype.setText=function(a){if("string"!==typeof a)throw Error("setText(): The parameter must be a string.");this.html&&(this.html.textContent=a);this._text=a;return this};FieldPanelButton.prototype._onClickHandler=function(){var a=this;return function(b){b.preventDefault();a._onValueAction()}};
FieldPanelButton.prototype._attachListeners=function(){if(this.html)jQuery(this.html).on("click",this._onClickHandler());return this};FieldPanelButton.prototype.createHTML=function(){this.html||(this.html=this.createHTMLElement("a"),this.html.href="#",this.html.className="adam field-panel-button btn btn-mini btn-block",this.setText(this._text).setVisible(this.visible),this._attachListeners());return this.html};FieldPanelButton.prototype.getValueObject=function(){return{text:this._text,value:this._value}};
var FieldPanelButtonGroup=function(a){FieldPanelItem.call(this,a);this._items=new ArrayList;this._htmlItemsContainer=this._htmlLabel=this._label=null;this._massiveAction=!1;FieldPanelButtonGroup.prototype.init.call(this,a)};FieldPanelButtonGroup.prototype=new FieldPanelItem;FieldPanelButtonGroup.prototype.constructor=FieldPanelButtonGroup;FieldPanelButtonGroup.prototype.type="FieldPanelButtonGroup";FieldPanelButtonGroup.prototype.init=function(a){var b={items:[],label:""};jQuery.extend(!0,b,a);this.setItems(b.items).setLabel(b.label)};
FieldPanelButtonGroup.prototype.setLabel=function(a){if("string"!==typeof a)throw Error("setLabel(): The parameter must be a string.");this._label=a;this._htmlLabel&&(this._label?(jQuery(this.html).prepend(this._htmlLabel),this._htmlLabel.textContent=a):jQuery(this._htmlLabel).remove());return this};FieldPanelButtonGroup.prototype.clearItems=function(){this._items.clear();this._htmlItemsContainer&&jQuery(this._htmlItemsContainer).empty();return this};
FieldPanelButtonGroup.prototype._paintItem=function(a){var b=this;a.html||(a.html=this.createHTMLElement("button"),a.html.className="adam field-panel-button-group-button btn btn-mini",a.html.appendChild(document.createTextNode(a.text)),jQuery(a.html).on("click",function(){b._onValueAction(a)}));this._htmlItemsContainer.appendChild(a.html);return this};
FieldPanelButtonGroup.prototype.addItem=function(a){a={text:a.text||a.value||"[button]",value:a.value||a.text||null,html:null};this._items.insert(a);!this._massiveAction&&this._htmlItemsContainer&&this._paintItem(a);return this};FieldPanelButtonGroup.prototype._paintItems=function(){var a,b;if(this.html){b=this._items.asArray();for(a=0;a<b.length;a+=1)this._paintItem(b[a])}return this};
FieldPanelButtonGroup.prototype.setItems=function(a){var b;if(!jQuery.isArray(a))throw Error("setItems(): The parameter must be an array.");this._massiveAction=!0;this.clearItems();for(b=0;b<a.length;b+=1)this.addItem(a[b]);this._paintItems();this._massiveAction=!1;return this};FieldPanelButtonGroup.prototype.getItems=function(){return this._items.asArray()};FieldPanelButtonGroup.prototype.getValueObject=function(a){return{text:a.text,value:a.value}};
FieldPanelButtonGroup.prototype.createHTML=function(){this.html||(this.html=this.createHTMLElement("div"),this.html.className="adam field-panel-button-group",this._htmlLabel=this.createHTMLElement("span"),this._htmlLabel.className="adam field-panel-button-group-label",this._htmlItemsContainer=this.createHTMLElement("div"),this._htmlItemsContainer.className="adam field-panel-button-container btn-group",this.html.appendChild(this._htmlLabel),this.html.appendChild(this._htmlItemsContainer),this.setLabel(this._label)._paintItems().setVisible(this.visible));
return this.html};
var CollapsiblePanel=function(a){FieldPanelItem.call(this,a);this._items=new ArrayList;this._title="";this._massiveAction=!1;this._attachedListeners=this.onExpand=this.onCollapse=this._collapsed=this._htmlTitleContainer=this._htmlCollapsibleIcon=this._bodyHeight=this._htmlBody=this._htmlTitle=this._htmlHeader=null;this._initialized=!1;this._enabledAnimations=null;this._disabled=!1;this._onEnablementStatusChange=null;this._headerVisible=!1;CollapsiblePanel.prototype.init.call(this,a)};
CollapsiblePanel.prototype=new FieldPanelItem;CollapsiblePanel.prototype.constructor=CollapsiblePanel;CollapsiblePanel.prototype.type="CollapsiblePanel";
CollapsiblePanel.prototype.init=function(a){var b={title:"[panel]",items:[],bodyHeight:"auto",collapsed:!0,width:"100%",onCollapse:null,onExpand:null,enabledAnimations:!0,disabled:!1,onEnablementStatusChange:null,headerVisible:!0};jQuery.extend(!0,b,a);b.enabledAnimations?this.enableAnimations():this.disableAnimations();b.disabled?this.disable():this.enable();this.setWidth(b.width).setTitle(b.title).setItems(b.items).setBodyHeight(b.bodyHeight).setOnCollapseHandler(b.onCollapse).setOnExpandHandler(b.onExpand).setOnEnablementStatusChangeHandler(b.onEnablementStatusChange);
b.collapsed?this.collapse():this.expand();b.headerVisible?this.showHeader():this.hideHeader();this._initialized=!0};CollapsiblePanel.prototype.showHeader=function(){this._headerVisible=!0;this._htmlHeader&&(this._htmlHeader.style.display="");return this};CollapsiblePanel.prototype.hideHeader=function(){this._headerVisible=!1;this._htmlHeader&&(this._htmlHeader.style.display="none");return this};
CollapsiblePanel.prototype.setOnEnablementStatusChangeHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnEnablementStatusChangeHandler(): The parameter must be a function or null.");this.onEnablementStatusChange=a;return this};CollapsiblePanel.prototype.isDisabled=function(){return this._disabled};
CollapsiblePanel.prototype.disable=function(){if(!this._disabled&&(this.collapse(),this.style.addClasses(["collapsible-panel-disabled"]),this._disabled=!0,"function"===typeof this.onEnablementStatusChange))this.onEnablementStatusChange(this,!1);return this};CollapsiblePanel.prototype.enable=function(){if(this._disabled&&(this.style.removeClasses(["collapsible-panel-disabled"]),this._disabled=!1,"function"===typeof this.onEnablementStatusChange))this.onEnablementStatusChange(this,!0);return this};
CollapsiblePanel.prototype.setParent=function(a){if(!(null===a||a instanceof FieldPanel||a instanceof MultipleCollapsiblePanel))throw Error("setParent(): The parameter must be an instance of FieldPanel, MultipleCollapsiblePanel or null.");this._parent=a;return this};CollapsiblePanel.prototype.enableAnimations=function(){this._enabledAnimations=!0;return this};CollapsiblePanel.prototype.disableAnimations=function(){this._enabledAnimations=!1;return this};
CollapsiblePanel.prototype.setOnExpandHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnExpandHandler(): The paremeter must be a function or null.");this.onExpand=a;return this};CollapsiblePanel.prototype.setOnCollapseHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnCollapseHandler(): The paremeter must be a function or null.");this.onCollapse=a;return this};
CollapsiblePanel.prototype.setWidth=function(a){if("number"===typeof a)Element.prototype.setWidth(a);else if(/^\d+(.\d+)?(px|%)?$/.test(a))this.width=a,this.html&&this.style.addProperties({width:a});else throw Error("setWidth(): The parameter must be a number or a valid number/unit formatted string.");return this};CollapsiblePanel.prototype.isCollapsed=function(){return this._collapsed};
CollapsiblePanel.prototype.collapse=function(a){this._collapsed=!0;if(this._htmlBody&&(jQuery(this._htmlCollapsibleIcon).removeClass("icon-double-angle-down").addClass("icon-double-angle-right"),isInDOM(this.html)?!this._enabledAnimations||a?jQuery(this._htmlBody).stop(!0,!0).hide():jQuery(this._htmlBody).stop(!0,!0).slideUp():this._htmlBody.style.display="none",this._initialized&&"function"===typeof this.onCollapse))this.onCollapse(this);return this};
CollapsiblePanel.prototype.expand=function(a){this._collapsed=!1;if(this._htmlBody&&(jQuery(this._htmlCollapsibleIcon).removeClass("icon-double-angle-right").addClass("icon-double-angle-down"),!this._enabledAnimations||a?jQuery(this._htmlBody).stop(!0,!0).show():jQuery(this._htmlBody).stop(!0,!0).slideDown(),this._initialized&&"function"===typeof this.onExpand))this.onExpand(this);return this};CollapsiblePanel.prototype.toggleCollapse=function(){this._collapsed?this.expand():this.collapse();return this};
CollapsiblePanel.prototype.setBodyHeight=function(a){this._bodyHeight=a;this._htmlBody&&(this._htmlBody.style.maxHeight=isNaN(a)?a:a+"px");return this};CollapsiblePanel.prototype.setTitle=function(a){if("string"!==typeof a)throw Error("setTitle(): The parameter must be a string.");this._title=a;this._htmlTitle&&(this._htmlTitle.textContent=a);return this};CollapsiblePanel.prototype.getTitle=function(){return this._title};
CollapsiblePanel.prototype._unpaintItem=function(a){a.html&&(a.html.remove?a.html.remove():a.html.removeNode(!0));return this};CollapsiblePanel.prototype._unpaintItems=function(){var a,b=this._items.asArray();if(this.html)for(a=0;a<b.length;a+=1)this._unpaintItem(b[a]);return this};CollapsiblePanel.prototype.removeItem=function(a){if(a=this.getItem(a))this._items.remove(a),this._unpaintItem(a)};
CollapsiblePanel.prototype.clearItems=function(){this._items.asArray();this._unpaintItems();this._massiveAction&&this._items.clear();return this};CollapsiblePanel.prototype._paintItem=function(a,b){var c;this.html&&(b&&(c=this._items.get(b)),c?this._htmlBody.insertBefore(a.getHTML(),c.getHTML()):this._htmlBody.appendChild(a.getHTML()));return this};CollapsiblePanel.prototype._paintItems=function(){var a,b;if(this.html){b=this._items.asArray();this._unpaintItems();for(a=0;a<b.length;a+=1)this._paintItem(b[a])}return this};
CollapsiblePanel.prototype.addItem=function(a,b){if("number"===typeof b)this._items.insertAt(a,b);else if(null===b||void 0===b)this._items.insert(a);else throw Error("addItem(): The second parameter is optional, in case of use it must be a number.");this._massiveAction||this._paintItem(a,b);return this};
CollapsiblePanel.prototype.getItem=function(a){return"string"===typeof a?this._items.find("id",a):"number"===typeof a?this._items.get(a):typeof a instanceof FormPanelItem&&0<=this._items.indexOf(a)?a:null};CollapsiblePanel.prototype.setItems=function(a){var b;if(!jQuery.isArray(a))throw Error("setItems(): The parameter must be an array.");this._massiveAction=!0;this.clearItems();for(b=0;b<a.length;b++)this.addItem(a[b]);this._paintItems();this._massiveAction=!1;return this};
CollapsiblePanel.prototype.getItems=function(){return this._items.asArray()};CollapsiblePanel.prototype._createBody=function(){throw Error("_createBody(): This function must be overwritten in subclases, since it's been called from an abstract one.");};CollapsiblePanel.prototype._attachListeners=function(){var a;this.html&&!this._attachedListeners&&(a=this,jQuery(this._htmlTitleContainer).on("click",function(){a._disabled||a.toggleCollapse()}));return this};
CollapsiblePanel.prototype.createHTML=function(){var a,b,c,d,e;this.html||(this.html=this.createHTMLElement("div"),this.html.id=this.id,this.html.className="adam collapsible-panel",a=this.createHTMLElement("div"),a.className="adam collapsible-panel-header",d=this.createHTMLElement("h4"),d.className="adam collapsible-panel-title",b=this.createHTMLElement("span"),e=this.createHTMLElement("i"),e.className="adam collapsible-panel-icon icon-double-angle-right",d.appendChild(e),d.appendChild(b),a.appendChild(d),
this.html.appendChild(a),c=this._createBody(),c.className+=" adam collapsible-panel-body",this._htmlBody=c,this.html.appendChild(c),this._htmlCollapsibleIcon=e,this._htmlTitleContainer=d,this._htmlHeader=a,this._htmlTitle=b,this._htmlBody=c,this.setBodyHeight(this._bodyHeight),this.setTitle(this._title),this._paintItems(),this._collapsed?this.collapse():this.expand(),this._attachListeners(),this.setVisible(this.visible),this._headerVisible?this.showHeader():this.hideHeader(),this.style.applyStyle(),
this.style.addProperties({width:this.width,height:"auto"}));return this.html};var FormPanel=function(a){CollapsiblePanel.call(this,a);this.onSubmit=this._submitVisible=this._dependencyMap=this._htmlFooter=this._submitCaption=this._htmlSubmit=null;FormPanel.prototype.init.call(this,a)};FormPanel.prototype=new CollapsiblePanel;FormPanel.prototype.constructor=FormPanel;FormPanel.prototype.type="FormPanel";
FormPanel.prototype.init=function(a){var b={submitCaption:translate("LBL_PMSE_FORMPANEL_SUBMIT"),items:[],submitVisible:!0,onSubmit:null};jQuery.extend(!0,b,a);this._dependencyMap={};this._submitVisible=!!b.submitVisible;this.setItems(b.items).setSubmitCaption(b.submitCaption).setOnSubmitHandler(b.onSubmit)};FormPanel.prototype.setOnSubmitHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnSubmitHandler(): The parameter must be a function or null.");this.onSubmit=a;return this};
FormPanel.prototype.setItems=function(a){this._dependencyMap&&CollapsiblePanel.prototype.setItems.call(this,a);return this};
FormPanel.prototype._createField=function(a){var b={type:"text"};jQuery.extend(!0,b,a);switch(b.type){case "text":a=new FormPanelText(b);break;case "integer":b.precision=0;b.groupingSeparator="";a=new FormPanelNumber(b);break;case "number":b.precision=-1;b.groupingSeparator="";a=new FormPanelNumber(b);break;case "currency":b.precision=2;a=new FormPanelNumber(b);break;case "dropdown":a=new FormPanelDropdown(b);break;case "date":a=new FormPanelDate(b);break;case "datetime":a=new FormPanelDatetime(b);
break;case "radio":a=new FormPanelRadio(b);break;case "hidden":a=new FormPanelHidden(b);break;case "checkbox":a=new FormPanelCheckbox(b);break;case "button":a=new FormPanelButton(b);break;default:throw Error("_createField(): Invalid field type.");}return a};FormPanel.prototype.setSubmitCaption=function(a){if("string"!==typeof a)throw Error("setSubmitCaption(): The parameter must be a string.");this._submitCaption=a;this._htmlSubmit&&(this._htmlSubmit.textContent=a);return this};
FormPanel.prototype.getItem=function(a){return"string"===typeof a?this._items.find("_name",a):"number"===typeof a?this._items.get(a):a instanceof FormPanelItem&&0<=this._items.indexOf(a)?a:null};FormPanel.prototype._paintItem=function(a,b){var c;this.html&&("number"===typeof b&&(c=this._items.get(b+1)),c?this._htmlBody.insertBefore(a.getHTML(),c.getHTML()):this._htmlBody.insertBefore(a.getHTML(),this._htmlFooter));return this};
FormPanel.prototype.addItem=function(a,b){var c,d,e,f;if(a instanceof FormPanelField)c=a;else if("object"===typeof a)c=this._createField(a);else throw Error("addItem(): the parameter must be an object or an instance of FormPanelField.");c.setForm(this);CollapsiblePanel.prototype.addItem.call(this,c,b);if(c instanceof FormPanelField){if(d=this._dependencyMap[c.getName()])for(e=0;e<d.length;e+=1)(f=this.getItem(d[e]))&&f.fireDependentFields();c.fireDependentFields()}return this};
FormPanel.prototype.replaceItem=function(a,b){var c;b=this.getItem(b);c=this._items.indexOf(b);0<=c&&(this.removeItem(b),this.addItem(a,c));return this};FormPanel.prototype.isValid=function(){var a=this._items.asArray(),b,c=!0;for(b=0;b<a.length&&!(a[b]instanceof FormPanelField&&(c=c&&a[b].isValid(),!c));b+=1);return c};FormPanel.prototype._createBody=function(){var a=this.createHTMLElement("form");a.className="form-panel-body";return a};
FormPanel.prototype.getValueObject=function(){var a,b=this._items.asArray(),c={};for(a=0;a<b.length;a+=1)b[a]instanceof FormPanelField&&(c[b[a].getName()]=b[a].getValue());return c};
FormPanel.prototype.registerSingleDependency=function(a,b){if(!(a instanceof FormPanelField&&"string"===typeof b||jQuery.isArray(b)))throw Error("registerSingleDependency(): Incorrect parameters.");this._dependencyMap[b]||(this._dependencyMap[b]=[]);-1===this._dependencyMap[b].indexOf(b)&&this._dependencyMap[b].push(a.getName());return this};
FormPanel.prototype.registerDependency=function(a,b){var c;if(!(a instanceof FormPanelField&&jQuery.isArray(b)))throw Error("registerDependency(): Incorrect parameters.");for(c=0;c<b.length;c+=1)this.registerSingleDependency(a,b[c]);return this};FormPanel.prototype.showSubmit=function(){this._htmlFooter.style.display="";this._submitVisible=!0;return this};FormPanel.prototype.hideSubmit=function(){this._htmlFooter.style.display="none";this._submitVisible=!1;return this};
FormPanel.prototype.reset=function(){var a=this._items.asArray(),b;for(b=0;b<a.length;b+=1)a[b]instanceof FormPanelField&&a[b].reset();return this};FormPanel.prototype.submit=function(){this.isValid()&&$(this._htmlBody).trigger("submit");return this};
FormPanel.prototype._attachListeners=function(){var a;this.html&&!this._attachedListeners&&(a=this,CollapsiblePanel.prototype._attachListeners.call(this),jQuery(a._htmlBody).on("submit",function(b){var c=!0;b.preventDefault();a.isValid()&&("function"===typeof a.onSubmit&&(c=!1!==a.onSubmit(a)),c&&a._onValueAction())}),this._attachedListeners=!0);return this};
FormPanel.prototype.createHTML=function(){var a,b;this.html||(CollapsiblePanel.prototype.createHTML.call(this),b=this.createHTMLElement("div"),b.className="adam form-panel-footer",a=this.createHTMLElement("button"),a.className="adam form-panel-submit btn btn-mini",b.appendChild(a),this._htmlBody.appendChild(b),this._htmlSubmit=a,this._htmlFooter=b,this.setSubmitCaption(this._submitCaption),this._attachListeners(),this._submitVisible?this.showSubmit():this.hideSubmit());return this.html};
var FormPanelItem=function(a){Element.call(this,a);this._form=this._disabled=this._label=this._name=null;FormPanelItem.prototype.init.call(this,a)};FormPanelItem.prototype=new Element;FormPanelItem.prototype.constructor=FormPanelItem;FormPanelItem.prototype.type="FormPanelItem";
FormPanelItem.prototype.init=function(a){var b={name:this.id,form:null,label:"[form-item]",disabled:!1,height:"auto"};jQuery.extend(!0,b,a);this.setName(b.name).setForm(b.form).setLabel(b.label).setHeight(b.height);b.disabled?this.disable():this.enable()};
FormPanelItem.prototype.setHeight=function(a){if(!("number"===typeof a||"string"===typeof a&&("auto"===a||/^\d+(\.\d+)?(em|px|pt|%)?$/.test(a))))throw Error("setHeight(): invalid parameter.");this.height=a;this.html&&this.style.addProperties({height:this.height});return this};FormPanelItem.prototype.setName=function(a){if("string"!==typeof a)throw Error("setName(): The parameter must be a string.");this._name=a;return this};FormPanelItem.prototype.getName=function(){return this._name};
FormPanelItem.prototype.setWidth=function(a){return FormPanel.prototype.setWidth.call(this,a)};FormPanelItem.prototype.setForm=function(a){if(!(null===a||a instanceof FormPanel))throw Error("setForm(): The parameter must be an instance of FormPanel or null.");this._form=a;return this};FormPanelItem.prototype.getForm=function(){return this._form};FormPanelItem.prototype.setLabel=function(a){if("string"!==typeof a)throw Error("setLabel(): The parameter must be a string.");this._label=a;return this};
FormPanelItem.prototype.getLabel=function(){return this._label};FormPanelItem.prototype.enable=function(){this._disabled=!1;return this};FormPanelItem.prototype.disable=function(){this._disabled=!0;return this};FormPanelItem.prototype.isDisabled=function(){return this._disabled};FormPanelItem.prototype._attachListeners=function(){};
FormPanelItem.prototype.setVisible=function(a){_.isBoolean(a)&&(this.visible=a,this.html&&(a?this.style.removeProperties(["display"]):this.style.addProperties({display:"none"})));return this};FormPanelItem.prototype._postCreateHTML=function(){this._attachListeners();this.style.applyStyle();this.style.addProperties({width:this.width,height:this.height});this._disabled?this.disable():this.enable();this.setVisible(this.visible);return this};
FormPanelItem.prototype.createHTML=function(){var a;this.html||(a=this.createHTMLElement("div"),a.id=this.id,a.className="adam form-panel-item",this.html=a,this._postCreateHTML());return this.html};var FormPanelButton=function(a){FormPanelItem.call(this,a);this._htmlButton=this.onClick=null;FormPanelButton.prototype.init.call(this,a)};FormPanelButton.prototype=new FormPanelItem;FormPanelButton.prototype.constructor=FormPanelButton;FormPanelButton.prototype.type="FormPanelButton";
FormPanelButton.prototype.init=function(a){var b={onClick:null,width:"100%"};jQuery.extend(!0,b,a);this.setOnClickHandler(b.onClick).setWidth(b.width)};FormPanelButton.prototype.setOnClickHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnClickHandler(): The parameter must be a function or null.");this.onClick=a;return this};FormPanelButton.prototype.enable=function(){this._htmlButton&&(this._htmlButton.disabled=!1);return FormPanelItem.prototype.enable.call(this)};
FormPanelButton.prototype.disable=function(){this._htmlButton&&(this._htmlButton.disabled=!0);return FormPanelItem.prototype.disable.call(this)};FormPanelButton.prototype._attachListeners=function(){var a=this;if(this.html)jQuery(this._htmlButton).on("click",function(){if("function"===typeof a.onClick)a.onClick(a)});return this};FormPanelButton.prototype._postCreateHTML=function(){this._htmlButton&&FormPanelItem.prototype._postCreateHTML.call(this);return this};
FormPanelButton.prototype.createHTML=function(){var a,b;this.html||(a=FormPanelItem.prototype.createHTML.call(this),a.className+=" form-panel-button",b=this.createHTMLElement("input"),b.type="button",b.value=this._label,b.className="btn btn-mini",a.appendChild(b),this._htmlButton=b,this._postCreateHTML());return this.html};
var FormPanelField=function(a){FormPanelItem.call(this,a);this.onChange=this._value=null;this._htmlControl=[];this._htmlLabelContainer=this._htmlControlContainer=null;this._dependantFields=[];this._initialValue=this._form=this._disabled=this.required=this._dependencyHandler=null;FormPanelField.prototype.init.call(this,a)};FormPanelField.prototype=new FormPanelItem;FormPanelField.prototype.constructor=FormPanelField;FormPanelField.prototype.type="FormPanelField";
FormPanelField.prototype.init=function(a){var b={label:"[field]",onChange:null,dependantFields:[],dependencyHandler:null,value:"",required:!1};jQuery.extend(!0,b,a);this.setLabel(b.label).setValue(b.value).setRequired(b.required).setOnChangeHandler(b.onChange).setDependantFields(b.dependantFields).setDependencyHandler(b.dependencyHandler);this._initialValue=this._value};FormPanelField.prototype.reset=function(){this.setValue(this._initialValue);return this};
FormPanelField.prototype.setForm=function(a){FormPanelItem.prototype.setForm.call(this,a);a&&a.registerDependency(this,this._dependantFields);return this};FormPanelField.prototype.setRequired=function(a){this.required=!!a;return this};FormPanelField.prototype._evalRequired=function(){return this.required&&!this._disabled?!!this._value:!0};FormPanelField.prototype._validateField=function(){return this};
FormPanelField.prototype.isValid=function(){var a=this._evalRequired();a&&(a=this._validateField());!a&&this.html?jQuery(this.html).addClass("error"):jQuery(this.html).removeClass("error");return a};FormPanelField.prototype.setDependencyHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setDependencyHandler(): The parameter must be a function or null.");this._dependencyHandler=a;return this};
FormPanelField.prototype._fireDependencyHandler=function(a,b){"function"===typeof this._dependencyHandler&&this._dependencyHandler(this,a,b);return this};FormPanelField.prototype.addDependantField=function(a){if("string"===typeof a)this._dependantFields.push(a),this._form&&this._form.registerSingleDependency(this,a);else throw Error("addDependantField(): The parameter must be a string (The name of the dependant field).");return this};
FormPanelField.prototype.setDependantFields=function(a){var b;if(!jQuery.isArray(a))throw Error("setDependantFields(): the parameter must be an array.");this._dependantFields=[];for(b=0;b<a.length;b+=1)this.addDependantField(a[b]);return this};FormPanelField.prototype.setLabel=function(a){FormPanelItem.prototype.setLabel.call(this,a);this._htmlLabelContainer&&(this._htmlLabelContainer.textContent=a);return this};
FormPanelField.prototype.setOnChangeHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnChangeHandler(): The parameter must be a function or null.");this.onChange=a;return this};FormPanelField.prototype._setValueToControl=function(a){this._htmlControl[0]&&(this._htmlControl[0].value=a);return this};
FormPanelField.prototype.setValue=function(a){var b=this._value;if("string"!==typeof a)throw Error("setValue(): The parameter must be a string.");this._setValueToControl(a);this._value=a;a!==b&&this.fireDependentFields();return this};FormPanelField.prototype.enable=function(){var a;if(this._htmlControl&&this._htmlControl.length)for(a=0;a<this._htmlControl.length;a+=1)this._htmlControl[a].disabled=!1;return FormPanelItem.prototype.enable.call(this)};
FormPanelField.prototype.disable=function(){var a;if(this._htmlControl&&this._htmlControl.length)for(a=0;a<this._htmlControl.length;a+=1)this._htmlControl[0].disabled=!0;return FormPanelItem.prototype.disable.call(this)};FormPanelField.prototype.getValue=function(){return this._value};FormPanelField.prototype._getValueFromControl=function(){var a="",b;for(b=0;b<this._htmlControl.length;b+=1)a+=this._htmlControl[b].value;return a};
FormPanelField.prototype.fireDependentFields=function(){var a,b=this._value;if(this._form)for(i=0;i<this._dependantFields.length;i++)(a=this._form.getItem(this._dependantFields[i]))&&a._fireDependencyHandler(this,b);return this};FormPanelField.prototype._onChangeHandler=function(){var a=this;return function(){var b=a._value,c=a._getValueFromControl();if(b!==c){a._value=c;if("function"===typeof a.onChange)a.onChange(a,c,b);a.fireDependentFields()}}};
FormPanelField.prototype._attachListeners=function(){var a;if(this.html)for(a=0;a<this._htmlControl.length;a+=1)jQuery(this._htmlControl[a]).on("change",this._onChangeHandler());return this};
FormPanelField.prototype._createControl=function(){var a,b;if(!this._htmlControl.length)throw Error("_createControl(): This method shouldn't be called until the field control is created.");this._setValueToControl(this._value);for(b=0;b<this._htmlControl.length;b+=1)a=this._htmlControl[b],a.className+=" inherit-width adam form-panel-field-control",this._htmlControlContainer.appendChild(a);this.setValue(this._value);return this};
FormPanelField.prototype._postCreateHTML=function(){this._htmlControlContainer&&FormPanelItem.prototype._postCreateHTML.call(this);return this};
FormPanelField.prototype.createHTML=function(){var a,b,c,d;this.html||(a=FormPanelItem.prototype.createHTML.call(this),a.className+=" adam form-panel-field record-cell",a.className+="\tadam-"+this.type.toLowerCase(),b=this.createHTMLElement("div"),b.className="adam form-panel-label record-label",c=this.createHTMLElement("span"),c.className="normal index",d=this.createHTMLElement("span"),d.className="edit",c.appendChild(d),a.appendChild(b),a.appendChild(c),this._htmlLabelContainer=b,this._htmlControlContainer=
d,this.html=a,this._createControl().setLabel(this._label),this._postCreateHTML());return this.html};var FormPanelHidden=function(a){FormPanelField.call(this,a)};FormPanelHidden.prototype=new FormPanelField;FormPanelHidden.prototype.constructor=FormPanelHidden;FormPanelHidden.prototype.type="FormPanelHidden";
FormPanelHidden.prototype._createControl=function(){this._htmlControl.length||(this._htmlControl[0]=this.createHTMLElement("input"),this._htmlControl[0].name=this._name,this._htmlControl[0].type="hidden",FormPanelField.prototype._createControl.call(this));return this};FormPanelHidden.prototype.createHTML=function(){FormPanelField.prototype.createHTML.call(this);this.html.style.display="none";return this};
var FormPanelText=function(a){FormPanelField.call(this,a);this._maxLength=this.onKeyUp=this._placeholder=null;FormPanelText.prototype.init.call(this,a)};FormPanelText.prototype=new FormPanelField;FormPanelText.prototype.constructor=FormPanelText;FormPanelText.prototype.type="FormPanelText";FormPanelText.prototype.init=function(a){var b={placeholder:"",onKeyUp:null,maxLength:0};jQuery.extend(!0,b,a);this.setPlaceholder(b.placeholder).setOnKeyUpHandler(b.onKeyUp).setMaxLength(b.maxLength)};
FormPanelText.prototype.setMaxLength=function(a){if(!("number"===typeof a&&0<=a))throw Error("setMaxLength(): The parameter must be a number major than 0.");this._maxLength=a;this._htmlControl[0]&&(a?this._htmlControl[0].maxLength=a:this._htmlControl[0].removeAttribute("maxlength"));return this};FormPanelText.prototype.setOnKeyUpHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnKeyUpHandler(): The parameter must be a function or null");this.onKeyUp=a;return this};
FormPanelText.prototype.setPlaceholder=function(a){if("string"!==typeof a)throw Error("setPlaceholder(): The parameter must be a string.");this._placeholder=a;this._htmlControl[0]&&(this._htmlControl[0].placeholder=a);return this};FormPanelText.prototype._onKeyUp=function(){var a=this;return function(b){if("function"===typeof a.onKeyUp)a.onKeyUp(a,a._htmlControl[0].value,b.keyCode)}};
FormPanelText.prototype._attachListeners=function(){this.html&&(FormPanelField.prototype._attachListeners.call(this),jQuery(this._htmlControl[0]).on("keyup",this._onKeyUp()));return this};FormPanelText.prototype._createControl=function(){this._htmlControl.length||(this._htmlControl[0]=this.createHTMLElement("input"),this._htmlControl[0].name=this._name,this._htmlControl[0].type="text",this.setMaxLength(this._maxLength),FormPanelField.prototype._createControl.call(this));return this};
FormPanelText.prototype.createHTML=function(){this.html||(FormPanelField.prototype.createHTML.call(this),this.setPlaceholder(this._placeholder));return this.html};var FormPanelNumber=function(a){FormPanelField.call(this,a);this._precision=this._groupingSeparator=this._decimalSeparator=null;this._initialized=!1;FormPanelNumber.prototype.init.call(this,a)};FormPanelNumber.prototype=new FormPanelField;FormPanelNumber.prototype.constructor=FormPanelNumber;FormPanelNumber.prototype.type="FormPanelNumber";
FormPanelNumber.prototype.init=function(a){var b={decimalSeparator:".",groupingSeparator:",",precision:-1,value:null};jQuery.extend(!0,b,a);this.setDecimalSeparator(b.decimalSeparator).setGroupingSeparator(b.groupingSeparator).setPrecision(b.precision).setValue(b.value);this._initialized=!0};FormPanelNumber.prototype._setValueToControl=function(a){this._htmlControl[0]&&(this._htmlControl[0].value=this._parseToUserString(a));return this};
FormPanelNumber.prototype._getValueFromControl=function(){var a,b=this._htmlControl[0].value;this._groupingSeparator&&(a=RegExp((this._isRegExpSpecialChar(this._groupingSeparator)?"\\":"")+this._groupingSeparator,"g"),b=b.replace(a,""));if(2<(a=b.split(this._decimalSeparator)).length)return null;a[1]=a[1]||"0";if(!/^\-?\d+$/.test(a[0])||!/^\d+$/.test(a[1]))return null;b=parseInt(a[0],10);b+=parseInt(a[1],10)/Math.pow(10,a[1].length);this._htmlControl[0].value=this._parseToUserString(b);return b};
FormPanelNumber.prototype.setValue=function(a){var b=this._value;if(!this._decimalSeparator)return this;if(!(null===a||"number"===typeof a))throw Error("setValue(): The parameter must be a number.");this._setValueToControl(a);this._value=a;a!==b&&this.fireDependentFields();return this};
FormPanelNumber.prototype.setDecimalSeparator=function(a){if(!("string"===typeof a&&1===a.length))throw Error("setDecimalSeparator(): The parameter must be a single character.");if(!isNaN(a)||0<=["+","-","/","*"].indexOf(a))throw Error("setDecimalSeparator(): Invalid parameter.");if(a===this._groupingSeparator)throw Error("setDecimalSeparator(): The decimal separator must be different than the grouping separator.");this._decimalSeparator=a;this._initialized&&this.setValue(this._value);return this};
FormPanelNumber.prototype.setGroupingSeparator=function(a){if(!("string"===typeof a&&1>=a.length))throw Error("setGroupingSeparator(): The parameter must be a single character or empty string.");if(!(isNaN(a)||0>["+","-","/","*"].indexOf(a)))throw Error("setGroupingSeparator(): Invalid parameter.");if(a===this._decimalSeparator)throw Error("setGroupingSeparator(): The grouping separator must be different than the decimal separator.");this._groupingSeparator=a;this._initialized&&this.setValue(this._value);
return this};FormPanelNumber.prototype.setPrecision=function(a){if(!("number"===typeof a&&0===a%1))throw Error("setPrecision(): The parameter must be an integer.");this._precision=a;this._initialized&&this.setValue(this._value);return this};FormPanelNumber.prototype._createControl=function(){this._htmlControl.length||(this._htmlControl[0]=this.createHTMLElement("input"),this._htmlControl[0].type="text",FormPanelField.prototype._createControl.call(this));return this};
FormPanelNumber.prototype._isRegExpSpecialChar=function(a){switch(a){case "\\":case "^":case "$":case "*":case "+":case "?":case ".":case "(":case ")":case "|":case "{":case "}":return!0}return!1};FormPanelNumber.prototype.isValid=function(){var a=FormPanelField.prototype.isValid.call(this);this._htmlControl[0].value&&null===this._value&&(a=!1);!a&&this.html?jQuery(this.html).addClass("error"):jQuery(this.html).removeClass("error");return a};
FormPanelNumber.prototype._parseToUserString=function(a){var b="",c,d,e;if(null===a)b="";else{0<=this._precision&&(c=Math.pow(10,this._precision),a=Math.round(a*c)/c);e=0===this._precision?"":this._decimalSeparator;c=Math.floor(a).toString();if(0!==this._precision){a=a.toString().split(".")[1]||(0>this._precision?"0":"");for(d=a.length;d<this._precision;d+=1)a+="0"}else a="";if(this._groupingSeparator)for(;3<c.length;)b=this._groupingSeparator+c.substr(-3)+b,c=c.slice(0,-3);b=c+b+e+a}return b};
FormPanelNumber.prototype._onKeyDown=function(){var a=this;return function(b){0===a._precision&&((48>b.keyCode||57<b.keyCode&&96>b.keyCode||105<b.keyCode)&&37!==b.keyCode&&39!==b.keyCode&&8!==b.keyCode&&46!==b.keyCode)&&b.preventDefault()}};FormPanelNumber.prototype._attachListeners=function(){this.html&&(jQuery(this._htmlControl[0]).on("keydown",this._onKeyDown()),FormPanelField.prototype._attachListeners.call(this));return this};
var FormPanelDate=function(a){FormPanelField.call(this,a);this._dom={};this._dateFormat=this._dateObject=null;FormPanelDate.prototype.init.call(this,a)};FormPanelDate.prototype=new FormPanelField;FormPanelDate.prototype.constructor=FormPanelDate;FormPanelDate.prototype.type="FormPanelDate";FormPanelDate.prototype.init=function(a){var b={dateFormat:"yyyy-mm-dd"};jQuery.extend(!0,b,a);this.setDateFormat(b.dateFormat)};
FormPanelDate.prototype.open=function(){jQuery(this._htmlControl[0]).datepicker("show");return this};FormPanelDate.prototype.close=function(){jQuery(this._htmlControl[0]).datepicker("hide");return this};FormPanelDate.prototype._validateField=function(){return null!==this._value||""===this._htmlControl[0].value};FormPanelDate.prototype._setValueToControl=function(a){return FormPanelField.prototype._setValueToControl.call(this,this._format(a))};FormPanelDate.prototype._getValueFromControl=function(){return this._unformat(this._htmlControl[0].value)};
FormPanelDate.prototype._unformat=function(a){a=App.date(a,this._dateFormat.toUpperCase(),!0);return a.isValid()?a.format():null};FormPanelDate.prototype._format=function(a){if(!a)return a;a=App.date(a);return a.isValid()?a.format(this._dateFormat.toUpperCase()):null};FormPanelDate.prototype.getFormattedDate=function(){return this._format(this._value)};
FormPanelDate.prototype._attachListeners=function(){if(this.html)jQuery(this._htmlControl[0]).on("changeDate change",this._onChangeHandler()).on("show",function(){$(".datepicker").filter(":visible").css("z-index",1300)});return this};FormPanelDate.prototype.setDateFormat=function(a){if("string"!==typeof a)throw Error("setFormat(): The parameter must be a string.");this._dateFormat=a;this._htmlControl[0]&&$(this._htmlControl[0]).datepicker({format:this._dateFormat});return this};
FormPanelDate.prototype._createControl=function(){this._htmlControl[0]||(this._htmlControl[0]=this.createHTMLElement("input"),this._htmlControl[0].name=this._name,this._htmlControl[0].type="text",this.setDateFormat(this._dateFormat),FormPanelField.prototype._createControl.call(this));return this};var FormPanelDatetime=function(a){FormPanelDate.call(this,a);this._timeFormat=null;FormPanelDatetime.prototype.init.call(this,a)};FormPanelDatetime.prototype=new FormPanelDate;
FormPanelDatetime.prototype.constructor=FormPanelDatetime;FormPanelDatetime.prototype.type="FormPanelDatetime";FormPanelDatetime.prototype.init=function(a){var b={timeFormat:"H:i"};jQuery.extend(!0,b,a);this.setTimeFormat(b.timeFormat)};FormPanelDatetime.prototype.openTime=function(){jQuery(this._htmlControl[1]).timepicker("show");return this};FormPanelDatetime.prototype.closeTime=function(){jQuery(this._htmlControl[1]).timepicker("hide");return this};FormPanelDatetime.prototype.closeAll=function(){return this.close().closeTime()};
FormPanelDatetime.prototype._setValueToControl=function(a){var b;if(!this._htmlControl.length)return this;a?(a=a.split("T"),b=a[1],a=a[0],this._htmlControl[1]&&(FormPanelDate.prototype._setValueToControl.call(this,a),b=b.split(/[\+\-]/),b=b[0],jQuery(this._htmlControl[1]).timepicker("setTime",b))):this._htmlControl[0].value=this._htmlControl[1].value="";return this};
FormPanelDatetime.prototype._getValueFromControl=function(){var a="",b,c,d=!1;this._htmlControl.length&&(b=this._htmlControl[0].value,c=this._htmlControl[1].value,b&&c&&(a=SUGAR.App.date(b+" "+c,this._dateFormat.toUpperCase()+" "+SUGAR.App.date.convertFormat(this._timeFormat),!0),d=a.isValid()),d?a=a.format():(b&&!FormPanelDate.prototype._unformat.call(this,b)&&(this._htmlControl[0].value=""),c&&jQuery(this._htmlControl[1]).timepicker("setTime",c),a=null));return a};
FormPanelDatetime.prototype.setValue=function(a){var b=this._value;if(!(null===a||"string"===typeof a))throw Error("setValue(): The parameter must be a string.");if(!("string"===typeof a&&(""===a||App.date(a).isValid())))throw Error("setValue(): Invalid value.");this._setValueToControl(a);this._value=a;a!==b&&this.fireDependentFields();return this};
FormPanelDatetime.prototype.setTimeFormat=function(a){var b="",c,d;switch(a){case "H:i":case "h:ia":case "h:iA":case "h:i a":case "h:i A":case "H.i":case "h.ia":case "h.iA":case "h.i a":case "h.i A":this._timeFormat=a;break;default:throw Error("setTimeFormat(): invalid format.");}this._htmlControl[1]&&(this._dateObject&&(c=a.split(""),d=this._dateObject.getHours(),d="h"===c[0]&&12<d?d-12:d,b+=(10>d?"0"+d:d)+c[1],d=this._dateObject.getMinutes(),b+=10>d?"0"+d:d,3<c.length&&(d=12>this._dateObject.getHours()?
"am":"pm",b="a"===c[3]?b+d:"A"===c[3]?b+d.toUpperCase():b+(" "+("A"===c[4]?d.toUpperCase():"a"===c[4]?d:"")))),this._htmlControl[1].value=b,jQuery(this._htmlControl[1]).timepicker({timeFormat:a,appendTo:function(a){return a.parent().parent().parent().parent().parent().parent().parent()}}));return this};FormPanelDatetime.prototype._attachListeners=function(){this.html&&(FormPanelDate.prototype._attachListeners.call(this),jQuery(this._htmlControl[1]).on("change",this._onChangeHandler()));return this};
FormPanelDatetime.prototype._createControl=function(){this._htmlControl.length||(this._htmlControl[1]=this.createHTMLElement("input"),this._htmlControl[1].type="text",this.setTimeFormat(this._timeFormat),FormPanelDate.prototype._createControl.call(this));return this};var FormPanelDropdown=function(a){FormPanelField.call(this,a);this._dataRoot=this._dataURL=this._proxy=this._options=null;this._massiveAction=!1;this._valueField=this._labelField=null;FormPanelDropdown.prototype.init.call(this,a)};
FormPanelDropdown.prototype=new FormPanelField;FormPanelDropdown.prototype.constructor=FormPanelDropdown;FormPanelDropdown.prototype.type="FormPanelDropdown";
FormPanelDropdown.prototype.init=function(a){var b={options:[],value:"",dataURL:null,dataRoot:null,labelField:"label",valueField:"value"};jQuery.extend(!0,b,a);this._proxy=new SugarProxy;FormPanelField.prototype.setValue.call(this,b.value);this._options=new ArrayList;this.setDataURL(b.dataURL).setDataRoot(b.dataRoot).setLabelField(b.labelField).setValueField(b.valueField);"string"===typeof b._dataURL?this.load():this.setOptions(b.options)};
FormPanelDropdown.prototype.setLabelField=function(a){if("string"!==typeof a)throw Error("setLabelField(): The parameter must be a string.");this._labelField=a;return this};FormPanelDropdown.prototype.getLabelField=function(a){return this._labelField};FormPanelDropdown.prototype.setValueField=function(a){if(!("string"===typeof a||"function"===typeof a))throw Error("setValueField(): The parameter must be a string.");this._valueField=a;return this};FormPanelDropdown.prototype.getValueField=function(){return this._valueField};
FormPanelDropdown.prototype._showLoadingMessage=function(){var a;this._htmlControl.length&&(a=this.createHTMLElement("option"),a.value="",a.label=a.textContent="loading...",a.className="adam form-apnel-dropdown-loading",a.selected=!0,this.disable(),this._htmlControl[0].appendChild(a));return this};FormPanelDropdown.prototype._removeLoadingMessage=function(){jQuery(this._htmlControl[0]).find("adam form-apnel-dropdown-loading").remove();this.enable();return this};
FormPanelDropdown.prototype._onLoadDataSuccess=function(){var a=this;return function(b){b=a._dataRoot?b[a._dataRoot]:b;a._removeLoadingMessage();a.setOptions(b)}};FormPanelDropdown.prototype.load=function(){if("string"!==typeof this._dataURL)throw Error("load(): The dataURL wasn't set properly.");this._proxy.url=this._dataURL;this.clearOptions();this._showLoadingMessage();this._proxy.getData(null,{success:this._onLoadDataSuccess()});return this};
FormPanelDropdown.prototype.setDataRoot=function(a){if(!(null===a||"string"===typeof a))throw Error("setDataRoot(): The parameter must be a string or null.");this._dataRoot=a;return this};FormPanelDropdown.prototype.setDataURL=function(a){if(!(null===a||"string"===typeof a))throw Error("setDataURL(): The parameter must be a string or null.");this._dataURL=a;return this};
FormPanelDropdown.prototype.existsValueInOptions=function(a){var b,c=this._options.asArray();if("string"===typeof this._valueField)return!!this._options.find(this._valueField,a);for(b=0;b<c[b];b+=1)if(a===this._valueField(c[b]))return!0;return!1};FormPanelDropdown.prototype._getFirstAvailableOption=function(){var a;return this._options?(a=this._options.asArray(),a[0]||null):null};FormPanelDropdown.prototype.getSelectedText=function(){return jQuery(this.html).find("option:selected").text()};
FormPanelDropdown.prototype.getSelectedData=function(){return jQuery(this.html).find("option:selected").data("data")};FormPanelDropdown.prototype.setValue=function(a){this._options&&(this.existsValueInOptions(a)?FormPanelField.prototype.setValue.call(this,a):(a=(a=this._getFirstAvailableOption())?"function"===typeof this._valueField?this._valueField(this,a):a[this._valueField]:"",FormPanelField.prototype.setValue.call(this,a||"")));return this};
FormPanelDropdown.prototype.clearOptions=function(){jQuery(this._htmlControl[0]).empty();this._options.clear();this._value="";return this};FormPanelDropdown.prototype._paintOption=function(a){var b=this.createHTMLElement("option");b.label=b.textContent=a[this._labelField];b.value="function"===typeof this._valueField?this._valueField(this,a):a[this._valueField];jQuery(b).data("data",a);this._htmlControl[0].appendChild(b);return this};
FormPanelDropdown.prototype.addOption=function(a){"object"===typeof a&&(a=cloneObject(a),this._options.insert(a),this.html&&!this._massiveAction&&this._paintOption(a));return this};FormPanelDropdown.prototype._paintOptions=function(){var a,b=this._options.asArray();if(this.html){jQuery(this._htmlControl[0]).empty();for(a=0;a<b.length;a+=1)this._paintOption(b[a])}return this};
FormPanelDropdown.prototype.setOptions=function(a){var b,c;if(!jQuery.isArray(a))throw Error("setOptions(): The parameter must be an array.");c=this._value;this._massiveAction=!0;this.clearOptions();for(b=0;b<a.length;b+=1)this.addOption(a[b]);this._paintOptions();this._massiveAction=!1;this.setValue(c);return this.html};FormPanelDropdown.prototype.reset=function(){};
FormPanelDropdown.prototype._createControl=function(){this._htmlControl[0]||(this._htmlControl[0]=this.createHTMLElement("select"),this._htmlControl[0].name=this._name,FormPanelField.prototype._createControl.call(this));return this};FormPanelDropdown.prototype.createHTML=function(){this.html||(FormPanelField.prototype.createHTML.call(this),this._paintOptions(),this._setValueToControl(this._value),this._value=this._getValueFromControl());return this};
var FormPanelRadio=function(a){FormPanelField.call(this,a);this._options=[];FormPanelRadio.prototype.init.call(this,a)};FormPanelRadio.prototype=new FormPanelField;FormPanelRadio.prototype.constructor=FormPanelRadio;FormPanelRadio.prototype.type="FormPanelRadio";FormPanelRadio.prototype.init=function(a){var b={options:[]};jQuery.extend(!0,b,a);this.setOptions(b.options).setValue(void 0!==b.value?b.value:this._value)};
FormPanelRadio.prototype._setValueToControl=function(a){var b,c;for(b=0;b<this._htmlControl.length;b+=1)c=jQuery(this._htmlControl[b]).find("input").get(0),c.checked=c.value===a?!0:!1;return this};FormPanelRadio.prototype.setValue=function(a){FormPanelField.prototype.setValue.call(this,a);this._htmlControl.length&&(this._value=this._getValueFromControl());return this};
FormPanelRadio.prototype.setOptions=function(a){var b;if(!jQuery.isArray(a))throw Error("setOptions(): The parameter must be an array.");for(b=0;b<a.length;b+=1)!0===a[b].selected&&(this._value=a[b].value);this._options=a;return this};FormPanelRadio.prototype._getValueFromControl=function(){var a,b,c="";if(this._htmlControl.length){a=jQuery(this._htmlControl[0]);for(b=1;b<this._htmlControl.length;b+=1)a.add(this._htmlControl[b]);a=a.find(":checked");a.length&&(c=a.val())}return c};
FormPanelRadio.prototype._createControl=function(){var a,b,c;if(!this._htmlControl.length){for(a=0;a<this._options.length;a+=1)c=this.createHTMLElement("label"),b=this.createHTMLElement("input"),b.type="radio",b.name=this._name,b.value=this._options[a].value,b.className="adam formpanel-radio",b.checked=!!this._options[a].selected,c.appendChild(b),c.appendChild(document.createTextNode(this._options[a].label)),this._htmlControl.push(c);FormPanelField.prototype._createControl.call(this)}return this};
var FormPanelCheckbox=function(a){FormPanelField.call(this,a)};FormPanelCheckbox.prototype=new FormPanelField;FormPanelCheckbox.prototype.constructor=FormPanelCheckbox;FormPanelCheckbox.prototype.type="FormPanelCheckbox";FormPanelCheckbox.prototype._setValueToControl=function(a){this._htmlControl[0]&&(this._htmlControl[0].checked=!!a);return this};FormPanelCheckbox.prototype._getValueFromControl=function(){return this._htmlControl[0].checked};
FormPanelCheckbox.prototype.setValue=function(a){var b=this._value;this._setValueToControl(!!a);this._value=!!a;a!==b&&this.fireDependentFields();return this};FormPanelCheckbox.prototype._createControl=function(){this._htmlControl.length||(this._htmlControl[0]=this.createHTMLElement("input"),this._htmlControl[0].type="checkbox",this._htmlControl[0].name=this._name,FormPanelField.prototype._createControl.call(this));return this};
var ListPanel=function(a){CollapsiblePanel.call(this,a);this._showingLoadingMessage=this._htmlMessage=this._dataRoot=this._autoload=this._dataURL=this._proxy=this._data=this._itemsContent=null;this._filter=[];this.onLoad=this.onItemClick=this._filterMode=null;ListPanel.prototype.init.call(this,a)};ListPanel.prototype=new CollapsiblePanel;ListPanel.prototype.constructor=ListPanel;ListPanel.prototype.type="ListPanel";
ListPanel.prototype.init=function(a){var b={items:[],itemsContent:"[list item]",data:null,onItemClick:null,dataURL:null,autoload:!1,dataRoot:null,onLoad:null,filter:[],filterMode:"inclusive",fieldToFilter:null};jQuery.extend(!0,b,a);this._proxy=new SugarProxy;this._autoload=b.autoload;this.setFilterMode(b.filterMode).setItemsContent(b.itemsContent).setOnItemClickHandler(b.onItemClick).setDataURL(b.dataURL).setDataRoot(b.dataRoot).setOnLoadHandler(b.onLoad);"string"===typeof this._dataURL&&this._autoload?
this.load():jQuery.isArray(b.data)?this.setDataItems(b.data,b.fieldToFilter,b.filter):this.setItems(b.items)};ListPanel.prototype.setFilterMode=function(a){if("inclusive"!==a&&"exclusive"!==a)throw Error('setFilterMode(): The value for the parameter should be "inclusive" or "exclusive"');this._filterMode=a;return this};ListPanel.prototype.getFilterMode=function(a){return this._filterMode};
ListPanel.prototype.setOnLoadHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("onLoadHandler(): The parameter must be a function or null.");this.onLoad=a;return this};ListPanel.prototype._checkItemsNum=function(){0===this._items.getSize()?this.showMessage("[0 items]"):this.removeMessage();return this};ListPanel.prototype.setDataRoot=function(a){if(!(null===a||"string"===typeof a))throw Error("setDataRoot(): The parameter must be a string or null.");this._dataRoot=a;return this};
ListPanel.prototype._createMessageBox=function(){var a;this._htmlMessage?a=this._htmlMessage:(a=this.createHTMLElement("div"),a.className="adam list-panel-message",this._htmlMessage=a);return a};ListPanel.prototype.showMessage=function(a){var b=this._createMessageBox();this._showingLoadingMessage=!1;jQuery(b).empty();isHTMLElement(a)?b.appendChild(a):"string"===typeof a&&(b.textContent=a);$(this._htmlBody).prepend(this._htmlMessage);return this};
ListPanel.prototype.removeMessage=function(){jQuery(this._htmlMessage).remove();this._showingLoadingMessage=!1;return this};ListPanel.prototype._onLoadDataError=function(){var a=this;return function(b){b=a.createHTMLElement("strong");b.appendChild(document.createTextNode("An error occurred, please try again."));a.showMessage(b)}};
ListPanel.prototype._onLoadDataSuccess=function(){var a=this;return function(b){var c=a._dataRoot?b[a._dataRoot]:b;a.removeMessage().setDataItems(c)._checkItemsNum();if("function"===typeof a.onLoad)a.onLoad(a,b)}};
ListPanel.prototype._showLoadingMessage=function(){var a,b;if(this._showingLoadingMessage)return this;a=this.createHTMLElement("span");b=this.createHTMLElement("i");b.className="adam list-panel-spinner icon-spinner icon-spin";a.appendChild(b);a.appendChild(document.createTextNode("loading..."));this.showMessage(a);this._showingLoadingMessage=!0;return this};
ListPanel.prototype.load=function(){if("string"!==typeof this._dataURL)throw Error("load(): The url wasn't set properly.");this._proxy.url=this._dataURL;this.clearItems();this._showLoadingMessage();this._proxy.getData(null,{success:this._onLoadDataSuccess(),error:this._onLoadDataError()});return this};ListPanel.prototype.setDataURL=function(a){if(!(null===a||"string"===typeof a))throw Error("setDataURL(): The parameter must be a string or null.");this._dataURL=a;return this};
ListPanel.prototype.setOnItemClickHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnItemClickHandler(): The parameter must be a function or null.");this.onItemClick=a;return this};ListPanel.prototype._onItemClickHandler=function(){var a=this;return function(b){if("function"===typeof a.onItemClick)a.onItemClick(a,b);a._onValueAction(b)}};
ListPanel.prototype.addDataItem=function(a){if("object"!==typeof a)throw Error("addDataItem(): The parameter must be an object.");this.addItem({data:a});return this};
ListPanel.prototype._filterData=function(a,b,c){var d=[],e,f=!1,h=this;jQuery.isArray(c)&&c.length?f=function(a){return"inclusive"===h._filterMode?0<=c.indexOf(a[b]):-1===c.indexOf(a[b])}:"string"===typeof c?f=function(a){return c.toLowerCase()===a[b].toLowerCase()}:"function"===typeof c&&(f=c);if("string"===typeof b&&f){for(e=0;e<a.length;e+=1)f(a[e])&&d.push(a[e]);return d}return a};ListPanel.prototype.getFilter=function(){return this._filter.slice(0)};
ListPanel.prototype.setDataItems=function(a,b,c){if(jQuery.isArray(a)){this._massiveAction=!0;a=this._filterData(a,b,c);this.clearItems();for(b=0;b<a.length;b+=1)this.addDataItem(a[b]);this._filter=c||[];this._paintItems();this._massiveAction=!1}return this};ListPanel.prototype.setItemsContent=function(a){if(!("string"===typeof a||"function"===typeof a))throw Error("setItemsContent(): The parameter must be a string or a function.");this._itemsContent=a;return this};
ListPanel.prototype.setItems=function(a){this._itemsContent&&CollapsiblePanel.prototype.setItems.call(this,a);return this};ListPanel.prototype.addItem=function(a){a instanceof ListItem||(a.text||(a.text=this._itemsContent),a=new ListItem(a));a.setOnClickHandler(this._onItemClickHandler());CollapsiblePanel.prototype.addItem.call(this,a);return this};ListPanel.prototype._createBody=function(){var a=this.createHTMLElement("ul");a.className="list-panel";return a};ListPanel.prototype.getValueObject=function(a){return a.getData()};
var MultipleCollapsiblePanel=function(a){CollapsiblePanel.call(this,jQuery.extend(!0,{bodyHeight:100},a));this._selectedPanel=this._lastSelectedPanel=this._htmlContentTitle=this._htmlContentHeader=this._htmlContent=this._panelList=this._selectedPanel=null;this._fastAccessObject={};MultipleCollapsiblePanel.prototype.init.call(this,a)};MultipleCollapsiblePanel.prototype=new CollapsiblePanel;MultipleCollapsiblePanel.prototype.constructor=MultipleCollapsiblePanel;
MultipleCollapsiblePanel.prototype.type="MultipleCollapsiblePanel";MultipleCollapsiblePanel.prototype.init=function(){this._panelList=new ListPanel({itemsContent:this._panelListItemContent(),onItemClick:this._onPanelListItemClick(),collapsed:!1})};MultipleCollapsiblePanel.prototype.getItem=function(a){var b=null;"string"===typeof a?b=this._items.find("id",a):"number"===typeof a?b=this._items.get(a):a instanceof CollapsiblePanel&&this.isParentOf(a)&&(b=a);return b};
MultipleCollapsiblePanel.prototype.disableItem=function(a){(a=this.getItem(a))&&a.disable();return this};MultipleCollapsiblePanel.prototype.enableItem=function(a){(a=this.getItem(a))&&a.enable();return this};MultipleCollapsiblePanel.prototype._onItemEnablementStatusChange=function(){var a=this;return function(b,c){var d=a._fastAccessObject[b.id];d.listItem.setVisible(c);c?d.panel.expand():!a.isCollapsed()&&a._selectedPanel===b&&a.displayMenu(!0)}};
MultipleCollapsiblePanel.prototype._panelListItemContent=function(){return function(a,b){var c=this.createHTMLElement("a"),d=this.createHTMLElement("span"),e=this.createHTMLElement("i");c.className="adam list-item-content";e.className="adam list-item-arrow icon-circle-arrow-right";d.textContent=b.text;c.appendChild(d);c.appendChild(e);return c}};MultipleCollapsiblePanel.prototype._onPanelListItemClick=function(){var a=this;return function(b,c){a.displayPanel(c.getData().id)}};
MultipleCollapsiblePanel.prototype._clearContent=function(){var a;if(this._htmlContent)for(a=this._htmlContent.childNodes;1<a.length;)a[0].remove?this._htmlContent.lastChild.remove():this._htmlContent.lastChild.removeNode(!0);return!0};MultipleCollapsiblePanel.prototype.expand=function(a){this.displayMenu(!0);CollapsiblePanel.prototype.expand.call(this,a);return this};
MultipleCollapsiblePanel.prototype.displayPanel=function(a){a=this._items.find("id",a);var b;this._selectedPanel!==a&&(this._selectedPanel=a,this.html&&(this._lastSelectedPanel!==a&&(this._selectedPanel.getHTML(),this._clearContent(),this._htmlContentTitle.textContent=this._selectedPanel.getTitle(),this._htmlContent.appendChild(this._selectedPanel._htmlBody),a=jQuery(this._htmlBody).innerHeight(),b=jQuery(this._htmlContentHeader).outerHeight(),this._selectedPanel._htmlBody.style.height=a-b+"px"),
a=$(this._htmlBody).innerWidth(),this._htmlContent.style.left=a+"px",jQuery(this._panelList._htmlBody).animate({left:"-="+a+"px"}),jQuery(this._htmlContent).animate({left:0})))};
MultipleCollapsiblePanel.prototype.displayMenu=function(a){var b,c;if(this._selectedPanel&&(this._lastSelectedPanel=c=this._selectedPanel,this._selectedPanel=null,this._panelList._htmlBody.scrollTop=0,b=-1*parseInt(this._panelList._htmlBody.style.left,10),a?(this._panelList._htmlBody.style.left="0px",this._htmlContent.style.left=b+"px"):jQuery(this._panelList._htmlBody).add(this._htmlContent).animate({left:"+="+b+"px"}),"function"===typeof c.onCollapse))c.onCollapse(c);return this};
MultipleCollapsiblePanel.prototype.setBodyHeight=function(a){if(isNaN(a))throw Error("setBodyHeight(): The parameter must be a number.");this._bodyHeight=a;this._htmlBody&&(this._htmlBody.style.maxHeight=this._htmlBody.style.height=a+"px");return this};MultipleCollapsiblePanel.prototype.clearItems=function(){this.displayMenu();this._panelList&&this._panelList.clearItems();this._items.clear();return this};
MultipleCollapsiblePanel.prototype._paintItems=function(){var a,b;if(this._panelList){b=this._items.asArray();this._panelList.clearItems();for(a=0;a<b.length;a+=1)this._paintItem(b[a])}return this};MultipleCollapsiblePanel.prototype._paintItem=function(a){var b;this._panelList&&(this._panelList.addItem({data:{id:a.id,text:a.getTitle()},visible:!a.isDisabled()}),b=this._panelList.getItems(),this._fastAccessObject[a.id]={listItem:b[b.length-1],panel:a});return this};
MultipleCollapsiblePanel.prototype._createItem=function(a){switch(a.type){case "form":a=new FormPanel(a);break;case "list":a=new ListPanel(a);break;default:throw Error('_createItem(): The parameter has an invalid "type" property.');}return a};MultipleCollapsiblePanel.prototype.getValueObject=function(a){return a.value};MultipleCollapsiblePanel.prototype._onValueAction=function(a){if("function"===typeof this.onValueAction)this.onValueAction(a.panel,this.getValueObject(a));return this};
MultipleCollapsiblePanel.prototype._onSubpanelItemAction=function(){var a=this;return function(b,c){a._onValueAction({panel:b,value:c})}};
MultipleCollapsiblePanel.prototype.addItem=function(a){var b;if(a instanceof CollapsiblePanel)b=a;else if("object"===typeof a)b=this._createItem(a);else throw Error("addItem(): The parameter must be an instance of CollapsiblePanel or an object.");b.setParent(this).setOnValueActionHandler(this._onSubpanelItemAction()).setOnEnablementStatusChangeHandler(this._onItemEnablementStatusChange()).disableAnimations();this._items.insert(b.expand());this._massiveAction||this._paintItem(a);return this};
MultipleCollapsiblePanel.prototype.removeItem=function(a){if(a=this.getItem(a))this._items.remove(a),delete this._fastAccessObject[a.id],this.html&&(a.html.remove?a.html.remove():a.html.removeNode(!0));return this};MultipleCollapsiblePanel.prototype._attachListeners=function(){var a;this.html&&!this._attachedListeners&&(a=this,CollapsiblePanel.prototype._attachListeners.call(this),jQuery(this._htmlContentBackButton).on("click",function(){a.displayMenu()}));return this};
MultipleCollapsiblePanel.prototype._createBody=function(){var a,b,c,d,e;this._htmlBody||(a=this.createHTMLElement("div"),b=this.createHTMLElement("div"),b.className="adam multiple-panel-content",c=this.createHTMLElement("header"),c.className="adam multiple-panel-contentheader",d=this.createHTMLElement("span"),d.className="adam multiple-panel-title",e=this.createHTMLElement("i"),e.className="adam multiple-panel-back icon-circle-arrow-left",this._panelList.getHTML(),this._panelList._htmlBody.className+=
" adam-main-list",c.appendChild(d),c.appendChild(e),b.appendChild(c),a.appendChild(this._panelList._htmlBody),a.appendChild(b),this._htmlContent=b,this._htmlContentHeader=c,this._htmlContentTitle=d,this._htmlContentBackButton=e,this._htmlBody=a);return this._htmlBody};MultipleCollapsiblePanel.prototype.createHTML=function(){this.html||(CollapsiblePanel.prototype.createHTML.call(this),this.html.className+=" multiple-panel");return this.html};
var FieldPanelItemFactory=function(){var a={button:FieldPanelButton,buttongroup:FieldPanelButtonGroup,list:ListPanel,form:FormPanel,multiple:MultipleCollapsiblePanel,item_container:ItemContainer};return{hasProduct:function(b){return!!a[b]},canProduce:function(b){for(var c in a)if(a.hasOwnProperty(c)&&a[c]===b)return!0;return!1},isProduct:function(b){for(var c in a)if(a.hasOwnProperty(c)&&b instanceof a[c])return!0;return!1},make:function(b){var c=b.type;if(!this.hasProduct(c))throw Error('make(): The product "'+
c+"\" can't be produced by this factory.");return new a[c](b)}}}(),FieldPanel=function(a){Element.call(this,a);this._open=null;this._massiveAction=!1;this._onItemValueAction=null;this._items=new ArrayList;this._open=!1;this._owner=null;this._matchOwnerWidth=!0;this._appendTo=null;this._attachedListeners=!1;this.onClose=this.onOpen=this._className=null;FieldPanel.prototype.init.call(this,a)};FieldPanel.prototype=new Element;FieldPanel.prototype.constructor=FieldPanel;
FieldPanel.prototype.init=function(a){var b={items:[],onItemValueAction:null,open:!1,owner:null,matchOwnerWidth:!0,appendTo:document.body,className:"",onOpen:null,onClose:null};jQuery.extend(!0,b,a);this.setOwner(b.owner).setAppendTo(b.appendTo).setMatchOwnerWidth(b.matchOwnerWidth).setItems(b.items).setOnItemValueActionHandler(b.onItemValueAction).setClassName(b.className);b.open?this.open():this.close();this.setOnOpenHandler(b.onOpen).setOnCloseHandler(b.onClose)};
FieldPanel.prototype.setClassName=function(a){if("string"!==typeof a)throw Error("setClassName(): The parameter must be a string.");this._className=a;this.html&&jQuery(this.html).addClass(a);return this};FieldPanel.prototype.setOnOpenHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("The parameter must be a function or null.");this.onOpen=a;return this};
FieldPanel.prototype.setOnCloseHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("The parameter must be a function or null.");this.onClose=a;return this};FieldPanel.prototype.setMatchOwnerWidth=function(a){this._matchOwnerWidth=!!a;this._open&&this._append();return this};
FieldPanel.prototype.setAppendTo=function(a){if(!isHTMLElement(a)&&!("function"===typeof a||a instanceof Base))throw Error("setAppendTo(): The parameter must be an HTML element or an instance of Base.");this._appendTo=a;this.isOpen()&&this._append();return this};FieldPanel.prototype.setWidth=function(a){Element.prototype.setWidth.call(this,a);this.html&&"number"===typeof a&&this.style.addProperties({"min-width":this.width});return this};
FieldPanel.prototype.open=function(){if(!this._open&&(this.getHTML(),this._append(),jQuery(this.getHTML()).slideDown(),this._open=!0,"function"===typeof this.onOpen))this.onOpen(this);return this};FieldPanel.prototype.close=function(){if(this._open&&(this.html&&(this.html.style.display="none"),this._open=!1,"function"===typeof this.onClose))this.onClose(this);return this};FieldPanel.prototype.isOpen=function(){return this._open};FieldPanel.prototype.getOwner=function(){return this._owner};
FieldPanel.prototype.setOnItemValueActionHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnItemValueActionHandler(): the parameter must be a function or null.");this.onItemValueAction=a;return this};
FieldPanel.prototype._append=function(){var a;a=this._appendTo;var b=this._owner,c=1,d=0,e,f;b&&(isHTMLElement(b)||(b=b.html),c=b.offsetHeight);"function"===typeof a&&(a=a.call(this));isHTMLElement(a)||(a=a.html);e=a.children;for(i=0;i<e.length;i+=1)f=jQuery(e[i]).zIndex(),f>d&&(d=f);this.setZOrder(d+1);(!b||isInDOM(b))&&a.appendChild(this.html);b?(this.setWidth(this._matchOwnerWidth?b.offsetWidth:this.width),a=getRelativePosition(b,a)):(this.setWidth(this.width),a={left:0,top:0});this.setPosition(a.left,
a.top+c-1);return this};FieldPanel.prototype.setOwner=function(a){if(!(null===a||a instanceof Element||isHTMLElement(a)))throw Error("setOwner(): The parameter must be an instance of Element or null.");this._owner=a;this.isOpen()&&this._append();return this};FieldPanel.prototype._onItemValueActionHandler=function(){var a=this;return function(b,c){if("function"===typeof a.onItemValueAction)a.onItemValueAction(a,b,c)}};
FieldPanel.prototype.addItem=function(a){FieldPanelItemFactory.isProduct(a)||(a=FieldPanelItemFactory.make(a));if(FieldPanelItemFactory.isProduct(a))a.onValueAction=this._onItemValueActionHandler(),this._items.insert(a);else throw Error("addItem(): The parameter must be acceptable by this parent.");!this._massiveAction&&this.html&&this._paintItem(a);return this};FieldPanel.prototype.clearItems=function(){this._items.clear();jQuery(this.html).empty();return this};
FieldPanel.prototype._paintItem=function(a){this.html.appendChild(a.getHTML());return this};FieldPanel.prototype._paintItems=function(){var a,b;if(this.html){b=this._items.asArray();for(a=0;a<b.length;a++)this._paintItem(b[a])}return this};FieldPanel.prototype.setItems=function(a){var b;this._massiveAction=!0;this.clearItems();for(b=0;b<a.length;b++)this.addItem(a[b]);this._paintItems();this._massiveAction=!1;return this};FieldPanel.prototype.getItems=function(){return this._items.asArray()};
FieldPanel.prototype.hideItem=function(a){(a=this._items.get(a))&&a.hide();return this};FieldPanel.prototype.showItem=function(a){(a=this._items.get(a))&&a.show();return this};FieldPanel.prototype.attachListeners=function(){var a=this;this.html&&!this._attachedListeners&&(jQuery(document).on("click",function(b){var c=$(a.html);a._owner&&(c=isHTMLElement(a._owner)?c.add(a._owner):c.add(a._owner.html));jQuery(b.target).closest(c).length||a.close()}),this._attachedListeners=!0);return this};
FieldPanel.prototype.createHTML=function(){this.html||(Element.prototype.createHTML.call(this),this.html.className="adam field-panel",this._paintItems(),this.style.addProperties({position:"absolute","min-width":this.width,height:"auto",zIndex:this.zOrder}),this.html.style.display=this._open?"":"none",this.setClassName(this._className),this.attachListeners());return this.html};
var MultipleItemField=function(a,b){Field.call(this,a,b);this._onValueAction=this._panel=null;this._panelSemaphore=this._panelAppended=!1;this._proxy=new SugarProxy};MultipleItemField.prototype=new Field;MultipleItemField.prototype.constructor=MultipleItemField;MultipleItemField.prototype.type="MultipleItemField";MultipleItemField.prototype._onItemSetText=function(){return function(){return"[MultipleItemField Item]"}};MultipleItemField.prototype._createItemData=function(a){return a};
MultipleItemField.prototype._createItem=function(a,b){var c;c=b instanceof SingleItem?b:new SingleItem;c.setFullData(this._createItemData(a));c.setText(this._onItemSetText());return c};MultipleItemField.prototype.addItem=function(a,b){this.controlObject.addItem(this._createItem(a),null,b);return this};
MultipleItemField.prototype._setValueToControl=function(a){var b;a=a||[];a="string"===typeof a?JSON.parse(a):a;if(!jQuery.isArray(a))throw Error("setValue(): The parameter is incorrectly formatted.");for(b=0;b<a.length;b+=1)this.addItem(a[b],!0);return this};MultipleItemField.prototype._onChange=function(){var a=this;return function(){var b=a._getValueFromControls(),c=a.value;b!==c&&(a.value=b,a.onChange(a.value,c))}};MultipleItemField.prototype.isPanelOpen=function(){return this._panel.isOpen()};
MultipleItemField.prototype.openPanel=function(){this.isPanelOpen()||(this._panel.open(),this.controlObject.style.addClasses(["focused"]),this._panel.style.addClasses(["focused"]));return this};MultipleItemField.prototype.closePanel=function(){this._panel.close();this.controlObject.style.removeClasses(["focused"]);this._panel.style.removeClasses(["focused"]);return this};MultipleItemField.prototype._getValueFromControls=function(){var a=this.controlObject.getData();return JSON.stringify(a)};
MultipleItemField.prototype._isValidInput=function(){return null};MultipleItemField.prototype._onBeforeAddItemByInput=function(){return null};MultipleItemField.prototype._onPanelValueGeneration=function(){return null};MultipleItemField.prototype.getObject=function(){var a,b=this.controlObject.getItems(),c=[];for(a=0;a<b.length;a+=1)c.push(b[a].getData());return c};
MultipleItemField.prototype._createPanel=function(){var a=this;if(this.html){if(this._panel){if(!(this._panel instanceof FieldPanel))throw Error("_createPanel(): The panel created must be an instance of FieldPanel.");}else throw Error("_createPanel(): This method must be called from an overwritten _createdMethod() method in any subclasses after creatinf the panel.");this._panel.setAppendTo(function(){var b=a.parent&&a.parent.parent||null;return b?b.html:document.body});this._panel.setOwner(this.controlObject).close();
this._panel.setOnItemValueActionHandler(this._onPanelValueGeneration())}return this};MultipleItemField.prototype.scrollTo=function(){var a=this.html.parentNode,b=getRelativePosition(this.controlObject.html,a).top+$(this.controlObject.html).outerHeight()+a.scrollTop,c=this;if(a.scrollTop+$(a).outerHeight()<b)jQuery(this.html.parentNode).animate({scrollTop:b},function(){c.openPanel()});else return this};
MultipleItemField.prototype._attachListeners=function(){var a=this;this.html&&(jQuery(this._panel.getHTML()).on("mousedown",function(b){b.stopPropagation();a._panelSemaphore=!0}),$(this.parent&&this.parent.body).on("scroll",function(){a.closePanel()}));return this};MultipleItemField.prototype.evalRequired=function(){var a=!0;this.required&&((a=!!this.controlObject.getItems().length)?this.controlObject.style.removeClasses(["required"]):this.controlObject.style.addClasses(["required"]));return a};
MultipleItemField.prototype.clear=function(){this.controlObject&&this.controlObject.clearItems();this.value=this._getValueFromControls();this.isValid();return this};
MultipleItemField.prototype._createItemContainer=function(){var a,b=this;this.controlObject||(this.controlObject=a=new ItemContainer({className:"adam-field-control",onAddItem:this._onChange(),onRemoveItem:this._onChange(),width:this.fieldWidth||200,textInputMode:ItemContainer.prototype.textInputMode.ALL,inputValidationFunction:this._isValidInput(),onBeforeAddItemByInput:this._onBeforeAddItemByInput(),onBlur:function(){b._panelSemaphore||b.closePanel();b._panelSemaphore=!1},onFocus:function(){b.scrollTo();
b._panel.isOpen()||b.openPanel()}}),this._setValueToControl(this.value));return this};
MultipleItemField.prototype.createHTML=function(){var a,b="";this.html||(Field.prototype.createHTML.call(this),this.required&&(b="<i>*</i> "),a=this.createHTMLElement("span"),a.className="adam-form-label",a.innerHTML=this.label+": "+b,a.style.width=this.parent&&this.parent.labelWidth||"30%",a.style.verticalAlign="top",this.html.appendChild(a),this._createItemContainer().html.appendChild(this.controlObject.getHTML()),this._createPanel(),this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML()),
this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML()),this.labelObject=a,this._attachListeners());return this.html};
var EmailPickerField=function(a,b){MultipleItemField.call(this,a,b);this._relatedModulesFieldsDataRoot=this._relatedModulesFieldsDataURL=this._suggestionItemAddress=this._suggestionItemName=this._suggestionDataRoot=this._suggestionDataURL=this._delaySuggestTime=this._suggestTimer=this._suggestPanel=this._teamsPanel=this._teams=null;this._suggestionVisible=!1;this._lastQuery=this._teamNameField=null;EmailPickerField.prototype.init.call(this,a)};EmailPickerField.prototype=new MultipleItemField;
EmailPickerField.prototype.constructor=EmailPickerField;EmailPickerField.prototype.type="EmailPickerField";EmailPickerField.prototype.init=function(a){var b={teams:[],delaySuggestTime:500,suggestionDataURL:null,suggestionDataRoot:null,suggestionItemName:null,suggestionItemAddress:"email",teamNameField:"name"};jQuery.extend(!0,b,a);this._lastQuery={};this.setTeamNameField(b.teamNameField).setTeams(b.teams).setSuggestionDataURL(b.suggestionDataURL).setSuggestionDataRoot(b.suggestionDataRoot).setDelaySuggestTime(b.delaySuggestTime).setSuggestionItemName(b.suggestionItemName).setSuggestionItemAddress(b.suggestionItemAddress)};
EmailPickerField.prototype.setTeamNameField=function(a){if("string"!==typeof a)throw Error("setTeamNameField(): The parameter must be a string.");this._teamNameField=a;return this};EmailPickerField.prototype.setSuggestionItemName=function(a){if(!(null===a||"string"===typeof a))throw Error("setSuggestionItemName(): The parameter must be a string or null.");this._suggestionItemName=a;return this};
EmailPickerField.prototype.setSuggestionItemAddress=function(a){if(!(null===a||"string"===typeof a&&""!==a))throw Error("setSuggestionItemAddress(): The parameter must be a string different than an empty string.");this._suggestionItemAddress=a;return this};EmailPickerField.prototype.setSuggestionDataURL=function(a){if(!(null===a||"string"===typeof a))throw Error("setSuggestionDataURL(): The parameter must be a string or null.");this._suggestionDataURL=a;return this};
EmailPickerField.prototype.setSuggestionDataRoot=function(a){if(!(null===a||"string"===typeof a))throw Error("setSuggestionDataRoot(): The parameter must be a string or root.");this._suggestionDataRoot=a;return this};EmailPickerField.prototype.setDelaySuggestTime=function(a){if("number"!==typeof a)throw Error("setDelaySuggestTime(): The parameter must be a number.");this._delaySuggestTime=a;return this};
EmailPickerField.prototype.setTeams=function(a){if(!jQuery.isArray(a))throw Error("setItems(): The parameter must be an array.");this._teams=a;this._teamsPanel&&(this._teamsPanel.setDataItems(this._teams),this._teamsPanel.setVisible(this._teams.length));return this};EmailPickerField.prototype._onItemSetText=function(){return function(a,b){return b.name||b.emailAddress||""}};
EmailPickerField.prototype._createItemData=function(a){return{name:a.name||a.emailAddress||"",emailAddress:a.emailAddress||"",module:null}};EmailPickerField.prototype._onBeforeAddItemByInput=function(){var a=this;return function(b,c,d,e){return a._createItem({emailAddress:d},c)}};
EmailPickerField.prototype._onPanelValueGeneration=function(){var a=this;return function(b,c,d){if("FieldPanelButton"===c.type)newEmailItem=a._createItem({name:d.text,emailAddress:d.value});else switch(c.id){case "list-teams":newEmailItem=a._createItem({emailAddress:"Team",name:d[a._teamNameField]});break;default:newEmailItem=a._createItem({emailAddress:d[a._suggestionItemAddress],name:d[a._suggestionItemName||a._suggestionItemAddress]})}a.controlObject.addItem(newEmailItem,a.controlObject.getSelectedIndex())}};
EmailPickerField.prototype._suggestionItemContent=function(){var a=this;return function(b,c){var d=a.createHTMLElement("strong"),e=a.createHTMLElement("small"),f=a.createHTMLElement("a");f.href="#";f.className="adam email-picker-suggest";a._suggestionItemName&&(d.className="adam email-picker-suggest-name",d.textContent=c[a._suggestionItemName],f.appendChild(d));e.className="adam email-picker-suggest-address";e.textContent=c[a._suggestionItemAddress];f.appendChild(e);return f}};
EmailPickerField.prototype._onLoadSuggestions=function(){var a=this;return function(b,c){var d={"%NUMBER%":b.getItems().length,"%TEXT%":a._lastQuery.query};b.setTitle(translate("LBL_PMSE_EMAILPICKER_RESULTS_TITLE").replace(/%\w+%/g,function(a){return d[a]||a}))}};
EmailPickerField.prototype._createPanel=function(){var a=this;this._teamsPanel||(this._teamsPanel=new ListPanel({id:"list-teams",title:translate("LBL_PMSE_EMAILPICKER_TEAMS"),itemsContent:function(b,c){return c[a._teamNameField]||""}}),this.setTeams(this._teams));this._suggestPanel||(this._suggestPanel=new ListPanel({id:"list-suggest",title:translate("LBL_PMSE_EMAILPICKER_SUGGESTIONS"),itemsContent:this._suggestionItemContent(),visible:!1,bodyHeight:150,onLoad:this._onLoadSuggestions()}));this._panel=
new FieldPanel({items:[{type:"button",value:"Current User",text:translate("LBL_PMSE_EMAILPICKER_CURRENT_USER")},{type:"button",value:"Record Owner",text:translate("LBL_PMSE_EMAILPICKER_RECORD_OWNER")},{type:"button",value:"Supervisor",text:translate("LBL_PMSE_EMAILPICKER_SUPERVISOR")},this._teamsPanel,this._suggestPanel]});MultipleItemField.prototype._createPanel.call(this);return this};EmailPickerField.prototype._isValidInput=function(){return function(a,b){return/^\s*[\w\-\+_]+(\.[\w\-\+_]+)*\@[\w\-\+_]+\.[\w\-\+_]+(\.[\w\-\+_]+)*\s*$/.test(b)}};
EmailPickerField.prototype._loadSuggestions=function(a){var b=this;return function(){var c;clearInterval(b._timer);b._suggestionDataURL&&(b._lastQuery={query:a,dataRoot:b._suggestionDataRoot,dataURL:b._suggestionDataURL},c=b._suggestionDataURL.replace(/\{\$\d+\}/g,encodeURIComponent(a)),b._suggestPanel.setDataURL(c).setDataRoot(b._suggestionDataRoot),b._suggestPanel.load())}};
EmailPickerField.prototype._showSuggestionPanel=function(){var a=this._panel.getItems(),b;if(!this._suggestionVisible)for(b=0;b<a.length;b+=1)a[b]!==this._suggestPanel?a[b].setVisible(!1):a[b].setVisible(!0);this._suggestionVisible=!0;return this};EmailPickerField.prototype._hideSuggestionPanel=function(){var a=this._panel.getItems(),b;if(this._suggestionVisible)for(b=0;b<a.length;b+=1)a[b]!==this._suggestPanel?a[b].setVisible(!0):a[b].setVisible(!1);this._suggestionVisible=!1;return this};
EmailPickerField.prototype._onInputChar=function(){var a=this;return function(b,c,d,e){b=jQuery.trim(d);clearInterval(a._timer);b?a._suggestionDataURL&&(a._lastQuery.query===b&&a._lastQuery.dataURL===a._suggestionDataURL&&a._lastQuery.dataRoot===a._suggestionDataRoot||(a._timer=setInterval(a._loadSuggestions(b),a._delaySuggestTime),a._suggestPanel.clearItems()._showLoadingMessage().setTitle(translate("LBL_PMSE_EMAILPICKER_SUGGESTIONS"))),a._showSuggestionPanel(),a.openPanel(!0),a._suggestPanel.expand()):
a._hideSuggestionPanel()}};EmailPickerField.prototype.openPanel=function(a){a||this._hideSuggestionPanel();return MultipleItemField.prototype.openPanel.call(this)};EmailPickerField.prototype.createHTML=function(){this.html||(MultipleItemField.prototype.createHTML.call(this),this.controlObject.setOnInputCharHandler(this._onInputChar()));return this};
var ExpressionControl=function(a){Element.call(this,a);this._panel=null;this._operatorSettings={};this._operatorPanel=null;this._evaluationSettings={};this._evaluationPanel=null;this._evaluationPanels={};this._constantPanel=this._constantSettings=this._variablePanel=this._variableSettings=null;this._constantPanels={};this._attachedListeners=!1;this._value=this.onChange=null;this._panelSemaphore=!0;this._itemContainer=null;this._externalItemContainer=!1;this._numberGroupingSeparator=this._decimalSeparator=
this._dateFormat=this._expressionVisualizer=this._proxy=null;this._auxSeparator="|||";this.onClose=this.onOpen=null;ExpressionControl.prototype.init.call(this,a)};ExpressionControl.prototype=new Element;ExpressionControl.prototype.constructor=ExpressionControl;ExpressionControl.prototype.type="ExpressionControl";
ExpressionControl.prototype._regex={string:/("(?:[^"\\]|\\.)*")|('(?:[^'\\]|\\.)*')/,datetime:/^\d{4}-((0[1-9])|(1[0-2]))-((0[1-9])|([12][0-9])|(3[01]))(\s((0[0-9])|(1[0-2])|(2[0-3])):[0-5][0-9]:[0-5][0-9])?$/,unittime:/^\d+[wdhm]$/};
ExpressionControl.prototype._typeToControl={address:"text",checkbox:"checkbox",currency:"currency",date:"date",datetime:"datetime",decimal:"number",encrypt:"text",dropdown:"dropdown","float":"number",email:"text",name:"text",integer:"integer",multiselect:"text",phone:"text",radio:"radio",textarea:"text",url:"text",textfield:"text"};
ExpressionControl.prototype.OPERATORS={arithmetic:[{text:"+",value:"addition"},{text:"-",value:"substraction"},{text:"x",value:"multiplication"},{text:"/",value:"division"}],logic:[{text:"AND",value:"AND"},{text:"OR",value:"OR"},{text:"NOT",value:"NOT"}],comparison:[{text:"<",value:"minor_than"},{text:"<=",value:"minor_equals_than"},{text:"==",value:"equals"},{text:">=",value:"major_equals_than"},{text:">",value:"major_than"},{text:"!=",value:"not_equals"}],group:[{text:"(",value:"("},{text:")",value:")"}]};
ExpressionControl.prototype.init=function(a){var b={width:200,itemContainerHeight:80,height:"auto",operators:!0,evaluation:!1,variable:!1,constant:!0,onChange:null,owner:null,itemContainer:null,appendTo:document.body,matchOwnerWidth:!0,expressionVisualizer:!0,dateFormat:"yyyy-mm-dd",decimalSeparator:"."===a.numberGroupingSeparator?",":".",numberGroupingSeparator:","===a.decimalSeparator?".":",",allowInput:!0,onOpen:null,onClose:null,className:""};jQuery.extend(!0,b,a);this._proxy=new SugarProxy;b.itemContainer instanceof
ItemContainer?(this._itemContainer=b.itemContainer,this._externalItemContainer=!0):this._itemContainer=new ItemContainer({textInputMode:b.allowInput?ItemContainer.prototype.textInputMode.ALL:ItemContainer.prototype.textInputMode.NONE,width:"100%",height:b.itemContainerHeight});this._panel=new FieldPanel({id:b.id,open:!1,onItemValueAction:this._onPanelValueGeneration(),width:this.width,className:b.className||""});this._itemContainer.setOnAddItemHandler(this._onChange()).setOnRemoveItemHandler(this._onChange()).setInputValidationFunction(this._inputValidationFunction()).setOnBeforeAddItemByInput(this._onBeforeAddItemByInput());
this.setWidth(b.width).setHeight(b.height).setDateFormat(b.dateFormat).setDecimalSeparator(b.decimalSeparator).setNumberGroupingSeparator(b.numberGroupingSeparator).setOwner(b.owner).setAppendTo(b.appendTo).setOperators(b.operators).setEvaluations(b.evaluation).setVariablePanel(b.variable).setConstantPanel(b.constant).setOnChangeHandler(b.onChange).setMatchOwnerWidth(b.matchOwnerWidth).setOnOpenHandler(b.onOpen).setOnCloseHandler(b.onClose);b.expressionVisualizer?this.showExpressionVisualizer():this.hideExpressionVisualizer()};
ExpressionControl.prototype.setOnOpenHandler=function(a){this._panel.setOnOpenHandler(a);return this};ExpressionControl.prototype.setOnCloseHandler=function(a){this._panel.setOnCloseHandler(a);return this};ExpressionControl.prototype.getText=function(){return this._itemContainer.getText()};
ExpressionControl.prototype.setDecimalSeparator=function(a){if(!("string"===typeof a&&a&&1===a.length&&!/\d/.test(a)&&!/[\+\-\*\/]/.test(a)))throw Error("setDecimalSeparator(): The parameter must be a single character different than a digit and arithmetic operator.");if(a===this._numberGroupingSeparator)throw Error("setDecimalSeparator(): The decimal separator must be different from the number grouping separator.");this._decimalSeparator=a;return this};
ExpressionControl.prototype.setNumberGroupingSeparator=function(a){if(!(null===a||"string"===typeof a&&1>=a.length))throw Error("setNumberGroupingSeparator(): The parameter is optional should be a single character or null.");if(a===this._decimalSeparator)throw Error("setNumberGroupingSeparator(): The decimal separatpr must be different from the number grouping separator.");this._numberGroupingSeparator=a;return this};
ExpressionControl.prototype.setDateFormat=function(a){this._dateFormat=a;this._constantPanels.date&&this._constantPanels.date.getItem("date").setFormat(a);return this};ExpressionControl.prototype._onBeforeAddItemByInput=function(){var a=this;return function(b,c,d,e){if(b=a._parseInputToItem(d))c.setFullData(b);else return!1}};ExpressionControl.prototype.isLeapYear=function(a){return 0===a%400||0===a%4?!0:!1};
ExpressionControl.prototype.isValidDateTime=function(a){if("string"===typeof a){if(!this._regex.datetime.test(a))return!1;a=a.split("-");a[0]=parseInt(a[0],10);a[1]=parseInt(a[1],10);a[2]=parseInt(a[2],10);if(0>=a[1]||(0>=a[2]||12<a[1]||31<a[2])||(4===a[1]||6===a[1]||9===a[1])&&30<a[0]||!this.isLeapYear(a[0])&&28<a[2]||29<a[2])return!1}else return!1;return!0};
ExpressionControl.prototype._inputValidationFunction=function(){var a=this;return function(b,c){var d=jQuery.trim(c);switch(d){case "+":case "-":case "NOW":return!0;default:return a._regex.unittime.test(d)||a.isValidDateTime(d)}}};ExpressionControl.prototype.showExpressionVisualizer=function(){this._externalItemContainer||this._itemContainer.setVisible(!0);return this};ExpressionControl.prototype.hideExpressionVisualizer=function(){this._externalItemContainer||this._itemContainer.setVisible(!1);return this};
ExpressionControl.prototype.setMatchOwnerWidth=function(a){this._panel.setMatchOwnerWidth(!!a);return this};ExpressionControl.prototype.setAppendTo=function(a){this._panel.setAppendTo(a);return this};ExpressionControl.prototype.isOpen=function(){return this._panel&&this._panel.isOpen()||!1};ExpressionControl.prototype.getValueObject=function(){return this._itemContainer.getData()};
ExpressionControl.prototype._onChange=function(){var a=this;return function(b,c,d){c=a._value;a._value=JSON.stringify(b.getData());if("function"===typeof a.onChange)a.onChange(a,a._value,c)}};ExpressionControl.prototype.setOwner=function(a){this._panel.setOwner(a);return this};ExpressionControl.prototype.getOwner=function(){return this._panel.getOwner()};ExpressionControl.prototype.getValue=function(){return this._value};
ExpressionControl.prototype.setValue=function(a){var b;if("string"===typeof a)a=JSON.parse(a);else if(!jQuery.isArray(a))throw Error("The parameter must be a array formatted string or an object.");this._itemContainer.clearItems();for(b=0;b<a.length;b+=1)this._itemContainer.addItem(this._createItem(a[b]));return this};
ExpressionControl.prototype.setOnChangeHandler=function(a){if(!(null===a||"function"===typeof a))throw Error("setOnChangeHandler(): the parameter must be a function or null.");this.onChange=a;return this};ExpressionControl.prototype.setWidth=function(a){if(!("number"===typeof a||"string"===typeof a&&("auto"===a||/^\d+(\.\d+)?(em|px|pt|%)?$/.test(a))))throw Error("setWidth(): invalid parameter.");this.width=a;this.html&&this.style.addProperties({width:this.width});return this};
ExpressionControl.prototype.setHeight=function(a){if(!("number"===typeof a||"string"===typeof a&&("auto"===a||/^\d+(\.\d+)?(em|px|pt|%)?$/.test(a))))throw Error("setHeight(): invalid parameter.");this.height=a;this.html&&this.style.addProperties({height:this.height});return this};ExpressionControl.prototype._getProperty=function(a,b){var c,d;if(a){c=b.split(".");for(d=0;d<c.length;d+=1)a=a[c[d]]}return a};
ExpressionControl.prototype.setConstantPanel=function(a){this._constantSettings=a=!1===a?!1:!0===a?{basic:!0,date:!0,timespan:!0}:jQuery.extend(!0,!0,a);this._constantPanel&&this._createBasicConstantPanel()._createDateConstantPanel()._createTimespanPanel();return this};
ExpressionControl.prototype.setVariablePanel=function(a){var b={dataURL:null,dataRoot:null,data:[],dataFormat:"tabular",dataChildRoot:null,textField:"text",valueField:"value",typeField:"type",typeFilter:null,filterMode:"inclusive",moduleTextField:null,moduleValueField:null};if(!1===a)b=!1;else{jQuery.extend(!0,b,a);if(b.dataURL){if("string"!==typeof b.dataURL)throw Error('setVariablePanel(): The "dataURL" property must be a string.');if(!(null===b.dataRoot||"string"===typeof b.dataRoot))throw Error('setVariablePanel(): The "dataRoot" property must be a string or null.');
b.data=[]}else if(!jQuery.isArray(b.data))throw Error('setVariablePanel(): The "data" property must be an array.');if("tabular"!==b.dataFormat&&"hierarchical"!==b.dataFormat)throw Error('setVariablePanel(): The "dataFormat" property only can have the "hierarchical" or "tabular" values.');if("string"!==typeof b.dataChildRoot&&"hierarchical"===b.dataFormat)throw Error('setVariablePanel(): You set the "dataFormat" property to "hierarchical" so the "dataChildRoot" property must be specified.');if("string"!==
typeof b.textField)throw Error('setVariablePanel(): The "textField" property must be a string.');if("string"!==typeof b.valueField)throw Error('setVariablePanel(): The "valueField" property must be a string.');if("string"!==typeof b.typeField)throw Error('setVariablePanel(): The "typeField" property must be a string.');if(!(null===b.typeFilter||"string"===typeof b.typeFilter||jQuery.isArray(b.typeFilter)))throw Error('setVariablePanel(): The "typeFilter" property must be a string, array or null.');
if("string"!==typeof b.moduleTextField)throw Error('setVariablePanel(): The "moduleTextField" property must be a string.');if("string"!==typeof b.moduleValueField)throw Error('setVariablePanel(): The "moduleValueField" property must be a string.');if("inclusive"!==b.filterMode&&"exclusive"!==b.filterMode)throw Error('setVariablePanel(): The "filterMode" property must be "exclusive" or "inclusive"');}this._variableSettings=b;this._variablePanel&&this._createVariablePanel();return this};
ExpressionControl.prototype.setModuleEvaluation=function(a){var b={dataURL:null,dataRoot:null,textField:"text",valueField:"value",fieldDataURL:null,fieldDataRoot:null,fieldTextField:"text",fieldValueField:"value",fieldTypeField:"type"};!1===a?b=!1:jQuery.extend(!0,b,a);if(b){if("string"!==typeof b.dataURL)throw Error('setModuleEvaluation(): The "dataURL" property must be a string.');if(!("string"===typeof b.dataRoot||null===b.dataRoot))throw Error('setModuleEvaluation(): The "dataRoot" property must be a string or null.');
if("string"!==typeof b.textField)throw Error('setModuleEvaluation(): The "textField" property must be a string.');if("string"!==typeof b.valueField)throw Error('setModuleEvaluation(): The "valueField" property must be a string.');if("string"!==typeof b.fieldDataURL)throw Error('setModuleEvaluation(): The "fieldDataURL" property must be a string.');if(!("string"===typeof b.fieldDataRoot||null===b.fieldDataRoot))throw Error('setModuleEvaluation(): The "fieldDataRoot" property must be a string.');if("string"!==
typeof b.fieldTextField)throw Error('setModuleEvaluation(): The "fieldTextField" property must be a string.');if("string"!==typeof b.fieldValueField)throw Error('setModuleEvaluation(): The "fieldValueField" property must be a string.');if("string"!==typeof b.fieldTypeField)throw Error('setModuleEvaluation(): The "fieldTypeField" property must be a string.');}this._evaluationSettings||(this._evaluationSettings={});this._evaluationSettings.module=b;this._evaluationPanel&&this._createModulePanel();return this};
ExpressionControl.prototype.setFormResponseEvaluation=function(a){var b={dataURL:null,dataRoot:null,textField:"text",valueField:"value"};!1===a?b=!1:jQuery.extend(!0,b,a);if(b){if("string"!==typeof b.dataURL)throw Error('setFormResponseEvaluation(): The "dataURL" parameter must be a string.');if(!("string"===typeof b.dataRoot||null===b.dataRoot))throw Error('setFormResponseEvaluation(): The "dataRoot" parameter must be a string or null.');if("string"!==typeof b.textField)throw Error('setFormResponseEvaluation(): The "textField" parameter must be a string.');
if("string"!==typeof b.valueField)throw Error('setFormResponseEvaluation(): The "valueField" parameter must be a string.');}this._evaluationSettings.formResponse=b;this._evaluationPanels.formResponse&&this._createFormResponsePanel();return this};
ExpressionControl.prototype.setBusinessRuleEvaluation=function(a){var b={dataURL:null,dataRoot:null,textField:"text",valueField:"value"};if(!1===a)b=!1;else{jQuery.extend(!0,b,a);if("string"!==typeof b.dataURL)throw Error("setBusinessRuleEvaluation(): The parameter must be a string.");if(!("string"===typeof b.dataRoot||null===b.dataRoot))throw Error("setBusinessRuleEvaluation(): The parameter must be a string or null.");if("string"!==typeof b.textField)throw Error("setBusinessRuleEvaluation(): The parameter must be a string.");
if("string"!==typeof b.valueField)throw Error("setBusinessRuleEvaluation(): The parameter must be a string.");}this._evaluationSettings.businessRule=b;return this};
ExpressionControl.prototype.setUserEvaluation=function(a){var b={defaultUsersDataURL:null,defaultUsersDataRoot:null,defaultUsersLabelField:"text",defaultUsersValueField:"value",userRolesDataURL:null,userRolesDataRoot:null,userRolesLabelField:"text",userRolesValueField:"value",usersDataURL:null,usersDataRoot:null,usersLabelField:"text",usersValueField:"value"};if(!1===a)b=!1;else{jQuery.extend(!0,b,a);if("string"!==typeof b.defaultUsersDataURL)throw Error('setUserEvaluation(): The "defaultUsersDataURL" must be a string.');
if(!("string"===typeof b.defaultUsersDataRoot||null===b.defaultUsersDataRoot))throw Error('setUserEvaluation(): The "defaultUsersDataRoot" must be a string or null.');if("string"!==typeof b.defaultUsersLabelField)throw Error('setUserEvaluation(): The "defaultUsersLabelField" must be a string.');if("string"!==typeof b.defaultUsersValueField)throw Error('setUserEvaluation(): The "defaultUsersValueField" must be a string.');if("string"!==typeof b.userRolesDataURL)throw Error('setUserEvaluation(): The "userRolesDataURL" must be a string.');
if(!("string"===typeof b.userRolesDataRoot||null===b.userRolesDataRoot))throw Error('setUserEvaluation(): The "userRolesDataRoot" must be a string or null.');if("string"!==typeof b.userRolesLabelField)throw Error('setUserEvaluation(): The "userRolesLabelField" must be a string.');if("string"!==typeof b.userRolesValueField)throw Error('setUserEvaluation(): The "userRolesValueField" must be a string.');if("string"!==typeof b.usersDataURL)throw Error('setUserEvaluation(): The "usersDataURL" must be a string.');
if(!("string"===typeof b.usersDataRoot||null===b.usersDataRoot))throw Error('setUserEvaluation(): The "usersDataRoot" must be a string or null.');if("string"!==typeof b.usersLabelField)throw Error('setUserEvaluation(): The "usersLabelField" must be a string.');if("string"!==typeof b.usersValueField)throw Error('setUserEvaluation(): The "usersValueField" must be a string.');}this._evaluationSettings.user=b;this._evaluationPanel&&this._createUserPanel();return this};
ExpressionControl.prototype.setEvaluations=function(a){var b=["module","form","business_rule","user"],c,d;if(!1===a)this._evaluationSettings=!1;else if("object"===typeof a)for(c=0;c<b.length;c+=1)switch(d=a[b[c]]||!1,b[c]){case "module":this.setModuleEvaluation(d);break;case "form":this.setFormResponseEvaluation(d);break;case "business_rule":this.setBusinessRuleEvaluation(d);break;case "user":this.setUserEvaluation(d)}return this};
ExpressionControl.prototype.setOperators=function(a){var b,c,d;if(this._operatorSettings!==a)if(this._operatorSettings={},"object"===typeof a)for(b in this.OPERATORS){if(this.OPERATORS.hasOwnProperty(b))if("boolean"===typeof a[b])this._operatorSettings[b]=a[b]?this.OPERATORS[b]:!1;else if(jQuery.isArray(a[b])){this._operatorSettings[b]=[];for(c=0;c<a[b].length;c+=1)for(d=0;d<this.OPERATORS[b].length;d+=1)if(this.OPERATORS[b][d].text===a[b][c]){this._operatorSettings[b].push(this.OPERATORS[b][d]);
break}}}else if("boolean"===typeof a)this._operatorSettings=a?this.OPERATORS:a;else throw Error("setOperators(): The parameter must be an object literal with settings or boolean.");this._operatorPanel&&this._createOperatorPanel();return this};
ExpressionControl.prototype._getStringOrNumber=function(a){var b;(10*Math.random(1)).toString().replace(".","");var c=!1;a=jQuery.trim(a);"."!==this._decimalSeparator&&(c=0>a.indexOf("."))&&(b=a.replace(this._getDecimalSeparatorRegExp(),"."));c&&!isNaN(b)&&""!==b?(b=b.split("."),a=parseInt(b[0]),a+=b[1]?parseInt(b[1])/Math.pow(10,b[1].length):0):1<a.length&&('"'===a[0]&&'"'===a.slice(-1)?a=a.slice(1,-1):"'"===a[0]&&"'"===a.slice(-1)&&(a=a.slice(1,-1)));return a};
ExpressionControl.prototype._createItem=function(a,b){var c;c=b instanceof SingleItem?b:new SingleItem;c.setFullData(a);c.setText("{{expLabel}}");return c};ExpressionControl.prototype._getOperatorType=function(a){var b,c,d;for(b in this.OPERATORS)if(this.OPERATORS.hasOwnProperty(b)){d=this.OPERATORS[b];for(c=0;c<d.length;c+=1)if(d[c].text===a)return b.toUpperCase()}return null};
ExpressionControl.prototype._onPanelValueGeneration=function(){var a=this;return function(b,c,d){b={};var e,f,h,g;if("variables-list"!==(c.getParent()||{}).id)switch(c.id){case "button-panel-operators":b={expType:a._getOperatorType(d.value),expLabel:d.value,expValue:d.value};break;case "form-response-evaluation":b={expType:"CONTROL",expLabel:c.getItem("form").getSelectedText()+" "+c.getItem("operator").getSelectedText()+" "+d.status,expOperator:d.operator,expValue:d.status,expField:d.form};break;
case "form-module-field-evaluation":f=d.field.split(a._auxSeparator);b=a._getStringOrNumber(d.value);e="string"===typeof d.value?typeof b:typeof d.value;h=c.getItem("field").getSelectedText()+" "+c.getItem("operator").getSelectedText()+" ";g=c.getItem("value");h="Date"===f[1]?h+g.getFormattedDate():"Datetime"===f[1]?h+(g.getFormattedDate()+" "+g._htmlControl[1].value):h+("string"===e?'"'+b+'"':d.value);b={expType:"MODULE",expSubtype:f[1],expLabel:h,expValue:b,expOperator:d.operator,expModule:d.module,
expField:f[0]};break;case "form-business-rule-evaluation":b=a._getStringOrNumber(d.response);e=typeof b;b={expType:"BUSINESS_RULES",expLabel:c.getItem("rule").getSelectedText()+" "+c.getItem("operator").getSelectedText()+" "+("string"===e?'"'+b+'"':b),expValue:b,expOperator:d.operator,expField:d.rule};break;case "form-user-evaluation":f=d.operator.split("|");b=d.value||null;h=c.getItem("value").getSelectedText();switch(f[0]){case "USER_ADMIN":e="equals"===f[1]?"is admin":"is not admin";break;case "USER_ROLE":e=
("equals"===f[1]?"has role":"has not role")+" "+h;break;case "USER_IDENTITY":e=("equals"===f[1]?"==":"!=")+" "+h}h=c.getItem("user").getSelectedText()+" "+e;b={expType:f[0],expLabel:h,expValue:b,expOperator:f[1],expField:d.user};break;case "form-constant-basic":"number"===d.type?(f=d.value.split(a._getDecimalSeparatorRegExp()),b=parseInt(f[0],10),f=f[1]?parseInt(f[1],10)/Math.pow(10,f[1].length):0,b+=f*(0<=b?1:-1),e=d.value):"boolean"===d.type?e=(b="false"===d.value.toLowerCase()||"0"===d.value?!1:
!!d.value)?"TRUE":"FALSE":(b=d.value,e='"'+d.value+'"');b={expType:"CONSTANT",expSubtype:d.type,expLabel:e,expValue:b};break;case "form-constant-date":b={expType:"CONSTANT",expSubtype:"date",expLabel:c.getItem("date").getFormattedDate(),expValue:d.date};break;case "form-constant-timespan":b={expType:"CONSTANT",expSubtype:"timespan",expLabel:d.ammount+d.unittime,expValue:d.ammount+d.unittime};break;default:throw Error("_onPanelValueGeneration(): Invalid source data.");}else b={expType:"VARIABLE",expSubtype:d.type,
expLabel:d.text,expValue:d.value,expModule:d.module};c instanceof FormPanel&&c.reset();a._itemContainer.addItem(a._createItem(b))}};
ExpressionControl.prototype._createOperatorPanel=function(){var a;this._operatorPanel||(this._operatorPanel=new FieldPanelButtonGroup({id:"button-panel-operators"}));if(this._operatorSettings){this._operatorPanel.clearItems();for(a in this._operatorSettings)if(this._operatorSettings.hasOwnProperty(a)&&"object"===typeof this._operatorSettings[a]){usableItems=this._operatorSettings[a];for(i=0;i<usableItems.length;i+=1)this._operatorPanel.addItem({value:usableItems[i].text})}this._operatorPanel.setVisible(!!this._operatorPanel.getItems().length)}else this._operatorPanel.setVisible(!1);
return this._operatorPanel};
ExpressionControl.prototype.addVariablesList=function(a,b){var c,d;d={fieldToFilter:"type",filter:b.typeFilter,filterMode:b.filterMode,title:b.moduleText,data:[],itemsContent:function(a,b){var c="[item]",d,l,c=b.text;l=this.createHTMLElement("div");d=this.createHTMLElement("span");d.className="adam expressionbuilder-variableitem-text";d.textContent=c;c=this.createHTMLElement("span");c.className="adam expressionbuilder-variableitem-datatype";c.textContent=b.type;l.appendChild(d);l.appendChild(c);return l}};
for(c=0;c<a.length;c+=1)d.data.push({value:a[c][b.valueField],text:a[c][b.textField],type:a[c][b.typeField],module:b.moduleValue});newList=new ListPanel(d);newList.getItems().length&&this._variablePanel.addItem(newList);return this};
ExpressionControl.prototype._onLoadVariableDataSuccess=function(){var a=this;return function(b){var c=a._variableSettings,d,e={},f;c.dataRoot&&(b=b[c.dataRoot]);if("hierarchical"===c.dataFormat)for(d=0;d<b.length;d+=1)a.addVariablesList(b[d][c.dataChildRoot],{textField:c.textField,valueField:c.valueField,typeField:c.typeField,typeFilter:c.typeFilter,filterMode:c.filterMode,moduleText:b[d][c.moduleTextField],moduleValue:b[d][c.moduleValueField]});else{f="string"===typeof c.typeFilter?function(a){return c.typeFilter===
a}:jQuery.isArray(c.typeFilter)?function(a){return 0<=c.typeFilter.indexOf(a)}:function(){return!0};for(d=0;d<b.length;d+=1)f(b[d][c.typeField])&&(e[b[d][c.moduleValueField]]||(e[b[d][c.moduleValueField]]={fields:[]}),e[b[d][c.moduleValueField]].fields.push(b[d]));for(d in e)e.hasOwnProperty(d)&&a.addVariablesList(e[d].fields,{textField:c.textField,valueField:c.valueField,typeField:c.typeField,typeFilter:c.typeFilter,filterMode:c.filterMode,moduleText:e[d].fields[0][c.moduleTextField],moduleValue:e[d].fields[0][c.moduleValueField]})}}};
ExpressionControl.prototype._onLoadVariableDataError=function(){};
ExpressionControl.prototype._createVariablePanel=function(){var a=this._variableSettings;this._variablePanel||(this._variablePanel=new MultipleCollapsiblePanel({id:"variables-list",title:translate("LBL_PMSE_EXPCONTROL_VARIABLES_PANEL_TITLE"),onExpand:this._onExpandPanel()}),this._panel.addItem(this._variablePanel));a&&(this._variablePanel.clearItems(),a.dataURL?(this._proxy.url=a.dataURL,this._proxy.getData(null,{success:this._onLoadVariableDataSuccess(),error:this._onLoadVariableDataError()})):this._onLoadVariableDataSuccess()(a.data));
this._variablePanel.setVisible(!!a);return this._variablePanel};
ExpressionControl.prototype._createModulePanel=function(){var a,b=this,c=this._evaluationSettings.module,d;this._evaluationPanels.module||(this._evaluationPanels.module=new FormPanel({id:"form-module-field-evaluation",title:translate("LBL_PMSE_EXPCONTROL_MODULE_FIELD_EVALUATION_TITLE"),items:[{type:"dropdown",name:"module",label:translate("LBL_PMSE_EXPCONTROL_MODULE_FIELD_EVALUATION_MODULE"),width:"100%",required:!0,dependantFields:["field"],required:!0},{type:"dropdown",name:"field",label:translate("LBL_PMSE_EXPCONTROL_MODULE_FIELD_EVALUATION_VARIABLE"),
width:"40%",required:!0,dependantFields:["value"],dependencyHandler:function(a,c,d){var g=b._evaluationSettings.module;c=g.fieldDataURL.replace("{{MODULE}}",d);d?a.setDataURL(c).setDataRoot(g.fieldDataRoot).setLabelField(g.fieldTextField).setValueField(function(a,c){return c[g.fieldValueField]+b._auxSeparator+c[g.fieldTypeField]}).load():a.clearOptions()}},{type:"dropdown",name:"operator",label:"",width:"20%",labelField:"text",valueField:"value",required:!0,options:this.OPERATORS.comparison},{type:"text",
name:"value",label:translate("LBL_PMSE_EXPCONTROL_MODULE_FIELD_EVALUATION_VALUE"),width:"40%",required:!0,dependencyHandler:function(a,c,h){var g=h.split(b._auxSeparator)[1],l=[],k,m;if((g=g&&b._typeToControl[g.toLowerCase()])&&g!==d||"dropdown"===g){d=g;h=a.getForm();m={type:g,width:a.width,label:a.getLabel(),name:a.getName()};"dropdown"===g&&(k=c.getSelectedData().optionItem,c=Object.keys(k),c.forEach(function(a,b,c){l.push({value:a,label:k[a]})}),m.options=l);switch(g){case "date":case "datetime":case "decimal":case "currency":case "float":case "integer":c=
b.OPERATORS.comparison;"date"!==g&&"datetime"!==g&&(m.precision="integer"===g?0:"currency"===g?2:-1,m.groupingSeparator="currency"===g?b._numberGroupingSeparator:"",m.decimalSeparator=b._decimalSeparator);break;default:c=[b.OPERATORS.comparison[2],b.OPERATORS.comparison[5]]}h.getItem("operator").setOptions(c);g=h._createField(m);h.replaceItem(g,a);g.setDependencyHandler(a._dependencyHandler)}}}],onCollapse:function(a){a=a.getItem("value");a instanceof FormPanelDate&&a.closeAll()}}),this._evaluationPanel.addItem(this._evaluationPanels.module));
c?(a=this._evaluationPanels.module.getItem("module"),a.setDataURL(c.dataURL).setDataRoot(c.dataRoot).setLabelField(c.textField).setValueField(c.valueField).load(),this._evaluationPanel.enable(),this._evaluationPanel.setVisible(!0)):this._evaluationPanel.disable();return this._evaluationPanels.module};
ExpressionControl.prototype._createFormResponsePanel=function(){var a,b;this._evaluationPanels.formResponse||(this._evaluationPanels.formResponse=new FormPanel({id:"form-response-evaluation",title:translate("LBL_PMSE_EXPCONTROL_FORM_RESPONSE_EVALUATION_TITLE"),items:[{type:"dropdown",name:"form",label:translate("LBL_PMSE_EXPCONTROL_FORM_RESPONSE_EVALUATION_FORM"),width:"40%"},{type:"dropdown",name:"operator",label:"",width:"20%",options:[this.OPERATORS.comparison[2],this.OPERATORS.comparison[5]],
valueField:"value",labelField:"text"},{type:"dropdown",name:"status",label:translate("LBL_PMSE_EXPCONTROL_FORM_RESPONSE_EVALUATION_STATUS"),width:"40%",options:[{label:"Approved",value:"Approved"},{label:"Rejected",value:"Rejected"}]}]}));if(b=this._evaluationSettings.formResponse)a=this._evaluationPanels.formResponse.getItem("form"),this._evaluationPanel.addItem(this._evaluationPanels.formResponse),a.setDataURL(b.dataURL).setDataRoot(b.dataRoot).setLabelField(b.textField).setValueField(b.valueField).load();
return this._evaluationPanels.formResponse};
ExpressionControl.prototype._createBusinessRulePanel=function(){var a,b=this._evaluationSettings.businessRule;this._evaluationPanels.businessRule||(this._evaluationPanels.businessRule=new FormPanel({id:"form-business-rule-evaluation",type:"form",title:translate("LBL_PMSE_EXPCONTROL_BUSINESS_RULES_EVALUATION_TITLE"),items:[{type:"dropdown",name:"rule",label:translate("LBL_PMSE_EXPCONTROL_BUSINESS_RULES_EVALUATION_BR"),width:"40%",required:!0},{type:"dropdown",label:"",name:"operator",width:"20%",labelField:"text",
options:[this.OPERATORS.comparison[2],this.OPERATORS.comparison[5]]},{type:"text",label:translate("LBL_PMSE_EXPCONTROL_BUSINESS_RULES_EVALUATION_RESPONSE"),name:"response",width:"40%"}]}));b&&(a=this._evaluationPanels.businessRule.getItem("rule"),this._evaluationPanel.addItem(this._evaluationPanels.businessRule),a.setDataURL(b.dataURL).setDataRoot(b.dataRoot).setLabelField(b.textField).setValueField(b.valueField).load());return this};
ExpressionControl.prototype._createUserPanel=function(){var a,b=this._evaluationSettings.user;this._evaluationPanels.user||(this._evaluationPanels.user=new FormPanel({id:"form-user-evaluation",type:"form",title:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TITLE"),items:[{type:"dropdown",name:"user",label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_USER"),width:"35%",options:[{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_CURRENT"),value:"current_user"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_SUPERVISOR"),
value:"supervisor"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_OWNER"),value:"owner"}]},{type:"dropdown",name:"operator",label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_OPERATOR"),width:"30%",dependantFields:["value"],options:[{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_ADMIN"),value:"USER_ADMIN|equals"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_ROLE"),value:"USER_ROLE|equals"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_USER"),value:"USER_IDENTITY|equals"},
{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_NOT_ADMIN"),value:"USER_ADMIN|not_equals"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_NOT_ROLE"),value:"USER_ROLE|not_equals"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_IS_NOT_USER"),value:"USER_IDENTITY|not_equals"}]},{type:"dropdown",name:"value",label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_VALUE"),width:"35%",required:!0,dependencyHandler:function(a,d,e){switch(e.split("|")[0]){case "USER_ADMIN":a.clearOptions().disable();
break;case "USER_ROLE":a.setDataURL(b.userRolesDataURL).setDataRoot(b.userRolesDataRoot).setLabelField(b.userRolesLabelField).setValueField(b.userRolesValueField).load();break;case "USER_IDENTITY":a.setDataURL(b.usersDataURL).setDataRoot(b.usersDataRoot).setLabelField(b.usersLabelField).setValueField(b.usersValueField).load()}}}]}),this._evaluationPanel.addItem(this._evaluationPanels.user));b?(a=this._evaluationPanels.user.getItem("user"),a.setDataURL(b.defaultUsersDataURL).setDataRoot(b.defaultUsersDataRoot).setLabelField(b.defaultUsersLabelField).setValueField(b.defaultUsersValueField).load(),
this._evaluationPanels.user.enable()):this._evaluationPanels.user.disable();return this};ExpressionControl.prototype._isRegExpSpecialChar=function(a){switch(a){case "\\":case "^":case "$":case "*":case "+":case "?":case ".":case "(":case ")":case "|":case "{":case "}":return!0}return!1};ExpressionControl.prototype._getDecimalSeparatorRegExp=function(){var a="";this._isRegExpSpecialChar(this._decimalSeparator)&&(a="\\");return RegExp(a+this._decimalSeparator,"g")};
ExpressionControl.prototype._getNumberRegExp=function(){var a="";this._isRegExpSpecialChar(this._decimalSeparator)&&(a="\\");return RegExp("^-?\\d+("+(a+this._decimalSeparator)+"\\d+)?$")};ExpressionControl.prototype._onBasicConstantKeyUp=function(){var a=this;return function(b,c,d){d=b.getForm();b=d.getItem("btn_number");d=d.getItem("btn_boolean");c=c.toLowerCase();a._getNumberRegExp().test(c)?(b.enable(),d.enable()):(b.disable(),"true"===c||"false"===c?d.enable():d.disable())}};
ExpressionControl.prototype._createDateConstantPanel=function(){var a=this._constantSettings.date;this._constantPanels.date||(this._constantPanels.date=new FormPanel({id:"form-constant-date",title:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_FIXED_DATE"),items:[{type:"date",name:"date",label:"Date",width:"100%",format:this._dateFormat,required:!0}],onCollapse:function(a){a.getItem("date").close()}}),this._constantPanel.addItem(this._constantPanels.date));a?this._constantPanels.date.enable():this._constantPanels.date.disable();
return this};
ExpressionControl.prototype._createTimespanPanel=function(){var a=this._constantSettings.timespan;this._constantPanels.timespan||(this._constantPanels.timespan=new FormPanel({id:"form-constant-timespan",title:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_TITLE"),items:[{type:"text",name:"ammount",label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_AMMOUNT"),filter:"integer",width:"40%",required:!0,disabled:!0},{type:"dropdown",label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_UNIT"),name:"unittime",
width:"60%",disabled:!0,options:[{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_YEARS"),value:"y"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_MONTHS"),value:"m"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_WEEKS"),value:"w"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_DAYS"),value:"d"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_HOURS"),value:"h"},{label:translate("LBL_PMSE_EXPCONTROL_USER_EVALUATION_TIMESPAN_MINUTES"),
value:"min"}]}]}),this._constantPanel.addItem(this._constantPanels.timespan));a?this._constantPanels.timespan.enable():this._constantPanels.timespan.disable();return this};
ExpressionControl.prototype._createBasicConstantPanel=function(){var a=this._constantSettings.basic,b;this._constantPanels.basic||(b=function(a){var b=a.getForm();b.getItem("type").setValue(a.getLabel().substr(4));b.submit()},this._constantPanels.basic=new FormPanel({id:"form-constant-basic",title:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_BASIC"),submitVisible:!1,items:[{name:"value",type:"text",label:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_BASIC_VALUE"),width:"100%",onKeyUp:this._onBasicConstantKeyUp()},
{name:"type",type:"hidden",label:""},{type:"button",label:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_BASIC_ADD_STRING"),name:"btn_string",width:"33%",onClick:b},{type:"button",label:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_BASIC_ADD_NUMBER"),name:"btn_number",width:"33%",disabled:!0,onClick:b},{type:"button",label:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_BASIC_ADD_BOOLEAN"),name:"btn_boolean",width:"33%",onClick:b}],onSubmit:function(a){var b=0,e,f,h,g;if(!a.getItem("type").getValue()){f=["btn_string",
"btn_number","btn_boolean"];for(h=0;h<f.length;h+=1)g=a.getItem(f[h]),g.visible&&!g.isDisabled()&&(e=g,b+=1);if(1===b)a.getItem("type").setValue(e.getvdfvddfv().substr(4));else return!1}}}),this._constantPanel.addItem(this._constantPanels.basic));b=this._constantPanels.basic;a?(b.getItem("btn_string").setVisible(!0===a||!!a.string),b.getItem("btn_number").setVisible(!0===a||!!a.number),b.getItem("btn_boolean").setVisible(!0===a||!!a.boolean),(a=!0===a||a.string||a.number||a.boolean)?(this._constantPanel.setVisible(!0),
b.enable()):b.disable()):b.disable();return this};ExpressionControl.prototype._onExpandPanel=function(){var a=this;return function(b){var c=a._panel.getItems(),d;for(d=0;d<c.length;d+=1)c[d]instanceof CollapsiblePanel&&c[d]!==b&&c[d].collapse()}};
ExpressionControl.prototype._createMainPanel=function(){var a=[];this._externalItemContainer||a.push(this._itemContainer);this._panel.getItems().length||(this._createOperatorPanel(),a.push(this._operatorPanel),this._evaluationPanel=new MultipleCollapsiblePanel({title:translate("LBL_PMSE_EXPCONTROL_EVALUATIONS_TITLE"),onExpand:this._onExpandPanel()}),this._evaluationSettings&&(this._createModulePanel(),this._createFormResponsePanel(),this._createBusinessRulePanel(),this._createUserPanel()),a.push(this._evaluationPanel),
this._evaluationPanel.setVisible(!!this._evaluationPanel.getItems().length),this._constantPanel=new MultipleCollapsiblePanel({title:translate("LBL_PMSE_EXPCONTROL_CONSTANTS_TITLE"),onExpand:this._onExpandPanel()}),this._constantSettings&&(this._createBasicConstantPanel(),this._createDateConstantPanel(),this._createTimespanPanel()),a.push(this._constantPanel),this._constantPanel.setVisible(!!this._constantPanel.getItems().length),this._panel.setItems(a),this._createVariablePanel());return this._panel};
ExpressionControl.prototype.isPanelOpen=function(){return this._panel&&this._panel.isOpen()};ExpressionControl.prototype.open=function(){this.getHTML();this.isPanelOpen()||(this._constantPanel.collapse(!0),this._variablePanel.collapse(!0),this._evaluationPanel.collapse(!0));this._panel.open();return this};ExpressionControl.prototype.close=function(){this._panel.close();return this};
ExpressionControl.prototype.isValid=function(){var a,b,c,d=!0,e=null,f,h=0,g=this._itemContainer.getItems();for(a=0;a<g.length;a+=1){f=g[a].getData();(b="MODULE"===f.expType||"BUSINESS_RULES"===f.expType||"CONTROL"===f.expType||"USER_ADMIN"===f.expType||"USER_ROLE"===f.expType||"USER_IDENTITY"===f.expType||"CONSTANT"===f.expType||"VARIABLE"===f.expType)||"GROUP"===f.expType&&"("===f.expValue||"LOGIC"===f.expType&&"NOT"===f.expValue?d=!(e&&(c||"GROUP"===e.expType&&")"===e.expValue)):(d=e&&("GROUP"===
e.expType&&")"===e.expValue||c||b),d=null===d?!0:d);"GROUP"===f.expType&&(")"===f.expValue?(d=d&&0<h,h-=1):"("===f.expValue&&(h+=1));if(!d)break;e=f;c=b}d&&(e&&(d=d&&"LOGIC"!==e.expType&&"ARITHMETIC"!==e.expType&&!("GROUP"===e.expType&&"("===e.expValue)),d=d&&0===h);return d};
ExpressionControl.prototype.createHTML=function(){this.html||(this._createMainPanel(),this.html=this._panel.getHTML(),this.style.applyStyle(),this.style.addProperties({width:this.width,height:this.height,zIndex:this.zOrder}));return this.html};var CriteriaField=function(a,b){Field.call(this,a,b);this._panel=null;this._panelFlag=!0;this._listenersAttached=!1;this._disabled=this.fieldHeight=null;CriteriaField.prototype.init.call(this,a)};CriteriaField.prototype=new Field;
CriteriaField.prototype.constructor=CriteriaField;CriteriaField.prototype.type="CriteriaField";
CriteriaField.prototype.init=function(a){var b=this,c={operators:{},evaluation:!1,variable:!1,constant:!0,fieldHeight:88,fieldWidth:200,disabled:!1,dateFormat:"yyyy-mm-dd",decimalSeparator:".",numberGroupingSeparator:","};jQuery.extend(!0,c,a);this.controlObject=new ItemContainer({className:"adam-field-control",onFocus:function(){b.scrollTo();!b._panel.isOpen()&&!b._disabled&&b.openPanel()},onBlur:function(){b._panelFlag&&b.closePanel();b._panelFlag=!0}});this._panel=new ExpressionControl({itemContainer:this.controlObject,
owner:this.controlObject,dateFormat:c.dateFormat,operators:c.operators,evaluation:c.evaluation,variable:c.variable,constant:c.constant,decimalSeparator:c.decimalSeparator,numberGroupingSeparator:c.numberGroupingSeparator,onChange:this._onChange(),appendTo:function(){return b.parent&&b.parent.parent&&b.parent.parent.html||document.body}});this.setEvaluations(c.evaluation).setFieldWidth(c.fieldWidth).setFieldHeight(c.fieldHeight).setValue(c.value);c.disabled?this.disable():this.enable()};
CriteriaField.prototype.disable=function(){this._disabled=!0;this.controlObject.disable();jQuery(this.labelObject).addClass("adam-form-label-disabled");return this};CriteriaField.prototype.enable=function(){this._disabled=!1;this.controlObject.enable();jQuery(this.labelObject).removeClass("adam-form-label-disabled");return this};CriteriaField.prototype.setFieldWidth=function(a){!isNaN(a)&&this.controlObject&&this.controlObject.setWidth(this.fieldWidth=a);return this};
CriteriaField.prototype.setFieldHeight=function(a){isNaN(a)||this.controlObject.setHeight(this.fieldHeight=a);return this};CriteriaField.prototype.getItems=function(){return this.controlObject.getItems()};CriteriaField.prototype.setOperators=function(a){this._panel.setOperators(a);return this};CriteriaField.prototype.setEvaluations=function(a){this._panel.setEvaluations(a);return this};CriteriaField.prototype.setVariablePanel=function(a){this._panel.setVariablePanel(a);return this};
CriteriaField.prototype.setConstantPanel=function(a){this._panel.setConstantPanel(a);return this};CriteriaField.prototype.setModuleEvaluation=function(a){this._panel.setModuleEvaluation(a);return this};CriteriaField.prototype.setFormResponseEvaluation=function(a){this._panel.setFormResponseEvaluation(a);return this};CriteriaField.prototype.setBusinessRuleEvaluation=function(a){this._panel.setBusinessRuleEvaluation(a);return this};
CriteriaField.prototype.setUserEvaluation=function(a){this._panel.setUserEvaluation(a);return this};CriteriaField.prototype.clear=function(){this.controlObject.clearItems();return this};CriteriaField.prototype._onChange=function(){var a=this;return function(b,c,d){a.value=c;a.onChange(c,d)}};CriteriaField.prototype.setValue=function(a){this.controlObject&&Field.prototype.setValue.call(this,a);return this};
CriteriaField.prototype._setValueToControl=function(a){var b;a=a||[];a="string"===typeof a?JSON.parse(a):a;if(!jQuery.isArray(a))throw Error("setValue(): The parameter is incorrectly formatted.");for(b=0;b<a.length;b+=1)this.controlObject.addItem(this._panel._createItem(a[b]),null,!0);return this};CriteriaField.prototype.closePanel=function(){this._panel.isPanelOpen()&&this._panel.close();this.controlObject.style.removeClasses(["focused"]);this._panel.style.removeClasses(["focused"]);return this};
CriteriaField.prototype.openPanel=function(){this._panel.isPanelOpen()||(this._panel.open(),this.controlObject.style.addClasses(["focused"]),this._panel.style.addClasses(["focused"]));return this};CriteriaField.prototype.scrollTo=function(){var a=this.html.parentNode,b=getRelativePosition(this.controlObject.html,a).top+$(this.controlObject.html).outerHeight()+a.scrollTop,c=this;if(a.scrollTop+$(a).outerHeight()<b)jQuery(this.html.parentNode).animate({scrollTop:b},function(){c.openPanel()});else return this};
CriteriaField.prototype.evalRequired=function(){var a=!0;this.required&&((a=!!this.controlObject.getItems().length)?$(this.controlObject).style.removeClasses(["required"]):$(this.controlObject).style.addClasses(["required"]));return this};
CriteriaField.prototype.isValid=function(){var a=this._panel.isValid();a?($(this.errorTooltip.html).removeClass("adam-tooltip-error-on"),$(this.errorTooltip.html).addClass("adam-tooltip-error-off"),a=a&&Field.prototype.isValid.call(this)):(this.errorTooltip.setMessage("Invalid epxression syntax."),$(this.errorTooltip.html).removeClass("adam-tooltip-error-off"),$(this.errorTooltip.html).addClass("adam-tooltip-error-on"));return a?a&&Field.prototype.isValid.call(this):a};
CriteriaField.prototype._attachListeners=function(){var a=this;if(this.html&&!this._listenersAttached){jQuery(this._panel.getHTML()).on("mousedown",function(b){b.stopPropagation();a._panelFlag=!1});if(this.parent)$(this.parent.body).on("scroll",function(){a.closePanel()});this._attachListeners=!0}return this};
CriteriaField.prototype.createHTML=function(){var a,b="";this.html||(Field.prototype.createHTML.call(this),this.required&&(b="<i>*</i> "),a=this.createHTMLElement("span"),a.className="adam-form-label",a.innerHTML=this.label+": "+b,a.style.width=this.parent&&this.parent.labelWidth||"30%",a.style.verticalAlign="top",this.html.appendChild(a),this.html.appendChild(this.controlObject.getHTML()),this.errorTooltip&&this.html.appendChild(this.errorTooltip.getHTML()),this.helpTooltip&&this.html.appendChild(this.helpTooltip.getHTML()),
this.labelObject=a,this._attachListeners());return this.html};
