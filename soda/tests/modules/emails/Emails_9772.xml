<soda>
	<!--
		Compose Email from Contacts module list view and add TO/CC/BCC recipients
	-->
	<puts text="Test: Emails_9772.xml starting." />

	<script file="{@global.scriptsdir}/modules/lib/Contact_Create_Lib.xml" />
	<var var="first_contact" set="{@pre_contact_first_name} {@pre_contact_last_name}" />
	<var var="first_email" set="{@contact_record.emailAddress0}" />

	<script file="{@global.scriptsdir}/modules/lib/Contact_Create_Lib.xml"
		csv="{@global.scriptsdir}/csvs/emails/Email_9772_1.csv" />
	<var var="second_contact" set="{@pre_contact_first_name} {@pre_contact_last_name}" />
	<var var="second_email" set="{@contact_record.emailAddress0}" />

	<script file="{@global.scriptsdir}/modules/lib/Contact_Create_Lib.xml"
		csv="{@global.scriptsdir}/csvs/emails/Email_9772_2.csv" />
	<var var="third_contact" set="{@pre_contact_first_name} {@pre_contact_last_name}" />
	<var var="third_email" set="{@contact_record.emailAddress0}" />

	<!--Search the Contact record-->
	<link id="moduleTab_Contacts" />
	<browser assert="Contacts" />

	<button id="search_form_clear" />
	<button id="search_form_submit" />
	<checkbox name="massall" click="true" />
	<link id="actions_link" />
	<link text="Email" alert="true" />

	<wait timeout="15" />
	<browser assert="Quick Compose" />
	
	<!--clear To textfield-->
	<wait timeout="5" />
	<textfield id="addressTO0" set="" />

	<!--click Cc & Bcc link-->
	<table id="composeHeaderTable0">
		<link text="Add Cc" required="false" />
		<link text="Add Bcc" required="false" />
		<button index="6" />
	</table>

	<browser assert="Select Email Recipients" />
	
	<!--click record to "To"-->
	<text id="input_searchField" set="{@first_contact}" />
	<select id="input_searchPerson" set="Contacts" />

	<!--search-->
	<table id="searchTable">
		<image index="1" click="true" />
	</table>

	<div id="addrSearchGrid">
		<checkbox index="1" click="true" />
	</div>
	<table id="searchTable">
		<button index="1" />
	</table>

   <!--click record to "Cc"-->
  <text id="input_searchField" set="{@second_contact}" />
  
  <table id="searchTable">
		<image index="1" click="true" />
	</table>
	
	<div id="addrSearchGrid">
		<checkbox index="1" click="true" />
	</div>
	<table id="searchTable">
		<button index="2" />
	</table>


	<!--click record to "Bcc"-->
	<text id="input_searchField" set="{@third_contact}" />
  
  <table id="searchTable">
		<image index="1" click="true" />
	</table>
	<div id="addrSearchGrid">
		<checkbox index="1" click="true" />
	</div>
	<table id="searchTable">
		<button index="3" />
	</table>

	<button text="Done" />
	
	<text id="addressTO0" assert="{@first_contact}" />
	<text id="addressCC0" assert="{@second_contact}" />
	<text id="addressBCC0" assert="{@third_contact}" />
	
	<csv file="{@global.scriptsdir}/csvs/emails/Email_9770.csv" var="email_record_9772">
		<textfield id="emailSubject0" set="{@email_record_9772.subject} {@stamp}" />
	</csv>

	<table id="composeHeaderTable0">
		<button index="1" />
	</table>
	<wait timout="5" />

	<!--delete-->
	<script file="{@global.scriptsdir}/modules/lib/Contact_Delete_Lib.xml" />
	<puts text="Test: Emails_9772.xml finished." />
</soda>
